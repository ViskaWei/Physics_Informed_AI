你是【代码压缩 + NumPy 向量化专家】。 ### 🎯 任务目标 我将提供一份**已经验证正确、但代码量很大的 Python 实现**。 请你在 **完全保持算法语义与输出一致** 的前提下，**将其改写为尽量简短、清晰、可读的代码**。 --- ### 🔒 强制约束（必须全部遵守） 1. **不允许改变算法逻辑** * 不允许引入近似 * 不允许改变数值结果 * 不允许改变输出格式 2. **尽量压缩代码行数** * 能用 NumPy 就用 NumPy * 优先使用向量化 / broadcasting / argmin / argmax / sum / abs 等 * 避免多层 for 循环（除非不可避免） 3. **允许使用的库（仅限）** * numpy * math * collections * heapq * Python 标准库 ❌ 不允许使用 sklearn / torch / pandas 等 4. **输入读取规范（必须）** * 所有数据读取 **必须放在一个 read() 函数中** * read() 只负责读入并返回所需变量 * 主逻辑中不允许再出现 sys.stdin.read() 或指针移动 5. **输出规范（必须）** * 输出 **所有数值** * 输出格式与原程序完全一致（如空格分隔、换行规则） 6. **代码风格** * 允许使用短变量名（X, W, idx, k 等） * 不写多余注释 * 不拆成多个文件 * 不写调试输出 --- ### 🧠 优化方向提示（不是必须，但优先） * L1 / L2 范数 → np.abs(W).sum(axis=...) * Top-k / bottom-k → np.argsort / np.argpartition * 剪枝索引 → boolean mask / index array * 矩阵乘法 → @ * 分类预测 → argmax(axis=...) --- ### 📤 输出要求 请直接输出 **最终压缩后的完整 Python 代码**，包括： * import * read() 函数 * 主逻辑 * if __name__ == "__main__": **不要解释，不要对比，不要分析过程。**