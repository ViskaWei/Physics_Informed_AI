# ğŸ“‹ SpecViT è®ºæ–‡ï¼šå®éªŒæ£€æŸ¥æ¸…å•

> **çŠ¶æ€:** ğŸ“ è¿›è¡Œä¸­  
> **æ—¥æœŸ:** 2025-12-28  
> **ç›®çš„:** è¿½è¸ªè®ºæ–‡æ‰€éœ€å®éªŒ + æ£€ç´¢å·²æœ‰ç»“æœçš„æœç´¢è¯

---

## ğŸ“Š æ€»è§ˆ

| ä¼˜å…ˆçº§ | æ•°é‡ | çŠ¶æ€ |
|--------|------|------|
| ğŸ”´ P0 å¿…é¡»å®Œæˆ | 5 | âœ… **5 å·²å®Œæˆ**ï¼ˆSW æ ¹å› å·²æŸ¥æ˜ï¼‰|
| ğŸŸ¡ P1 åº”è¯¥å®Œæˆ | 4 | ğŸ”† 1 è¿è¡Œä¸­, 3 å¾…å¼€å§‹ |
| ğŸŸ¢ P2 å¯é€‰å®Œæˆ | 4 | 0 å·²å¼€å§‹ |

---

## ğŸ”´ P0ï¼šå¿…é¡»å®Œæˆï¼ˆæŠ•ç¨¿é˜»å¡é¡¹ï¼‰

### P0.1 å®Œæˆ 100 ä¸‡è®­ç»ƒ + æŠ¥å‘Šæµ‹è¯•æŒ‡æ ‡

**å¿…è¦æ€§ï¼š** è®ºæ–‡ä¸èƒ½åªç”¨éªŒè¯æŒ‡æ ‡ï¼›éœ€è¦æµ‹è¯•é›† RÂ²/MAEï¼ˆæ•´ä½“ + åˆ† SNRï¼‰ã€‚

**å½“å‰çŠ¶æ€ï¼š** âœ… **å·²å®Œæˆ**

**ç»“æœï¼š**
- [x] 200 epochs å®Œæˆ (best @ epoch 128)
- [x] æœ€ä½³æ£€æŸ¥ç‚¹ï¼š`best_epoch=128-val_mae=0.3720-val_r2=0.7182.ckpt`
- [x] **æµ‹è¯• RÂ² = 0.711**, MAE = 0.372 dex
- [x] åˆ† SNR ç»“æœè§ `r2_vs_snr_ceiling_test_10k_unified_snr.png`
- [x] å­¦ä¹ æ›²çº¿å·²ç”Ÿæˆ

**æ•°æ®æ¥æºï¼š** `logg/vit/exp/exp_vit_scaling_curve_20251227.md`, `logg/vit/vit_hub_20251227.md`

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- âœ… è¡¨æ ¼ï¼šä¸»è¦æµ‹è¯•æŒ‡æ ‡ï¼ˆTable 3ï¼‰
- âœ… å›¾è¡¨ï¼šRÂ² vs SNRï¼ˆFigure 1ï¼‰

---

### P0.2 LightGBM åŸºçº¿ï¼ˆç›¸åŒ 100 ä¸‡æ•°æ®é›†ï¼‰

**å¿…è¦æ€§ï¼š** æŠ¥å‘Šä¸­çš„"vs åŸºçº¿å¾…æ¯”è¾ƒ"ä¼šè¢«å®¡ç¨¿äººè´¨ç–‘ã€‚

**å½“å‰çŠ¶æ€ï¼š** âœ… **å·²å®Œæˆ**

**ç»“æœï¼š**
- [x] LightGBM 1M è®­ç»ƒå®Œæˆ
- [x] ç›¸åŒæµ‹è¯•é›†è¯„ä¼°
- [x] **æµ‹è¯• RÂ² = 0.614**
- [x] åˆ† SNR ç»“æœè§ä¸»å›¾

**ViT vs LightGBMï¼š**
| æ¨¡å‹ | RÂ² (test) | å·®è· |
|------|-----------|------|
| **ViT** | **0.711** | - |
| LightGBM | 0.614 | **-14%** |

**æ•°æ®æ¥æºï¼š** `logg/vit/exp/exp_vit_scaling_curve_20251227.md`

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- âœ… è¡¨æ ¼ï¼šViT vs LightGBMï¼ˆTable 3ï¼‰
- âœ… å›¾è¡¨ï¼šRÂ²â€“SNR å¯¹æ¯”å›¾ï¼ˆFigure 1ï¼‰

---

### P0.3 æ•°æ®è§„æ¨¡åŒ–æ›²çº¿ï¼ˆN = 50k â†’ 1Mï¼‰

**å¿…è¦æ€§ï¼š** æ ¸å¿ƒè¯æ®ï¼Œè§£é‡Š"ä¸ºä»€ä¹ˆ ViT ä¹‹å‰å¤±è´¥"â€”â€” **Transformer çš„æ•°æ®éœ€æ±‚**ã€‚

**å½“å‰çŠ¶æ€ï¼š** âœ… **å·²å®Œæˆ**

**ç»“æœï¼š**
- [x] å›ºå®šæ¶æ„ï¼šp16_h256_L6
- [x] N = 50k, 100k, 200k, 500k, 1M å…¨éƒ¨å®Œæˆ
- [x] å¯¹æ¯” ViT vs LightGBM vs Ridge

**Scaling æ•°æ®ï¼š**
| N | ViT RÂ² | LightGBM RÂ² | Ridge RÂ² |
|---|--------|-------------|----------|
| 50k | 0.434 | 0.488 | 0.442 |
| **100k** | **0.596** | 0.553 | 0.475 |
| 200k | 0.673 | 0.547 | 0.474 |
| 500k | 0.709 | 0.574 | 0.490 |
| **1M** | **0.711** | **0.614** | 0.50 |

**å…³é”®å‘ç°ï¼š**
- âœ… ViT åœ¨ **100k é¦–æ¬¡è¶…è¶Š LightGBM**
- âœ… Scaling æ–œç‡ï¼šViT (0.277) æ˜¯ LightGBM (0.126) çš„ **2.2Ã—**
- âš ï¸ 500kâ†’1M ä»… +0.002ï¼Œå½“å‰æ¶æ„å·²é¥±å’Œ

**æ•°æ®æ¥æºï¼š** `logg/vit/exp/exp_vit_scaling_curve_20251227.md`

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- âœ… å›¾è¡¨ï¼š`logg/vit/exp/img/vit_scaling_curve.png`ï¼ˆFigure 3ï¼‰

---

### P0.4 SNR æ‰«æè¯„ä¼°ä¸ Fisher/CRLB ä¸Šé™å¯¹é½

**å¿…è¦æ€§ï¼š** ä¸»å›¾éœ€è¦ä¸€è‡´çš„æ•°æ®æ¥æºï¼ˆä¸Šé™æ›²çº¿å’Œæ¨¡å‹æ›²çº¿ï¼‰ã€‚

**å½“å‰çŠ¶æ€ï¼š** âœ… **å·²å®Œæˆ**

**ç»“æœï¼š**
- [x] æŒ‰æ˜Ÿç­‰åŒºé—´åˆ’åˆ†æµ‹è¯•é›†
- [x] æ¯ä¸ªåŒºé—´çš„ RÂ² å·²è®¡ç®—
- [x] Fisher/CRLB 5D ä¸Šé™å·²è®¡ç®—
- [x] å·®è·åˆ†æå®Œæˆ

**Per-SNR æ•°æ®ï¼š**
| Magnitude | SNR | ViT RÂ² | LightGBM RÂ² | Ceiling RÂ² | Gap |
|-----------|-----|--------|-------------|------------|-----|
| 18.0 | 87 | ~0.99 | ~0.84 | 0.999 | ~0.01 |
| 20.0 | 24 | 0.90 | 0.87 | 0.989 | 0.09 |
| 21.5 | 7.1 | 0.80 | 0.74 | 0.874 | 0.07 |
| **22.0** | **4.6** | **0.68** | 0.60 | **0.698** | **0.02** |
| 22.5 | 3.0 | 0.52 | 0.42 | 0.265 | - |

**å…³é”®å‘ç°ï¼š**
- âœ… ViT åœ¨ mag=22.0 (SNRâ‰ˆ5) é€¼è¿‘ ceilingï¼Œgap ä»… 0.02
- âœ… 5D ceiling = 0.874 @ mag=21.5

**æ•°æ®æ¥æºï¼š** `logg/vit/vit_hub_20251227.md`, `logg/scaling/exp/img/r2_vs_snr_ceiling_test_10k_unified_snr.png`

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- âœ… å›¾è¡¨ï¼š`logg/scaling/exp/img/r2_vs_snr_ceiling_test_10k_unified_snr.png`ï¼ˆ**Figure 1 ä¸»å›¾**ï¼‰

---

### P0.5 Tokenization æ¶ˆèï¼ˆ100 ä¸‡æˆ– â‰¥20 ä¸‡ï¼‰

**å¿…è¦æ€§ï¼š** è®ºæ–‡å£°ç§°"ç‰©ç†æ„ŸçŸ¥ tokenization æ˜¯å…³é”®"â€”â€”å¿…é¡»ç”¨æ¶ˆèè¯æ˜ã€‚

**å½“å‰çŠ¶æ€ï¼š** âš ï¸ **éƒ¨åˆ†å®Œæˆï¼ˆSW å¤±è´¥éœ€è°ƒæŸ¥ï¼‰**

**å·²å®Œæˆï¼š**
- [x] C1D: Best Val RÂ² = 0.6308 (79 runs, 23 finished)
- [x] Patch Size å¯¹æ¯” (C1D only):
  - patch=16: RÂ² = 0.5823 Â± 0.045 âœ… æœ€ä¼˜
  - patch=32: RÂ² = 0.4728 Â± 0.128
  - patch=64: RÂ² = 0.5335

**âš ï¸ é—®é¢˜ï¼šSW (Sliding Window) å®Œå…¨å¤±è´¥** âœ… æ ¹å› å·²æŸ¥æ˜
- 15 runs å…¨éƒ¨å¤±è´¥ï¼ˆ0/15 å®Œæˆï¼‰
- âœ… **æ ¹å› **ï¼šSW çš„ Transformer æ¢¯åº¦æ˜¯ C1D çš„ **2 å€**ï¼Œå¯¼è‡´è®­ç»ƒåŠ¨æ€ä¸ç¨³å®š
- âœ… **è¯æ®**ï¼šå•æ­¥æµ‹è¯• SW gradient norm=11.46 vs C1D=5.63
- âŒ **æ’é™¤**ï¼šä¸æ˜¯å®ç° bugï¼ˆå•å…ƒæµ‹è¯•é€šè¿‡ï¼Œæ¢¯åº¦æµæ­£å¸¸ï¼‰

**è®ºæ–‡å¤„ç†æ–¹å¼ï¼š**
- âœ… æŠ¥å‘Š C1D + patch_size æ¶ˆèä½œä¸ºä¸»è¦ç»“æœ
- âœ… æåŠ SW éœ€è¦ä¸åŒå­¦ä¹ ç‡/ä¼˜åŒ–ç­–ç•¥ï¼ˆfuture workï¼‰
- è¯¦è§ `exp_tokenization_ablation_20251228.md`

**æ•°æ®æ¥æºï¼š** `logg/vit/exp/exp_tokenization_ablation_20251228.md`

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- âœ… è¡¨æ ¼ï¼šæ¶ˆèç»“æœï¼ˆC1D + patch_size å·²å®Œæˆï¼‰
- âœ… SW å¤±è´¥åŸå› å·²è®°å½•ï¼ˆè®ºæ–‡å¯å¼•ç”¨ï¼Œfuture workï¼‰

---

## ğŸŸ¡ P1ï¼šåº”è¯¥å®Œæˆï¼ˆå¢å¼ºè®ºæ–‡ï¼‰

### P1.1 æŸå¤±å‡½æ•° & æ ‡ç­¾å½’ä¸€åŒ–ç ”ç©¶

**å¿…è¦æ€§ï¼š** å·²æœ‰ 2 ä¸ªè¿è¡Œï¼ˆMSE+standard, L1+minmaxï¼‰ã€‚è‡ªç„¶çš„"è®­ç»ƒé²æ£’æ€§"æ•…äº‹ã€‚

**å½“å‰çŠ¶æ€ï¼š** ğŸ”† è¿è¡Œä¸­

**å½“å‰ Runsï¼š**
| Run | Loss | Label Norm | Tokenization | Status |
|-----|------|------------|--------------|--------|
| Run 1 | MSE | standard | C1D | ğŸš€ ep96+ |
| Run 2 | L1 | minmax | SW | ğŸš€ ep0+ |

**æ‰€éœ€äº§å‡ºï¼š**
- [ ] ç­‰å¾… Run 1 å’Œ Run 2 å®Œæˆ
- [ ] å¯¹æ¯” MSE vs L1 æ•ˆæœ
- [ ] å¯¹æ¯” standard vs minmax æ•ˆæœ

**æ•°æ®æ¥æºï¼š** `logg/vit/vit_roadmap_20251227.md`

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- â³ å›¾è¡¨ï¼šå­¦ä¹ æ›²çº¿å¯¹æ¯”
- â³ è¡¨æ ¼ï¼šæœ€ç»ˆæµ‹è¯•æŒ‡æ ‡

---

### P1.2 ä½ç½®ç¼–ç æ¶ˆè

**å¿…è¦æ€§ï¼š** å¦‚æœ PIPE æ˜¯å–ç‚¹ï¼Œå¿…é¡»å±•ç¤ºæ”¶ç›Šï¼›å¦åˆ™é™çº§ä¸º"æ¢ç´¢"ã€‚

**å½“å‰çŠ¶æ€ï¼š** â³ å¾…å¼€å§‹

**æ‰€éœ€äº§å‡ºï¼š**
- [ ] Learned vs Sinusoidal vs PIPE vs RoPE
- [ ] ç›¸åŒæ¶æ„ã€ç›¸åŒæ•°æ®

**æœç´¢è¯ï¼š**
```
"PIPE positional embedding spectra"
"physics-informed positional embedding wavelength"
"RoPE spectra vit"
"position embedding ablation log_g"
```

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- è¡¨æ ¼ï¼šPE æ¶ˆè
- ï¼ˆåŠ åˆ†ï¼‰å›¾è¡¨ï¼šæ³¨æ„åŠ›å›¾ vs å…‰è°±çº¿ä½ç½®

---

### P1.3 å¤šä»»åŠ¡ vs å•ä»»åŠ¡

**å¿…è¦æ€§ï¼š** å¤©æ–‡ä»»åŠ¡é€šå¸¸æ¶‰åŠè€¦åˆå‚æ•°ï¼›å¤šä»»åŠ¡æ›´ç¬¦åˆå®é™…ã€‚

**å½“å‰çŠ¶æ€ï¼š** â³ å¾…å¼€å§‹

**æ‰€éœ€äº§å‡ºï¼š**
- [ ] è”åˆé¢„æµ‹ Teff/logg/[M/H]
- [ ] æ¯”è¾ƒå•ä»»åŠ¡ vs å¤šä»»åŠ¡çš„å„å‚æ•° RÂ²

**æœç´¢è¯ï¼š**
```
"multihead regression Teff logg MH vit"
"5D labels vit spectra"
"joint training stellar parameters transformer"
```

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- è¡¨æ ¼ï¼šå•ä»»åŠ¡ vs å¤šä»»åŠ¡ï¼ˆå„å‚æ•° RÂ²ï¼‰
- å›¾è¡¨ï¼šè¯¯å·®ç›¸å…³æ€§ / æ®‹å·®åæ–¹å·®

---

### P1.4 é²æ£’æ€§ï¼šè·¨å™ªå£°æ³›åŒ–

**å¿…è¦æ€§ï¼š** è¯æ˜æ¨¡å‹èƒ½è·¨å™ªå£°æ°´å¹³æ³›åŒ–ï¼Œæ›´æ¥è¿‘çœŸå®è§‚æµ‹ã€‚

**å½“å‰çŠ¶æ€ï¼š** â³ å¾…å¼€å§‹

**æ‰€éœ€äº§å‡ºï¼š**
- [ ] è®­ç»ƒ noise=1.0ï¼Œæµ‹è¯• {0.5, 2.0}
- [ ] è®­ç»ƒ noise={0.5, 2.0}ï¼Œæµ‹è¯• noise=1.0

**æœç´¢è¯ï¼š**
```
"noise_level=0.5 log_g vit"
"noise_level=2.0 log_g vit"
"cross-noise generalization spectra"
```

**è®ºæ–‡äº§å‡ºç‰©ï¼š**
- å›¾è¡¨ï¼šé²æ£’æ€§çŸ©é˜µï¼ˆè®­ç»ƒå™ªå£° Ã— æµ‹è¯•å™ªå£°ï¼‰

---

## ğŸŸ¢ P2ï¼šå¯é€‰å®Œæˆï¼ˆè®ºæ–‡å¢å¼ºï¼‰

### P2.1 å¯è§£é‡Šæ€§ï¼šæ³¨æ„åŠ›å¯è§†åŒ–

**å¿…è¦æ€§ï¼š** å±•ç¤ºæ³¨æ„åŠ›ä¸å·²çŸ¥å…‰è°±çº¿å¯¹é½ã€‚

**æœç´¢è¯ï¼š**
```
"attention map spectra vit line"
"integrated gradients spectra transformer"
"saliency log_g spectrum"
```

---

### P2.2 é¢„è®­ç»ƒ 100 ä¸‡ + å¾®è°ƒå°æ•°æ®

**å¿…è¦æ€§ï¼š** å±•ç¤ºé¢„è®­ç»ƒå¸¦æ¥çš„æ ·æœ¬æ•ˆç‡æå‡ã€‚

**æœç´¢è¯ï¼š**
```
"pretrain 1M finetune 10k log_g"
"transfer learning spectra vit"
```

---

### P2.3 åˆæˆ â†’ çœŸå®ï¼ˆåŸŸè¿ç§»ï¼‰

**å¿…è¦æ€§ï¼š** æœ€ç»ˆç›®æ ‡æ˜¯çœŸå®æ•°æ®ï¼›å³ä½¿åˆæ­¥ç»“æœä¹Ÿæœ‰ä»·å€¼ã€‚

**æœç´¢è¯ï¼š**
```
"LAMOST logg vit finetune"
"APOGEE spectra transformer logg"
```

---

## ğŸ“¦ è®ºæ–‡å°±ç»ªæ£€æŸ¥æ¸…å•ï¼ˆæŠ•ç¨¿æœ€å°é›†ï¼‰

æŠ•ç¨¿å‰ç¡®ä¿ï¼š

| # | é¡¹ç›® | çŠ¶æ€ | å¯¹åº”ç« èŠ‚ |
|---|------|------|----------|
| 1 | 100 ä¸‡æœ€ä½³æ£€æŸ¥ç‚¹ + æµ‹è¯•æŒ‡æ ‡ï¼ˆæ•´ä½“ + SNRï¼‰| âœ… RÂ²=0.711 | Â§6.2 |
| 2 | LightGBM 100 ä¸‡åŸºçº¿ï¼ˆç›¸åŒæ•°æ®/åˆ’åˆ†ï¼‰| âœ… RÂ²=0.614 | Â§6.2 |
| 3 | è§„æ¨¡åŒ–æ›²çº¿ï¼ˆN â†’ æ€§èƒ½ï¼‰| âœ… 50k-1M | Â§6.4 |
| 4 | RÂ²â€“SNR + Fisher/CRLB ä¸Šé™ + å·®è·ï¼ˆ**ä¸»å›¾**ï¼‰| âœ… Figure 1 | Â§5, å›¾ 1 |
| 5 | Tokenization æ¶ˆèï¼ˆC1D/SW/patch/overlap/normï¼‰| âš ï¸ C1Dâœ… SWâŒ | Â§6.6 |
| 6 | å¯å¤ç°æ€§ä¿¡æ¯ï¼ˆconfig, seed, paths, hyperparamsï¼‰| âœ… | é™„å½• |

---

## ğŸ¯ è®ºæ–‡æ•…äº‹çº¿

> **"ViT ä¹‹å‰å¤±è´¥ä¸æ˜¯å› ä¸ºä¸é€‚åˆå…‰è°±â€”â€”è€Œæ˜¯å› ä¸ºæ•°æ®è§„æ¨¡ä¸å¤Ÿã€‚å½“ N è¶³å¤Ÿå¤§æ—¶ï¼Œæ¨¡å‹èƒ½é€¼è¿‘ä¿¡æ¯è®ºæé™ã€‚"**

è¿™æ˜¯è®ºæ–‡çš„æ ¸å¿ƒå™äº‹ã€‚æ‰€æœ‰å®éªŒéƒ½åº”æ”¯æŒè¿™ä¸ªæ•…äº‹ã€‚

---

## ğŸ“ å¤‡æ³¨

- æ‰€æœ‰æœç´¢è¯ç”¨äºå®éªŒæ—¥å¿—ä»“åº“æ£€ç´¢ï¼ˆ`logg/`ï¼‰
- å¦‚æœç»“æœæœªæ‰¾åˆ°ï¼Œéœ€è¦è·‘å®éªŒ
- ä¼˜å…ˆå®Œæˆ P0 å®éªŒç”¨äºåˆæ¬¡æŠ•ç¨¿
- P1/P2 å¯åœ¨ä¿®ç¨¿æ—¶æ·»åŠ 

---

> **æœ€åæ›´æ–°ï¼š** 2025-12-28 (paper sync v3)  
> **åŒæ­¥æ¥æºï¼š** `logg/vit/vit_hub_20251227.md`, `logg/vit/exp/exp_vit_scaling_curve_20251227.md`, `logg/vit/exp/exp_tokenization_ablation_20251228.md`, `logg/vit/exp/exp_fisher_residual_overlay_20251228.md`
