# ğŸ—ºï¸ MoE Roadmap
> **Name:** Mixture of Experts | **ID:** `VIT-20251203-moe-roadmap`  
> **Topic:** `moe` | **Phase:** 16 | **Project:** `VIT`  
> **Author:** Viska Wei | **Date:** 2025-12-03 | **Status:** ğŸ”„ è¿›è¡Œä¸­
```
ğŸ’¡ å½“å‰é˜¶æ®µç›®æ ‡  
Gate-16ï¼šéªŒè¯ MoE åœ¨ 1M + noise=1 ä¸‹æ˜¯å¦ä»æœ‰æ•ˆï¼ˆä¸‰å±‚è®ºè¯ï¼‰
```

| å½“å‰è¿›åº¦ | Phase 15 âœ… å®Œæˆ | Phase 16 ğŸ”„ è¿›è¡Œä¸­ |
|---------|-----------------|-------------------|
| æœ€ä½³ç»“æœ | RÂ²=0.9400 (100k) | ç›®æ ‡ï¼šéªŒè¯ noise=1 å¯è½åœ°æ€§ |

---

# 1. ğŸš¦ Decision Gates

## 1.1 æˆ˜ç•¥è·¯çº¿ (æ¥è‡ª Hub)

| Route | åç§° | Hubæ¨è | éªŒè¯Gate |
|-------|------|---------|----------|
| M | MoE + Soft Gate | ğŸŸ¢ **æ¨è** | Gate-16O, Gate-16G |
| I | Conditional Ridge | ğŸŸ¡ å¤‡é€‰ | - |
| C | 1D-CNN | ğŸŸ¡ å¾…éªŒ | Gate-16CNN |

## 1.2 Gate å®šä¹‰

### Gate-16O: Oracle MoE Headroom @ noise=1

| é¡¹ | å†…å®¹ |
|----|------|
| éªŒè¯ | Oracle MoE - Global Ridge â‰¥ 0.05ï¼Ÿ |
| MVP | MVP-16O (SCALING-20251223) |
| è‹¥ A | Î”RÂ² â‰¥ 0.05 â†’ MoE å€¼å¾—ç»§ç»­ |
| è‹¥ B | Î”RÂ² < 0.02 â†’ æ”¾å¼ƒ MoEï¼Œä¸Š CNN |
| çŠ¶æ€ | âœ… **å·²é€šè¿‡** (Î”RÂ²=+0.1637) |

### Gate-16G: å¯è½åœ° Gate @ noise=1

| é¡¹ | å†…å®¹ |
|----|------|
| éªŒè¯ | Soft routing Ï â‰¥ 0.7ï¼Ÿ |
| MVP | MVP-16G |
| è‹¥ A | Ï â‰¥ 0.7 â†’ MoE å¯éƒ¨ç½² |
| è‹¥ B | Ï < 0.5 â†’ è½¬å‘ CNN |
| çŠ¶æ€ | â³ å¾…éªŒè¯ |

### Gate-16T: ç†è®ºä¸Šé™

| é¡¹ | å†…å®¹ |
|----|------|
| éªŒè¯ | Fisher/CRLB RÂ²_maxï¼Ÿ |
| MVP | MVP-16T |
| è‹¥ A | RÂ²_max â‰¥ 0.75 â†’ å­˜åœ¨å¤§ headroom |
| è‹¥ B | RÂ²_max â‰ˆ 0.6 â†’ ç›®æ ‡æ”¹ä¸ºé€¼è¿‘ä¸Šé™ |
| çŠ¶æ€ | â³ å¾…éªŒè¯ |

## 1.3 æœ¬å‘¨é‡ç‚¹

| ä¼˜å…ˆçº§ | MVP | Gate | çŠ¶æ€ |
|--------|-----|------|------|
| ğŸ”´ P0 | MVP-16G | Gate-16G | â³ |
| ğŸŸ¡ P1 | MVP-16T | Gate-16T | â³ |
| ğŸŸ¡ P1 | MVP-12B | Coverage++ | â³ |

---

# 2. ğŸ“‹ MVP åˆ—è¡¨

## 2.1 æ€»è§ˆ

| MVP | åç§° | Phase | Gate | çŠ¶æ€ | exp_id | æŠ¥å‘Š |
|-----|------|-------|------|------|--------|------|
| 1.0 | åˆ†æ®µ Ridge | 1 | - | âš ï¸ è¢«ä¿®æ­£ | `VIT-20251203-moe-piecewise-01` | [Link](./exp/exp_moe_piecewise_ridge_20251203.md) |
| 1.1 | ä¸¥æ ¼éªŒè¯ | 1 | - | âœ… | `VIT-20251203-moe-rigorous-01` | [Link](./exp/exp_moe_rigorous_validation_20251203.md) |
| 2.0 | å™ªå£°æ¡ä»¶ | 2 | - | âœ… | `VIT-20251203-moe-snr-02` | [Link](./exp/exp_moe_noise_conditioned_20251203.md) |
| 3.0 | åˆ†ä½æ•°åˆ†æ¡¶ | 3 | - | âŒ è´Ÿé¢ | `VIT-20251203-moe-quantile-01` | [Link](./exp/exp_moe_quantile_bins_sweep_20251203.md) |
| PG1 | ç‰©ç†çª—é—¨æ§ | 8 | - | âœ… | `VIT-20251204-moe-phys-gate-01` | [Link](./exp/exp_moe_phys_gate_baseline_20251204.md) |
| 9E1 | 9ä¸“å®¶æ‰©å±• | 9 | - | âœ… | `VIT-20251204-moe-9expert-01` | - |
| NN1 | NNä¸“å®¶ | 10 | - | âŒ è´Ÿé¢ | `VIT-20251204-moe-nn-expert-01` | [Link](./exp/exp_moe_nn_experts_20251204.md) |
| Next-A | å›å½’é—¨æ§ | 11 | - | âœ… | `VIT-20251204-moe-regress-gate-01` | - |
| Next-C | ä¸“å®¶æ ¡å‡† | 11 | - | âŒ è´Ÿé¢ | `VIT-20251204-moe-calibration-01` | [Link](./exp/exp_moe_expert_calibration_20251204.md) |
| 12A | 100kå¤åˆ¶ | 12 | - | âœ… | `VIT-20251205-moe-100k-01` | [Link](./exp/exp_moe_100k_replication_20251205.md) |
| 15 | LGBMä¸“å®¶ | 15 | - | âš ï¸ éƒ¨åˆ† | `VIT-20251205-moe-lgbm-expert-01` | [Link](./exp/exp_moe_lgbm_expert_20251205.md) |
| **16O** | **Oracle MoE noise=1** | 16 | Gate-16O | âœ… | `SCALING-20251223-oracle-moe-noise1-01` | [Link](../scaling/exp/exp_scaling_oracle_moe_noise1_20251223.md) |
| 16G | å¯è½åœ° Gate noise=1 | 16 | Gate-16G | â³ | - | - |
| 16T | Fisher ç†è®ºä¸Šé™ | 16 | Gate-16T | â³ | - | - |
| 12B | Coverage++ | 12 | - | â³ | - | - |

**çŠ¶æ€**: â³è®¡åˆ’ | ğŸ”´å°±ç»ª | ğŸš€è¿è¡Œ | âœ…å®Œæˆ | âŒè´Ÿé¢ | âš ï¸éƒ¨åˆ†æˆåŠŸ

## 2.2 é…ç½®é€ŸæŸ¥

| MVP | æ•°æ®é‡ | å™ªå£° | æ¨¡å‹ | å…³é”®å˜é‡ |
|-----|--------|------|------|---------|
| 1.1 | 32k/100k | 0.2 | Ridge | 9 bins |
| PG1 | 32k | 0.2 | Ridge + LogReg gate | 11 ç»´ç‰©ç†çª—ç‰¹å¾ |
| 12A | 100k | 0.2 | Ridge + MLP gate | å›å½’ loss |
| 16O | 1M | 1.0 | Ridge Î±=100k | Oracle routing |
| 16G | 1M | 1.0 | Ridge + Soft gate | ç‰©ç†çª—ç‰¹å¾ |

---

# 3. ğŸ”§ MVP è§„æ ¼

## Phase 16: 1M + noise=1 éªŒè¯ï¼ˆä¸‰å±‚è®ºè¯ï¼‰

### MVP-16T: Fisher/CRLB ç†è®ºä¸Šé™

| é¡¹ | é…ç½® |
|----|------|
| ç›®æ ‡ | ç¡®å®š log g é¢„æµ‹çš„ç†è®ºä¸Šé™ RÂ²_max |
| æ–¹æ³• | Fisher ä¿¡æ¯çŸ©é˜µ + CRLB è®¡ç®— |
| éªŒæ”¶ | è¾“å‡º RÂ²_max æ•°å€¼ |

### MVP-16O: Oracle MoE Headroom âœ… å·²å®Œæˆ

| é¡¹ | é…ç½® |
|----|------|
| ç›®æ ‡ | éªŒè¯ Oracle MoE - Global â‰¥ 0.05 |
| æ•°æ® | 1M train, 1k test, noise=1.0 |
| æ¨¡å‹ | 9-bin Ridge (Î±=100k), Oracle routing |
| ç»“æœ | **Î”RÂ²=+0.1637 >> 0.05 âœ…** |

### MVP-16G: å¯è½åœ° Gate @ noise=1

| é¡¹ | é…ç½® |
|----|------|
| ç›®æ ‡ | éªŒè¯ Soft routing Ï â‰¥ 0.7 |
| æ•°æ® | 1M train, 1k test, noise=1.0 |
| æ¨¡å‹ | 9-bin Ridge + ç‰©ç†çª— Soft gate |
| éªŒæ”¶ | Ï â‰¥ 0.7 |

**Gateå½±å“**: 
- Ï â‰¥ 0.7 â†’ MoE å¯éƒ¨ç½²åˆ°çœŸå®ä½ SNR æ•°æ®
- Ï < 0.5 â†’ è½¬å‘ CNN

### MVP-12B: Coverage++

| é¡¹ | é…ç½® |
|----|------|
| ç›®æ ‡ | ä» 81.6% è¦†ç›–æå‡åˆ° 100% |
| æ–¹æ³• | ç¬¬ 10 ä¸ª out-of-range expert |
| éªŒæ”¶ | full-test RÂ² > 0.91 |

---

# 4. ğŸ“Š è¿›åº¦è¿½è¸ª

## 4.1 çœ‹æ¿

```
â³è®¡åˆ’    ğŸ”´å°±ç»ª    ğŸš€è¿è¡Œ    âœ…å®Œæˆ
MVP-16T                       MVP-1.1
MVP-16G                       MVP-PG1
MVP-12B                       MVP-12A
                              MVP-16O âœ…
```

## 4.2 Gate è¿›åº¦

| Gate | MVP | çŠ¶æ€ | ç»“æœ |
|------|-----|------|------|
| Gate-16O | MVP-16O | âœ… | Î”RÂ²=+0.1637 >> 0.05 |
| Gate-16G | MVP-16G | â³ | - |
| Gate-16T | MVP-16T | â³ | - |

## 4.3 ç»“è®ºå¿«ç…§

| MVP | ç»“è®º | å…³é”®æŒ‡æ ‡ | åŒæ­¥Hub |
|-----|------|---------|---------|
| 1.1 | MoE ç»“æ„çº¢åˆ©çœŸå® | Î”RÂ²=+0.050, CI=[0.033,0.067] | âœ… |
| PG1 | Soft Gate ä¿ä½ 100% | Ï=1.00 | âœ… |
| 12A | 100k ç¨³æ€å¤ç° | RÂ²=0.9400 | âœ… |
| 16O | é«˜å™ªå£°æ”¾å¤§ç»“æ„çº¢åˆ© | Î”RÂ²=+0.1637 | âœ… |
| NN1 | å…¨è°± MLP ä¸å¦‚ Ridge | RÂ²_NN=0.38 << 0.87 | âœ… |
| Next-C | æ ¡å‡†æ— æ•ˆ | Î”RÂ²=-0.001 | âœ… |
| 15 | Hybrid MoE éƒ¨åˆ†æˆåŠŸ | Bin3 +0.056, Bin6 -0.032 | âœ… |

## 4.4 æ—¶é—´çº¿

| æ—¥æœŸ | äº‹ä»¶ |
|------|------|
| 2025-12-03 | MVP-1.0, 1.1, 2.0, 3.0 å®Œæˆ |
| 2025-12-04 | MVP-PG1, 9E1, NN1, Next-A/B/C å®Œæˆ |
| 2025-12-09 | MVP-12A å®Œæˆ (100k ç¨³æ€) |
| 2025-12-10 | MVP-15 å®Œæˆ (Hybrid MoE) |
| 2025-12-23 | Phase 16 ç«‹é¡¹ |
| 2025-12-24 | MVP-16O å®Œæˆ (Î”RÂ²=+0.16) |
| 2025-12-27 | çŸ›ç›¾å®¡è®¡ï¼Œæ–‡æ¡£é‡å†™ |

---

# 5. ğŸ”— è·¨ä»“åº“é›†æˆ

## 5.1 å®éªŒç´¢å¼•

| exp_id | project | topic | çŠ¶æ€ | MVP |
|--------|---------|-------|------|-----|
| `VIT-20251203-moe-rigorous-01` | VIT | moe | âœ… | MVP-1.1 |
| `VIT-20251204-moe-phys-gate-01` | VIT | moe | âœ… | MVP-PG1 |
| `VIT-20251205-moe-100k-01` | VIT | moe | âœ… | MVP-12A |
| `SCALING-20251223-oracle-moe-noise1-01` | VIT | scaling/moe | âœ… | MVP-16O |

## 5.2 ä»“åº“é“¾æ¥

| ä»“åº“ | è·¯å¾„ | ç”¨é€” |
|------|------|------|
| VIT | `~/VIT/results/moe/` | è®­ç»ƒç»“æœ |
| æœ¬ä»“åº“ | `logg/moe/` | çŸ¥è¯†åº“ |
| æœ¬ä»“åº“ | `logg/scaling/` | è§„æ¨¡æ•ˆåº” |

---

# 6. ğŸ“ é™„å½•

## 6.1 æ•°å€¼æ±‡æ€»

| MVP | é…ç½® | RÂ² | Î”RÂ² | å¤‡æ³¨ |
|-----|------|-----|-----|------|
| 1.1 | 32k, noise=0.2 | 0.9116 | +0.050 | 9-bin MoE |
| PG1 | 32k, noise=0.2 | 0.9051 | Ï=1.00 | Soft Gate |
| Next-A | 32k, noise=0.2 | 0.9310 | +0.0097 | å›å½’ Gate |
| 12A | 100k, noise=0.2 | **0.9400** | +0.0090 vs 32k | ğŸ† æœ€ä½³ |
| 16O | 1M, noise=1.0 | 0.6249 | **+0.1637** | Oracle |
| Baseline | noise=0.2 | 0.8616 | - | Global Ridge |
| Baseline | noise=1.0 | 0.4611 | - | Global Ridge |

## 6.2 æ–‡ä»¶ç´¢å¼•

| ç±»å‹ | è·¯å¾„ |
|------|------|
| Roadmap | `moe_roadmap_20251203.md` |
| Hub | `moe_hub_20251203.md` |
| SNR-MoE Hub | `moe_snr_hub.md` |
| å›¾è¡¨ | `img/` |

## 6.3 æ›´æ–°æ—¥å¿—

| æ—¥æœŸ | å˜æ›´ | ç« èŠ‚ |
|------|------|------|
| 2025-12-03 | åˆ›å»º | - |
| 2025-12-04 | Phase 8-11 å®Œæˆ | å…¨éƒ¨ |
| 2025-12-09 | Phase 12A å®Œæˆ | Â§4 |
| 2025-12-23 | Phase 16 ç«‹é¡¹ | Â§1, Â§3 |
| 2025-12-24 | MVP-16O å®Œæˆ | Â§2, Â§4 |
| **2025-12-27** | **çŸ›ç›¾å®¡è®¡é‡å†™** | å…¨æ–‡ |
