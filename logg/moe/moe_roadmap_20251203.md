# ğŸ—ºï¸ MoE å®éªŒè·¯çº¿å›¾ï¼ˆRoadmapï¼‰

---
> **ä¸»é¢˜åç§°ï¼š** Mixture of Expertsï¼ˆMoEï¼‰è¦ä¸è¦ä¸Šï¼Ÿä»€ä¹ˆæ—¶å€™æœ‰ç”¨ï¼Ÿ  
> **ä½œè€…ï¼š** Viska Wei  
> **åˆ›å»ºæ—¥æœŸï¼š** 2025-12-03  
> **æœ€åæ›´æ–°ï¼š** 2025-12-23  
> **å½“å‰ Phaseï¼š** Phase 15 âš ï¸ å®Œæˆ â†’ æ‰§è¡Œ **Phase 16 (1M + noise=1 å¤§è§„æ¨¡ä½ SNR éªŒè¯)**

---

## ğŸ”— ç›¸å…³æ–‡ä»¶

| ç±»å‹ | æ–‡ä»¶ | è¯´æ˜ |
|------|------|------|
| ğŸ§  Hub | [`moe_hub.md`](./moe_hub_20251203.md) | æ™ºåº“å¯¼èˆª |
| ğŸ“‹ Kanban | [`kanban.md`](../../status/kanban.md) | å…¨å±€çœ‹æ¿ |
| ğŸ“— å­å®éªŒ | `exp_moe_*.md` | å•å®éªŒè¯¦æƒ… |

---

# ğŸ“‘ ç›®å½•

- [1. ğŸ¯ Phase æ€»è§ˆ](#1--phase-æ€»è§ˆ)
- [2. ğŸ“‹ MVP å®éªŒåˆ—è¡¨](#2--mvp-å®éªŒåˆ—è¡¨)
- [3. ğŸ”§ MVP è¯¦ç»†è®¾è®¡](#3--mvp-è¯¦ç»†è®¾è®¡)
- [4. ğŸ“Š è¿›åº¦è¿½è¸ª](#4--è¿›åº¦è¿½è¸ª)
- [5. ğŸ”— è·¨ä»“åº“é›†æˆ](#5--è·¨ä»“åº“é›†æˆ)
- [6. ğŸ“ é™„å½•](#6--é™„å½•)

---

# 1. ğŸ¯ Phase æ€»è§ˆ

## 1.1 Phase åˆ—è¡¨

| Phase | ç›®çš„ | åŒ…å« MVP | çŠ¶æ€ | å…³é”®äº§å‡º |
|-------|------|---------|------|---------|
| **Phase 0: Baseline** | å»ºç«‹å…¨å±€ Ridge åŸºå‡† | MVP-0 | âœ… å®Œæˆ | baseline RÂ²=0.8616 |
| **Phase 1: åˆ†åŒºé—´ Ridge** | éªŒè¯"åˆ†æ®µç®€å•"å‡è®¾ | MVP-1.x | âœ… å®Œæˆ | Î”RÂ²=+0.050ï¼Œ[M/H] 68.7% |
| **Phase 2: æŒ‰ SNR åˆ†ä¸“å®¶** | éªŒè¯ noise-conditioned MoE | MVP-2.0 | âœ… å®Œæˆ | Î”RÂ²=+0.080 |
| **Phase 3: å¯è½åœ°æ€§éªŒè¯** | Quantile + Pseudo + Conditional | MVP-3.x | âœ… å®Œæˆï¼ˆè´Ÿé¢+æ­£é¢ï¼‰ | Quantile âŒï¼ŒCond âœ… 80% |
| **Phase 4: log g é—¨æ§ä¸Šé™** | Oracle/Pseudo/Learned gate | MVP-4.0 | â³ è®¡åˆ’ä¸­ | - |
| **Phase 5: ç³»æ•°è§£é‡Š** | Ridge ç³»æ•°æ³¢æ®µåˆ†æ | MVP-5.0 | âœ… å®Œæˆ | Ca II 1.65Ã— |
| **Phase 6: NN-MoE** | éçº¿æ€§ MoEï¼ˆæ¡ä»¶æ»¡è¶³æ‰åšï¼‰ | MVP-6.x | â³ è®¡åˆ’ä¸­ | - |
| **Phase 7: è¿ç»­æ¡ä»¶åŒ–** | ä»ç¦»æ•£ â†’ è¿ç»­æ¡ä»¶æ¨¡å‹ | MVP-7.x | âŒ å–æ¶ˆ | Gate å·²è§£å†³ï¼Œä¸éœ€è¦ |
| **ğŸŸ¢ Phase 8: ç‰©ç†çª— Gate** | ç”¨ç‰©ç†çª—ç‰¹å¾éªŒè¯ gate å¯è½åœ°æ€§ | MVP-PG1~PG3 | âœ… **MVP-PG1 å®Œæˆ** | **Ï=1.00 è¶…é¢„æœŸï¼** |
| **ğŸŸ¢ Phase 9: 9 ä¸“å®¶æ‰©å±•** | ç‰©ç†çª— gate â†’ 9 ä¸“å®¶ (TeffÃ—[M/H]) | MVP-9E1 | âœ… **å®Œæˆï¼** | **RÂ²=0.9213, Ï=1.13** |
| **âš ï¸ Phase 10: NN Expert** | å›ºå®š gate + NN expert | MVP-NN1 | âœ… å®Œæˆ | âš ï¸ NN<<Ridgeï¼Œæš‚åœ |
| **ğŸŸ¢ Phase 11: ä¼˜åŒ– & å·¥ç¨‹åŒ–** | å›å½’æœ€ä¼˜ gate + coverage + æ ¡å‡† | MVP-Next-A/B/C | **MVP-Next-A âœ…, MVP-Next-B âœ…** | M2 é‡Œç¨‹ç¢‘ |
| **ğŸŸ¢ Phase 12: å¤§è§„æ¨¡éªŒè¯** | 100k å¤åˆ» + Coverage++ | MVP-12A/12B | **MVP-12A âœ…, MVP-12B â³** | **RÂ²=0.9400 ç¨³æ€ï¼** |
| **ğŸŸ¡ Phase 13: ç‰¹å¾å¢å¼º & å°æ¨¡å‹** | Feature mining + embedding + LGBM expert | MVP-13/14/15 | âš ï¸ MVP-15 å®Œæˆ | Bin3 +0.056 âœ…, Bin6 âŒ |
| **ğŸ”´ Phase 16: 1M + noise=1** | å¤§è§„æ¨¡ä½ SNR éªŒè¯ | MVP-16A | â³ ç«‹é¡¹ä¸­ | é«˜å™ªå£°é²æ£’æ€§éªŒè¯ |

## 1.2 ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MVP å®éªŒä¾èµ–å›¾ (Phase 11-13 å½“å‰é‡ç‚¹)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• å·²å®Œæˆè·¯å¾„ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                  â”‚
â”‚                                                                         â”‚
â”‚   Phase 0-2: âœ… MoE æœ‰ç»“æ„ (Î”RÂ²=0.050)                                  â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚   Phase 3: âœ… å¯è½åœ°æ€§éªŒè¯ â†’ Pseudo âŒ, Cond âœ… 80%                       â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚   Phase 5: âœ… ç³»æ•°è§£é‡Š â†’ Ca II é‡è¦                                      â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚   Phase 8: âœ… ç‰©ç†çª— Gate â†’ Ï=1.00 è¶…é¢„æœŸï¼                              â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚   Phase 9: âœ… 9 ä¸“å®¶æ‰©å±• â†’ RÂ²=0.9213, Ï=1.13                            â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚   Phase 10: âš ï¸ NN Expert â†’ NN<<Ridgeï¼Œæš‚åœ                              â”‚
â”‚         â”‚                                                               â”‚
â”‚         â–¼                                                               â”‚
â”‚   Phase 11: âœ… M2 é‡Œç¨‹ç¢‘è¾¾æˆ                                             â”‚
â”‚   â”œâ”€ MVP-Next-A âœ… å›å½’ Gate â†’ RÂ²=0.9310                                â”‚
â”‚   â”œâ”€ MVP-Next-B âœ… Full Coverage â†’ RÂ²=0.8957                            â”‚
â”‚   â””â”€ MVP-Next-C âŒ æ ¡å‡†å‡è®¾è¢«å¦å®š                                        â”‚
â”‚                                                                         â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• å½“å‰æ‰§è¡Œ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                    â”‚
â”‚                                                                         â”‚
â”‚   ğŸŸ¢ Phase 12: å¤§è§„æ¨¡éªŒè¯                                                â”‚
â”‚   â”œâ”€ [MVP-12A: 100k å¤åˆ»] âœ… å®Œæˆï¼                                      â”‚
â”‚   â”‚   â†’ RÂ²=0.9400 ç¨³å®šå¤ç°ï¼CI_low=0.0045 > 0                           â”‚
â”‚   â”‚   â†’ vs 32k baseline: +0.0090                                        â”‚
â”‚   â”‚                                                                     â”‚
â”‚   â””â”€ [MVP-12B: Coverage++] ğŸ”´ P0                                        â”‚
â”‚       â†’ ç¬¬ 10 ä¸ª oor expert                                              â”‚
â”‚       â†’ full RÂ² > 0.91                                                  â”‚
â”‚                                                                         â”‚
â”‚   ğŸŸ¡ Phase 13: ç‰¹å¾å¢å¼º & å°æ¨¡å‹ (P1 å¾…éªŒè¯)                             â”‚
â”‚   â”œâ”€ [MVP-13: Feature Mining] â†’ Bin3/Bin6 çª—å£ç‰¹å¾                      â”‚
â”‚   â”œâ”€ [MVP-14: Embedding Gate] â†’ 1M å‚æ•° CNN/AE                          â”‚
â”‚   â””â”€ [MVP-15: LGBM Expert] â†’ æ›¿æ¢å›°éš¾ bin expert                        â”‚
â”‚                                                                         â”‚
â”‚   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• å†³ç­–ç‚¹ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•                      â”‚
â”‚                                                                         â”‚
â”‚   MVP-12A å®Œæˆåï¼š                                                       â”‚
â”‚   â”œâ”€ å¦‚æœ 100k RÂ² â‰¥ 0.93 ä¸” > LGBM â†’ âœ… MoE ç¨³æ€ç»“è®º                    â”‚
â”‚   â””â”€ å¦‚æœ RÂ² ä¸‹é™æˆ– CI åŒ…å« 0 â†’ åˆ†æéš¾æ ·æœ¬                               â”‚
â”‚                                                                         â”‚
â”‚   MVP-12B å®Œæˆåï¼š                                                       â”‚
â”‚   â”œâ”€ å¦‚æœ full RÂ² > 0.91 â†’ âœ… å¯äº¤ä»˜                                    â”‚
â”‚   â””â”€ å¦‚æœ full RÂ² < 0.88 â†’ è½¬ Phase 13 ç‰¹å¾å¢å¼º                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 1.3 å†³ç­–ç‚¹

| å†³ç­–ç‚¹ | è§¦å‘æ¡ä»¶ | é€‰é¡¹ A | é€‰é¡¹ B |
|--------|---------|--------|--------|
| D1 | MVP-1.0 å®Œæˆå | âœ… Î”RÂ² â‰¥ 0.03 â†’ ç»§ç»­ Phase 2+ | å¦‚æœ < 0.03 â†’ ç»ˆæ­¢ |
| D2 | MVP-3.1 å®Œæˆå | å¦‚æœ Pseudo â‰¥ 70% â†’ Phase 6 | âŒ < 50% â†’ è½¬ Phase 7 |
| D3 | MVP-7.1 å®Œæˆå | å¦‚æœ Cond ä¿ä½ â‰¥60% â†’ ä¸»çº¿ç”¨ Cond | å¦‚æœä¸¤è€…éƒ½å´© â†’ éœ€è¦ latent gate |
| D4 | MVP-7.2 å®Œæˆå | å¦‚æœ â‰¥90% MoE â†’ ç”¨ Condï¼Œæ”¾å¼ƒ MoE | å¦‚æœ <80% â†’ ç»§ç»­ä¼˜åŒ–é—¨æ§ |

---

# 2. ğŸ“‹ MVP å®éªŒåˆ—è¡¨

## 2.1 å®éªŒæ€»è§ˆ

| MVP | å®éªŒåç§° | Phase | çŠ¶æ€ | experiment_id | æŠ¥å‘Šé“¾æ¥ |
|-----|---------|-------|------|---------------|---------|
| MVP-0 | å…¨å±€ Ridge Baseline | 0 | âœ… | - | (åŒ…å«åœ¨ MVP-1.0) |
| MVP-1.0 | Piecewise Ridge | 1 | âœ… | `VIT-20251203-moe-piecewise-01` | [exp](./exp/exp_moe_piecewise_ridge_20251203.md) |
| MVP-1.1 | ä¸¥è°¨éªŒè¯ | 1 | âœ… | `VIT-20251203-moe-rigorous-01` | [exp](./exp/exp_moe_rigorous_validation_20251203.md) |
| MVP-2.0 | Noise-conditioned Ridge | 2 | âœ… | `VIT-20251203-moe-snr-02` | [exp](./exp/exp_moe_noise_conditioned_20251203.md) |
| MVP-3.0 | Quantile Bins Sweep | 3 | âœ… | `VIT-20251203-moe-quantile-01` | [exp](./exp/exp_moe_quantile_bins_sweep_20251203.md) |
| MVP-3.1 | Pseudo Gating | 3 | âœ… | `VIT-20251203-moe-pseudo-01` | - |
| MVP-3.2 | Conditional Ridge | 3 | âœ… | `VIT-20251203-moe-conditional-01` | [exp](./exp/exp_moe_conditional_ridge_20251203.md) |
| MVP-4.0 | log g Gate Analysis | 4 | â³ | `VIT-20251203-moe-logg-gate-01` | - |
| MVP-5.0 | Ridge ç³»æ•°è§£é‡Š | 5 | âœ… | `VIT-20251203-moe-coef-01` | [exp](./exp/exp_moe_coefficient_analysis_20251203.md) |
| MVP-6.0 | Learned Gate | 6 | â³ | - | - |
| MVP-6.1 | NN-MoE | 6 | â³ | `VIT-20251203-moe-nn-03` | - |
| MVP-7.1 | Gate å™ªå£°æ•æ„Ÿæ€§ | 7 | â³ æš‚ç¼“ | - | - |
| MVP-7.2 | Conditional Ridge++ | 7 | â³ æš‚ç¼“ | - | - |
| MVP-7.3 | Noise è¿ç»­æ¡ä»¶åŒ– | 7 | â³ æš‚ç¼“ | - | - |
| MVP-7.4 | ç‰©ç†çª—é—¨æ§ | 7 | â†’ Phase 8 | - | - |
| **MVP-PG1** | **ğŸŸ¢ ç‰©ç†çª— Gate Baseline** | 8 | âœ… **å®Œæˆ Ï=1.00ï¼** | `VIT-20251204-moe-phys-gate-01` | [exp](./exp/exp_moe_phys_gate_baseline_20251204.md) |
| ~~MVP-PG2~~ | ~~çª—å£å½¢çŠ¶ PCA Gate~~ | 8 | âŒ ä¸éœ€è¦ | - | Ïâ‰ˆ1.00 å·²è¶³å¤Ÿ |
| MVP-PG3 | å° CNN Gate | 8 | â³ å¯é€‰ | - | é”¦ä¸Šæ·»èŠ± |
| **ğŸŸ¢ MVP-9E1** | **ç‰©ç†çª— gate â†’ 9 ä¸“å®¶** | **9** | **âœ… å®Œæˆï¼** | `VIT-20251204-moe-9expert-01` | [exp](./exp/exp_moe_9expert_phys_gate_20251204.md) |
| **âš ï¸ MVP-NN1** | **å›ºå®š gate + NN expert** | **10** | **âœ… å®Œæˆ** | `VIT-20251204-moe-nn-expert-01` | [exp](./exp/exp_moe_nn_experts_20251204.md) |
| **âœ… MVP-Next-A** | **å›å½’æœ€ä¼˜ soft mixing** | **11** | **âœ… RÂ²=0.9310 å®Œæˆï¼** | `VIT-20251204-moe-regress-gate-01` | [exp](./exp/exp_moe_regression_gate_20251204.md) |
| **âœ… MVP-Next-B** | **100% coverage** | **11** | **âœ… RÂ²=0.8957 å®Œæˆï¼** | `VIT-20251204-moe-full-coverage-01` | [exp](./exp/exp_moe_full_coverage_20251204.md) |
| **âŒ MVP-Next-C** | **Expert æ ¡å‡†** | **11** | **âŒ å®Œæˆ (Negative)** | `VIT-20251204-moe-calibration-01` | [exp](./exp/exp_moe_expert_calibration_20251204.md) |
| **âœ… MVP-12A** | **100k è§„æ¨¡å¤åˆ» Next-A** | **12** | **âœ… RÂ²=0.9400 å®Œæˆï¼** | `VIT-20251205-moe-100k-01` | [exp](./exp/exp_moe_100k_replication_20251205.md) |
| **ğŸ”´ MVP-12B** | **Coverage++** | **12** | **â³ ç«‹é¡¹ä¸­** | `VIT-20251205-moe-coverage-plus-01` | (å¾…åˆ›å»º) |
| **ğŸŸ¡ MVP-13** | **Feature mining Bin3/Bin6** | **13** | **â³ ç«‹é¡¹ä¸­** | `VIT-20251205-moe-feature-mining-01` | (å¾…åˆ›å»º) |
| **ğŸŸ¡ MVP-14** | **1M embedding for gate** | **13** | **â³ ç«‹é¡¹ä¸­** | `VIT-20251205-moe-embedding-01` | (å¾…åˆ›å»º) |
| **ğŸŸ¡ MVP-15** | **Hard bins å° LightGBM expert** | **13** | **â³ ç«‹é¡¹ä¸­** | `VIT-20251205-moe-lgbm-expert-01` | (å¾…åˆ›å»º) |

## 2.2 é…ç½®é€ŸæŸ¥è¡¨

| MVP | æ•°æ®è§„æ¨¡ | ç‰¹å¾ç»´åº¦ | æ¨¡å‹ | å…³é”®å˜é‡ | éªŒæ”¶æ ‡å‡† |
|-----|---------|---------|------|---------|---------|
| MVP-0 | å…¨é‡ | å…¨è°± | Ridge | $\alpha$ | è·å¾— baseline |
| MVP-1.0 | åˆ† 9 bin | å…¨è°± | 9Ã— Ridge | $(T_{\text{eff}}, [\text{M/H}])$ bin | Î”RÂ² â‰¥ 0.03 |
| MVP-1.1 | åˆ† 9 bin | å…¨è°± | 9Ã— Ridge | mask-aligned | CI éªŒè¯ |
| MVP-2.0 | æŒ‰ noise åˆ† | å…¨è°± | 5Ã— Ridge | noise level | ä¸“å®¶ vs æ··åˆ |
| MVP-3.0 | quantile bins | å…¨è°± | KÃ— Ridge | K=2~6 | æœ€ä½³ K |
| MVP-3.1 | quantile bins | å…¨è°± | KÃ— Ridge | pseudo vs oracle | â‰¥70% |
| MVP-3.2 | å…¨é‡ | $3\times$å…¨è°± | æ¡ä»¶ Ridge | $(x, m\cdot x, m^2\cdot x)$ | Î”RÂ² â‰¥ 0.04 |
| MVP-5.0 | å…¨é‡ | ç³»æ•°åˆ†æ | - | æ³¢æ®µå·®åˆ† | ç‰©ç†è§£é‡Š |
| MVP-7.1 | å…¨é‡ | å…¨è°± | Hard MoE vs Cond | gate noise $\sigma$ | Cond ä¿ä½ â‰¥60-80% |
| MVP-7.2 | å…¨é‡ | æ‰©å±•ç‰¹å¾ | Cond Ridge++ | Teff äº¤äº’é¡¹ | â‰¥90% MoE å¢ç›Š |
| MVP-7.3 | å…¨é‡ | å…¨è°± | SNR-cond Ridge | è¿ç»­ noise | æ¶ˆé™¤ noise=0.5 ç¿»è½¦ |
| **MVP-PG1** | å…¨é‡ | **11 ç»´ç‰©ç†çª—** | **LogReg (C=10)** | Ca II/Na/PCA1-2 | âœ… **Ï=1.00ï¼** |
| ~~MVP-PG2~~ | ~~å…¨é‡~~ | ~~çª—å£æ ‡é‡+PCA~~ | ~~LogReg/MLP~~ | ~~çª—å£å½¢çŠ¶ PCA~~ | âŒ ä¸éœ€è¦ |
| MVP-PG3 | å…¨é‡ | çª—å£åŸå§‹å€¼ | å° CNN gate | learned features | â³ å¯é€‰ |
| **MVP-9E1** | å…¨é‡ | **~15 ç»´ç‰©ç†çª—** | **LogReg 9-class** | Ca II/Na/PCA1-4 | **RÂ² â‰¥ 0.90, Ï â‰¥ 0.85** |
| **MVP-NN1** | å…¨é‡ | å…¨è°± | **3Ã— MLP expert** | å›ºå®š LogReg gate | **Î”RÂ² â‰¥ 0.02 vs global NN** |
| **MVP-Next-A** | å…¨é‡ | 13 ç»´ gate ç‰¹å¾ | **å° MLP/çº¿æ€§ gate** | å›å½’ MSE æŸå¤± | **RÂ² > 0.9213 + 0.003** |
| **MVP-Next-B** | full-1000 | 13 ç»´ gate ç‰¹å¾ | 9-expert + fallback | edge-clamp/extra expert | **full RÂ² > global + 0.05** |
| **MVP-Next-C** | å…¨é‡ | 9-expert è¾“å‡º | **affine æ ¡å‡†** | per-expert $a_k, b_k$ | **Bin3/Bin6 Î”RÂ² â‰¥ 0.02** |

| **MVP-12A** | 100k train / æ›´å¤§ test | å…¨è°± | **9Ã— Ridge + å›å½’ gate** | 100k è§„æ¨¡ | **covered RÂ² â‰¥ 0.93, CI_low > 0, MoE > LGBM** |
| **MVP-12B** | full coverage | å…¨è°± + window ç‰¹å¾ | **ç¬¬ 10 ä¸ª oor expert / cond fallback** | out-of-range ä¸“å®¶ | **full RÂ² â‰¥ max(LGBM, global+0.05)** |
| **MVP-13** | **32k train** | **æ–°å¢çª—å£ç‰¹å¾** | Ridge + æ–°ç‰¹å¾ | é€‰çº¿çª—å£ depth/EW/shape | **Bin3 æˆ– Bin6 Î”RÂ² â‰¥ +0.02** |
| **MVP-14** | **32k train** | **å€™é€‰çª—å£ + ä¸Šä¸‹æ–‡** | **å° CNN/AE ~1M å‚æ•°** | 8~32 ç»´ embedding | **RÂ² +0.003 æˆ– Bin3/Bin6 æ”¹å–„** |
| **MVP-15** | **32k train** | **é€‰çº¿çª—å£ç‰¹å¾** | **Bin3/Bin6 ç”¨ LGBM expert** | stacking-safe OOF | **full RÂ² > 0.91, Bin3/Bin6 ä¸æ‹–åè…¿** |
---

# 3. ğŸ”§ MVP è¯¦ç»†è®¾è®¡

> **å¯¼èˆªè¯´æ˜**ï¼š
> - ğŸ”´ **å½“å‰æ‰§è¡Œ**ï¼šPhase 12-13ï¼ˆå¤§è§„æ¨¡éªŒè¯ + ç‰¹å¾å¢å¼ºï¼‰
> - âœ… **å·²å®Œæˆ**ï¼šPhase 7(å–æ¶ˆ), 8, 9, 10, 11
> - â³ **è®¡åˆ’ä¸­**ï¼šPhase 4, 6

---

## ğŸ”´ å½“å‰æ‰§è¡Œï¼šPhase 12-13

<details>
<summary><b>âŒ Phase 7: è¿ç»­æ¡ä»¶åŒ–ï¼ˆå·²å–æ¶ˆ - ç‰©ç†çª— Gate å·²è§£å†³é—®é¢˜ï¼‰</b></summary>

## Phase 7: è¿ç»­æ¡ä»¶åŒ–ï¼ˆâŒ å·²å–æ¶ˆ - ç‰©ç†çª— Gate å·²è§£å†³é—®é¢˜ï¼‰

### MVP-7.1: Gate å™ªå£°æ•æ„Ÿæ€§æ›²çº¿ âŒ å·²å–æ¶ˆ

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | é‡åŒ– gate å™ªå£°å¯¹ Hard MoE vs Conditional Ridge çš„å½±å“å·®å¼‚ |
| **éªŒè¯å‡è®¾** | H-A1: è¿ç»­æ¡ä»¶æ¨¡å‹å¯¹ gate å™ªå£°æ›´è€å— |
| **æ–¹æ³•** | ç”¨çœŸå€¼ $m=[\text{M/H}]$ ä½œä¸ºæ¡ä»¶è¾“å…¥æ—¶çš„æ€§èƒ½ä½œä¸ºä¸Šé™ï¼›ç„¶åå¯¹ $m$ æ³¨å…¥é€çº§å™ªå£° $\tilde{m} = m + \epsilon,\ \epsilon \sim \mathcal{N}(0, \sigma^2)$ï¼Œ$\sigma \in \{0.0, 0.1, 0.2, 0.5, 1.0\}$ |
| **å¯¹æ¯”** | (1) Hard MoEï¼ˆæŒ‰ $\tilde{m}$ åˆ†æ¡¶ï¼‰vs (2) Conditional Ridgeï¼ˆç”¨ $\tilde{m}$ åšè¿ç»­æ¡ä»¶é¡¹ï¼‰ |
| **éªŒæ”¶æ ‡å‡†** | å¦‚æœ Conditional åœ¨è¾ƒå¤§ $\sigma$ ä¸‹ä»èƒ½ä¿ä½ â‰¥60-80% å¢ç›Šï¼Œè€Œ Hard MoE å¿«é€Ÿå´©ï¼š**ä¸»çº¿è½¬å‘æ¡ä»¶åŒ–ï¼Œæ”¾å¼ƒç¦»æ•£ routing** |
| **æ­¢æŸç‚¹** | å¦‚æœä¸¤è€…éƒ½å¿«é€Ÿå´© â†’ è¯´æ˜ gate æœ¬èº«å°±ä¸é è°±ï¼Œéœ€è¦ latent gate |

**â†’ å¯¹å‡è®¾çš„å½±å“**ï¼šè¿™ä¸€æ­¥ä¼šç›´æ¥è§£é‡Š pseudo gating 7.3% çš„æ ¹å› ï¼ˆhard routing å¤ªè„† or gate å¤ªå·®ï¼‰

**å®éªŒæ­¥éª¤**ï¼š
1. å‡†å¤‡ test set çš„çœŸå€¼ $m=[\text{M/H}]$
2. ç”Ÿæˆ 5 ä¸ªå™ªå£°æ°´å¹³çš„ $\tilde{m}$
3. å¯¹æ¯ä¸ªå™ªå£°æ°´å¹³ï¼š
   - Hard MoEï¼šç”¨ $\tilde{m}$ quantile åˆ†æ¡¶ï¼Œé€‰ä¸“å®¶
   - Conditional Ridgeï¼šç”¨ $\tilde{m}$ åšæ¡ä»¶é¡¹ $(x, \tilde{m}\cdot x)$
4. ç”»æ›²çº¿ï¼š$\sigma$ vs RÂ² for both methods
5. åˆ†æäº¤å‰ç‚¹å’Œå´©æºƒé€Ÿåº¦

---

### MVP-7.2: Conditional Ridge++ âŒ å·²å–æ¶ˆ

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | æŠŠ Conditional Ridge ä» 80% â†’ 90%+ MoE æ•ˆæœ |
| **éªŒè¯å‡è®¾** | å‰©ä½™å·®è·æ¥è‡ª Teff äº¤äº’é¡¹/äºŒé˜¶é¡¹/æ›´åˆç†çš„ç¼©æ”¾ |
| **æ–¹æ³•** | é€æ­¥åŠ ç‰¹å¾ï¼š<br>(1) åŠ  Teff ä¸€é˜¶äº¤äº’ï¼š$[x,\ m\cdot x,\ t\cdot x]$<br>(2) å†åŠ äº¤å‰é¡¹ï¼š$[x,\ m\cdot x,\ t\cdot x,\ (m\cdot t)\cdot x]$<br>(3) æœ€åè€ƒè™‘äºŒé˜¶ï¼ˆå¦‚æœ 1/2 ä¸å¤Ÿï¼‰ï¼š$[m^2\cdot x]$ |
| **éªŒæ”¶æ ‡å‡†** | è¾¾åˆ° MoE çš„ â‰¥90% å¢ç›Šï¼ˆå³ $\Delta R^2 \geq 0.045$ï¼‰ï¼Œå¹¶ä¿æŒ 100% coverage |
| **æ­¢æŸç‚¹** | å¦‚æœ Teff äº¤äº’é¡¹å¸¦æ¥ <0.01 æå‡ â†’ è¯´æ˜ Teff çœŸçš„ä¸é‡è¦ï¼Œåªåš [M/H] æ¡ä»¶åŒ– |

---

### MVP-7.3: Noise è¿ç»­æ¡ä»¶åŒ– âŒ å·²å–æ¶ˆ

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | ç”¨è¿ç»­ SNR/noise æ¡ä»¶åŒ–æ›¿ä»£ç¦»æ•£åˆ†æ¡£ä¸“å®¶ |
| **éªŒè¯å‡è®¾** | H-C: è¿ç»­æ¡ä»¶åŒ–èƒ½æ¥è¿‘ç”šè‡³è¶…è¿‡æŒ‰æ¡£ä¸“å®¶çš„å¹³å‡æ”¶ç›Šï¼Œå¹¶æ¶ˆé™¤ noise=0.5 å¼‚å¸¸ |
| **æ–¹æ³•** | æŠŠ noise level / SNR å½“è¿ç»­å˜é‡ $n$ï¼Œåšæ¡ä»¶çº¿æ€§ï¼š<br>(1) $[x,\ n\cdot x]$<br>(2) $[x,\ n\cdot x,\ n^2\cdot x]$ |
| **å¯¹æ¯”** | per-noise expertã€mixedã€continuous-conditioned |
| **éªŒæ”¶æ ‡å‡†** | å¹³å‡æ€§èƒ½æ¥è¿‘ expertï¼ˆå·® â‰¤0.01 RÂ²ï¼‰ï¼Œå¹¶ä¸”åœ¨ noise=0.5 ä¸Šä¸æ‰é˜Ÿ |
| **æ­¢æŸç‚¹** | å¦‚æœè¿ç»­åŒ–æ•ˆæœ < mixed â†’ è¯´æ˜ noise ç¡®å®éœ€è¦ç¦»æ•£åŒ–å¤„ç† |

---

### MVP-7.4: "ç‰©ç†çª—"è¯±å¯¼çš„è½»é‡é—¨æ§ â†’ å·²ç§»è‡³ Phase 8

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | ç”¨ç‰©ç†å…ˆéªŒè®¾è®¡è½»é‡ gateï¼ŒéªŒè¯ learned gate æ˜¯å¦æ¯” pseudo gate æ›´å¥½ |
| **éªŒè¯å‡è®¾** | H-B: å­˜åœ¨å¯å­¦ä¹ çš„ç‰©ç†è¾¹ç•Œ/soft gating |
| **æ–¹æ³•** | Gate è¾“å…¥åªç”¨å‡ ä¸ª"ç‰©ç†çª—"çš„ç»Ÿè®¡ç‰¹å¾ï¼š<br>- Ca II triplet window çš„ line depth/ç­‰æ•ˆå®½åº¦ proxy<br>- è‹¥å¹²çª—çš„ PCA åˆ†é‡ |
| **éªŒæ”¶æ ‡å‡†** | Learned gate â‰¥ pseudo gateï¼Œä¸”èƒ½æ˜æ˜¾è¶…è¿‡ conditional ridge++ |
| **æ­¢æŸç‚¹** | å¦‚æœ learned gate â‰ˆ conditional ridge++ â†’ ç›´æ¥ç”¨ conditionalï¼Œæ”¾å¼ƒ NN-MoE |

</details>

---

<details>
<summary><b>âœ… Phase 8: ç‰©ç†çª— Gateï¼ˆå·²å®Œæˆ - Ï=1.00 è¶…é¢„æœŸï¼ï¼‰</b></summary>

## âœ… Phase 8: ç‰©ç†çª— Gateï¼ˆå·²å®Œæˆï¼‰

> **æ ¸å¿ƒç›®æ ‡**ï¼šç”¨æœ€å°æˆæœ¬éªŒè¯"ç‰©ç†çª—ç‰¹å¾èƒ½å¦æŠŠ gate åšå¯¹ï¼ˆè‡³å°‘æ¯” pseudo å¥½ï¼‰"
> 
> **éªŒè¯æŒ‡æ ‡**ï¼š$\rho = \frac{R^2_{\text{phys-gate}} - R^2_{\text{global}}}{R^2_{\text{oracle}} - R^2_{\text{global}}}$
> - æœ€ä½å¯ç”¨ï¼š$\rho \ge 0.5$
> - å¾ˆæœ‰æˆï¼š$\rho \ge 0.7$
> 
> **âœ… å®é™…ç»“æœï¼šÏ=1.00ï¼Œè¿œè¶…é¢„æœŸï¼**

### MVP-PG1: ç‰©ç†çª— Gate Baseline âœ… å®Œæˆï¼

| é¡¹ç›® | é…ç½® | **å®é™…ç»“æœ** |
|------|------|------------|
| **ç›®æ ‡** | éªŒè¯ç‰©ç†çª—ç‰¹å¾ gate èƒ½å¦æ˜¾è‘—ä¼˜äº pseudo gating | âœ… **Ï=1.00 è¶…é¢„æœŸï¼** |
| **éªŒè¯å‡è®¾** | H-PG1: ç‰©ç†çª—ç‰¹å¾åŒºåˆ†ä¸“å®¶åŸŸ<br>H-PG2: Soft > Hard<br>H-PG3: Teff proxy å¿…è¦æ€§ | âœ… Acc=82%<br>âœ… Soft Ï=1.0 >> Hard Ï=0.72<br>âš ï¸ æœ‰å¸®åŠ©ä½†éå¿…éœ€ |
| **ä¸“å®¶è®¾ç½®** | å›ºå®š [M/H]-only 3 ä¸“å®¶ Ridge | Î±=1.0 per expert |
| **Gate ç‰¹å¾** | 11 ç»´ï¼šCa II depth/EWÃ—3 + EW_CaT + NaÃ—2 + PCA1/2 | EW_8542 æœ€é‡è¦ |
| **Gate æ¨¡å‹** | LogReg (L2, C=10) | å‡†ç¡®ç‡ 82.10% |
| **è·¯ç”±æ–¹å¼** | Hard / Soft / Soft+fallback | **Soft Ï=0.997 æ¨è** |
| **éªŒæ”¶æ ‡å‡†** | Ï mean â‰¥ 0.5 ä¸” CI_low > 0.3 | âœ… **Ï=1.00, CI=[0.73,1.44]** |
| **æ­¢æŸç‚¹** | Ï æ¥è¿‘ 0 â†’ è½¬ Conditional | âœ… **æ— éœ€è½¬å‘ï¼** |

**Gate ç‰¹å¾è®¾è®¡ï¼ˆæœ€å°é›†ï¼Œå…ˆåˆ«ä¸Š PCAï¼‰**ï¼š

| çª—å£ | ç‰¹å¾ | è¯´æ˜ |
|------|------|------|
| **Ca II triplet** | depth_8498, depth_8542, depth_8662 | å„æ¡çº¿çš„ depth proxy: $d = 1 - \min(f/\hat{c})$ |
| | EW_8498, EW_8542, EW_8662 | å„æ¡çº¿çš„ EW proxy: $\sum_{core}(1 - f/\hat{c})$ |
| | **EW_CaT** | æ€»å’Œç‰¹å¾: EW_8498 + EW_8542 + EW_8662 |
| **Na I** | depth_Na, EW_Na | 8183/8195 æˆ– 5890/5896ï¼ˆè§†æ³¢æ®µè¦†ç›–ï¼‰ |
| **Teff proxy** | **PCA1, PCA2** | å…¨è°± PCA å‰ 2 ç»´ï¼ˆæ— é¢å¤–ç›‘ç£ï¼Œæœ€çœäº‹ï¼‰|
| **å¯é€‰** | noise_proxy | å±€éƒ¨ MADï¼ˆæŠ—å™ªç‰¹å¾ï¼‰ |

**ä¸‰ç§è·¯ç”±æ–¹å¼å¯¹æ¯”**ï¼š

| æ–¹å¼ | å®ç° | é¢„æœŸç‰¹ç‚¹ |
|------|------|---------|
| **Hard** | argmax ç±»åˆ« â†’ é€‰ä¸“å®¶ | ç®€å•ä½†è„†å¼± |
| **Soft** | softmax æ¦‚ç‡æƒé‡æ··åˆ $\hat{y} = \sum_k p_k \hat{y}_k$ | æ›´ç¨³ã€æŠ—å™ª |
| **Soft + fallback** | max(p) < Ï„ (å¦‚ 0.5) æ—¶å›é€€ global Ridge | é¿å…"é”™è·¯ç”±ç¾éš¾" |

**å®éªŒæ­¥éª¤**ï¼š

1. **å‡†å¤‡ä¸“å®¶**ï¼šç”¨çœŸå€¼ [M/H] åœ¨ train ä¸Šè®­ç»ƒ 3 ä¸ª Ridge ä¸“å®¶ï¼ˆlow/mid/highï¼‰
2. **è®¡ç®— oracle æ€§èƒ½**ï¼štest æ—¶ç”¨çœŸå€¼ [M/H] è·¯ç”± â†’ $R^2_{\text{oracle}}$
3. **æå–ç‰©ç†çª—ç‰¹å¾**ï¼šå¯¹æ¯ä¸ªæ ·æœ¬æå– Ca II/Na/PCA ç‰¹å¾
4. **è®­ç»ƒ gate**ï¼šç”¨ç‰¹å¾é¢„æµ‹ expert idï¼ˆ3 åˆ†ç±» LogRegï¼‰
5. **æµ‹è¯•ä¸‰ç§è·¯ç”±**ï¼šHard / Soft / Soft+fallback
6. **è®¡ç®— Ï**ï¼šå¯¹æ¯ç§è·¯ç”±æ–¹å¼è®¡ç®— Ï å’Œ bootstrap CI

---

### MVP-PG2: çª—å£å½¢çŠ¶ PCA Gate

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | éªŒè¯"çª—å£å½¢çŠ¶ä¿¡æ¯"èƒ½å¦æŠŠ gate å†æ¨ä¸€æˆª |
| **å‰æ** | MVP-PG1 çš„ Ï æ¥è¿‘ä½†æœªè¾¾ 0.7 |
| **éªŒè¯å‡è®¾** | H-PG4: æ ‡é‡ç‰¹å¾ä¸å¤Ÿæ—¶ï¼Œçª—å£ PCA èƒ½æä¾›å¢é‡ |
| **æ–°å¢ç‰¹å¾** | å¯¹ Ca II çª—å£ï¼ˆæˆ– Na çª—å£ï¼‰æå– **PCA å‰ 2-5 ç»´** |
| **å¯¹æ¯”** | æ ‡é‡ç‰¹å¾ vs æ ‡é‡+çª—å£PCA çš„ Ï æå‡å¹…åº¦ |
| **éªŒæ”¶æ ‡å‡†** | Î”Ï > 0.1 |
| **æ­¢æŸç‚¹** | Î”Ï < 0.05 â†’ å½¢çŠ¶ä¿¡æ¯ä¸å€¼å¾—ï¼Œç”¨æ ‡é‡è¶³å¤Ÿ |

---

### MVP-PG3: å° CNN Gate

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | ç”¨å° CNN gate åƒçª—å£å½¢çŠ¶ï¼Œè¾“å‡º soft weights |
| **å‰æ** | MVP-PG1/PG2 å·²éªŒè¯ç‰©ç†çª—æ–¹å‘å¯è¡Œï¼ˆÏâ‰¥0.5ï¼‰ |
| **éªŒè¯å‡è®¾** | Learned gate èƒ½æ¥è¿‘ oracle |
| **æ¶æ„** | å° CNN (3-5 å±‚ Conv1D) åƒçª—å£åŒºåŸŸï¼Œè¾“å‡º 3-class softmax |
| **ä¸“å®¶** | ä»ç”¨ Ridgeï¼ˆæœ€å° learned gateï¼Œä¸åŠ¨ä¸“å®¶ï¼‰ |
| **éªŒæ”¶æ ‡å‡†** | Ï â‰¥ 0.8 |
| **æ„ä¹‰** | è¿™æ˜¯"æœ€å° learned gate"ï¼Œæ¯”å…¨è°± gate æ›´ç‰©ç†ã€æ›´å¯è§£é‡Šï¼Œå¯è¿æ¥ NN-MoE |

---

</details>

---

<details>
<summary><b>âœ… Phase 9: 9 ä¸“å®¶æ‰©å±•ï¼ˆå·²å®Œæˆ - RÂ²=0.9213, Ï=1.13 å¤§æˆåŠŸï¼ï¼‰</b></summary>

## âœ… Phase 9: 9 ä¸“å®¶æ‰©å±•ï¼ˆå·²å®Œæˆï¼‰

### MVP-9E1: ç‰©ç†çª— Soft Gate â†’ 9 ä¸“å®¶ âœ… å·²å®Œæˆ

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | æŠŠç‰©ç†çª— gate ä» 3 ä¸“å®¶æ‰©å±•åˆ° 9 ä¸“å®¶ (TeffÃ—[M/H])ï¼Œç›´æ¥æŠ¬å¯è½åœ° RÂ² åˆ° ~0.91 |
| **éªŒè¯å‡è®¾** | H-9E1: ç‰©ç†çª—ç‰¹å¾ï¼ˆCaT/Na + PCA ä½œä¸º Teff proxyï¼‰èƒ½åœ¨ 9 ç±»ä¸Šç”¨ Soft routing ä¿ä½å¤§éƒ¨åˆ† oracle å¢ç›Š |
| **ä¸“å®¶è®¾ç½®** | 9 ä¸ª Ridge ä¸“å®¶ï¼Œæ²¿ç”¨ `moe_piecewise_ridge.py` çš„ bin å®šä¹‰ |
| **Gate ç‰¹å¾** | ~15 ç»´ï¼šMVP-PG1 çš„ 11 ç»´ + PCA3/4ï¼ˆå¯èƒ½éœ€è¦æ›´å¤š Teff ä¿¡æ¯ï¼‰ |
| **Gate æ¨¡å‹** | LogReg 9-classï¼ˆå…ˆè¡Œï¼‰ï¼Œå¦‚ä¸å¤Ÿå†è¯• MLP |
| **è·¯ç”±æ–¹å¼** | **åªåš Soft routing + fallback**ï¼ˆHard å·²è¯æ˜æŸå¤± 28%ï¼Œä¸å€¼å¾—è¯•ï¼‰ |
| **éªŒæ”¶æ ‡å‡†** | **ç›®æ ‡ 1**: RÂ²_phys-gate(9) â‰¥ 0.90 / **ç›®æ ‡ 2**: Ï â‰¥ 0.85 / **ç›®æ ‡ 3**: 100% coverage (fallback) |
| **æ­¢æŸç‚¹** | å¦‚æœ 9-class gate å‡†ç¡®ç‡ <40% â†’ è€ƒè™‘ hierarchical gate (å…ˆ [M/H] å† Teff) |

**å¤ç”¨ä»£ç ç­–ç•¥**ï¼š
1. ä¸“å®¶è®­ç»ƒï¼š`scripts/moe_piecewise_ridge.py` çš„ bin å®šä¹‰å’Œä¸“å®¶è®­ç»ƒé€»è¾‘
2. ç‰¹å¾æå–ï¼š`scripts/moe_phys_gate_baseline.py` çš„ `extract_physical_features()` + PCA (noisy fit/transform)
3. è¯„ä¼°æ¡†æ¶ï¼šæ²¿ç”¨ Ï å®šä¹‰å’Œ bootstrap CI

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: å‡†å¤‡ 9 ä¸“å®¶
â”œâ”€â”€ ç”¨çœŸå€¼ (Teff, [M/H]) æŠŠ train åˆ†æˆ 9 ç»„
â”œâ”€â”€ æ¯ç»„è®­ç»ƒä¸€ä¸ª Ridge ä¸“å®¶
â””â”€â”€ è®°å½• Î±_optimal

Step 2: è®¡ç®— Oracle æ€§èƒ½
â”œâ”€â”€ Test æ—¶ç”¨çœŸå€¼ (Teff, [M/H]) è·¯ç”±åˆ°å¯¹åº”ä¸“å®¶
â””â”€â”€ å¾—åˆ° RÂ²_oracle(9) â‰ˆ 0.9116

Step 3: æ‰©å±•ç‰©ç†çª—ç‰¹å¾
â”œâ”€â”€ å¤ç”¨ MVP-PG1 çš„ 11 ç»´ç‰¹å¾
â”œâ”€â”€ å¯èƒ½åŠ  PCA3/4ï¼ˆæ›´å¤š Teff proxyï¼‰
â””â”€â”€ å¯èƒ½åŠ  H çº¿ç›¸å…³çª—ï¼ˆå¸®åŠ©åŒºåˆ† Teffï¼‰

Step 4: è®­ç»ƒ 9-class Gate
â”œâ”€â”€ LogReg 9-class (L2, C=CV)
â”œâ”€â”€ å¦‚æœå‡†ç¡®ç‡ <50%ï¼Œå°è¯•å° MLP
â””â”€â”€ è®°å½•åˆ†ç±»å‡†ç¡®ç‡å’Œæ··æ·†çŸ©é˜µ

Step 5: åªåš Soft routing
â”œâ”€â”€ soft = sum(p_k * y_hat_k)
â”œâ”€â”€ soft+fallback = max(p)<0.4 æ—¶ç”¨ global
â””â”€â”€ ä¸è¯• Hardï¼ˆå·²è¯æ˜æŸå¤±å¤§ï¼‰

Step 6: è®¡ç®— Ï å’Œ CI
â”œâ”€â”€ Ï = (RÂ²_phys-gate(9) - RÂ²_global) / (RÂ²_oracle(9) - RÂ²_global)
â””â”€â”€ Bootstrap CI
```

---

</details>

---

<details>
<summary><b>âš ï¸ Phase 10: NN Expertï¼ˆå·²å®Œæˆ - NN<<Ridgeï¼Œæš‚åœï¼‰</b></summary>

## âš ï¸ Phase 10: NN Expertï¼ˆå·²å®Œæˆ - ç»“è®ºï¼šå…¨è°± MLP ä¸é€‚åˆï¼‰

### MVP-NN1: å›ºå®šç‰©ç† gate + NN experts âš ï¸ å·²å®Œæˆ

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | Gate å·²ä¸æ˜¯ç“¶é¢ˆï¼ŒéªŒè¯æŠŠ Ridge expert æ¢æˆ NN expert èƒ½å¦å†æ¶¨ |
| **éªŒè¯å‡è®¾** | H-NN1: MoE çš„ RÂ² ä¸Šé™è¢« expert è¡¨è¾¾èƒ½åŠ›é™åˆ¶ï¼›NN expert èƒ½æ”¹å–„å›°éš¾å­åŸŸ |
| **Gate è®¾ç½®** | **å›ºå®š MVP-PG1 çš„ LogReg gate**ï¼ˆä¸ end2endï¼‰ï¼Œä¿è¯å› æœæ¸…æ™°â€”â€”æ¶¨äº†å°±æ˜¯ expert å˜å¼º |
| **ä¸“å®¶è®¾ç½®** | å…ˆ K=3 [M/H] ä¸“å®¶ï¼ˆå› ä¸º [M/H] æ˜¯ä¸»è´¡çŒ®ç»´åº¦ï¼Œæœ€ç¨³é…ç½®ï¼‰ |
| **Expert æ¨¡å‹** | å° MLP (2-3 å±‚, 128-256 hidden, ReLU, Dropout=0.2) |
| **å¯¹ç…§ç»„** | global NN baseline vs "3-expert NN + soft gate"ï¼›å‚æ•°é‡/è®­ç»ƒé¢„ç®—å¯¹é½ |
| **éªŒæ”¶æ ‡å‡†** | Î”RÂ² â‰¥ 0.02 ç›¸å¯¹ global NNï¼›å›°éš¾å­åŸŸ (Bin4/Bin7) è¯¯å·®æ˜æ˜¾ä¸‹é™ |
| **æ­¢æŸç‚¹** | å¦‚æœ Î”RÂ² < 0.01 â†’ expert å˜å¼ºä¸æ˜¯ä¸»è¦å¢ç›Šæ¥æºï¼Œéœ€è¦æ›´å¼º gate/æ›´å¤šä¸“å®¶ |

**å…³é”®è®¾è®¡åŸåˆ™**ï¼š
1. **Gate å›ºå®š**ï¼šç”¨ MVP-PG1 è®­å¥½çš„ LogRegï¼Œä¸å‚ä¸ NN è®­ç»ƒ
2. **å¯¹ç…§å…¬å¹³**ï¼šglobal NN å’Œ expert NN å‚æ•°é‡/è®­ç»ƒ epoch å°½é‡å¯¹é½
3. **å®šä½å¢ç›Š**ï¼šæŒ‰å­åŸŸçœ‹è¯¯å·®ï¼Œé‡ç‚¹ç›¯ Bin4/Bin7

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: å‡†å¤‡æ•°æ®
â”œâ”€â”€ å¤ç”¨ MVP-PG1 çš„æ•°æ®å’Œ [M/H] åˆ†ç»„
â””â”€â”€ train/test split ä¿æŒä¸€è‡´

Step 2: è®­ç»ƒ Global NN Baseline
â”œâ”€â”€ å° MLP (2 å±‚, 256 hidden)
â”œâ”€â”€ è®°å½• RÂ²_global_nn
â””â”€â”€ è®°å½•å„å­åŸŸæ€§èƒ½ï¼ˆç‰¹åˆ«æ˜¯ Bin4/Bin7ï¼‰

Step 3: è®­ç»ƒ 3Ã— NN Expert
â”œâ”€â”€ æ¯ä¸ª expert ç›¸åŒæ¶æ„ (2 å±‚, 256 hidden)
â”œâ”€â”€ ç”¨çœŸå€¼ [M/H] åˆ†ç»„è®­ç»ƒ
â””â”€â”€ å‚æ•°é‡ â‰ˆ global NN

Step 4: ç”¨å›ºå®š gate + soft routing æµ‹è¯•
â”œâ”€â”€ å¤ç”¨ MVP-PG1 çš„ LogReg gate
â”œâ”€â”€ åªç”¨ Soft routing
â””â”€â”€ å¾—åˆ° RÂ²_moe_nn

Step 5: åˆ†æå¢ç›Šæ¥æº
â”œâ”€â”€ æ€»ä½“ Î”RÂ² = RÂ²_moe_nn - RÂ²_global_nn
â”œâ”€â”€ æŒ‰å­åŸŸçœ‹ï¼šå“ªäº› bin æ”¹å–„æœ€å¤šï¼Ÿ
â””â”€â”€ ç‰¹åˆ«å…³æ³¨ Bin4/Bin7ï¼ˆå›°éš¾å­åŸŸï¼‰
```

**åç»­å¯é€‰æ‰©å±•**ï¼š
- å¦‚æœ K=3 æœ‰æ•ˆ â†’ æ‰©å±•åˆ° K=9
- å¦‚æœå›°éš¾å­åŸŸæ”¹å–„æ˜æ˜¾ â†’ ç»™ Bin4/Bin7 ä¸“å®¶åŠ  H çº¿ç›¸å…³çª—ç‰¹å¾

---

</details>

---

<details>
<summary><b>âœ… Phase 11: ä¼˜åŒ– & å·¥ç¨‹åŒ–ï¼ˆM2 é‡Œç¨‹ç¢‘è¾¾æˆï¼ï¼‰</b></summary>

## âœ… Phase 11: ä¼˜åŒ– & å·¥ç¨‹åŒ–ï¼ˆM2 é‡Œç¨‹ç¢‘è¾¾æˆï¼‰

> **æ ¸å¿ƒç›®æ ‡**ï¼šå°† 9 ä¸“å®¶ç‰©ç† MoE å‡çº§ä¸º"å›å½’æœ€ä¼˜ soft mixing + 100% coverage"ï¼Œç›®æ ‡æ˜¯åœ¨ full-test ä¸Šç¨³å®šè¶…è¿‡å½“å‰åˆ†ç±» gate çš„ RÂ²ã€‚
> 
> **é‡Œç¨‹ç¢‘ M2**ï¼šâœ… å·²è¾¾æˆï¼å›å½’ gate RÂ²=0.9310 + full coverage RÂ²=0.8957

### MVP-Next-A: å›å½’æœ€ä¼˜ Soft Mixing âœ… å·²å®Œæˆ (RÂ²=0.9310)

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | æŠŠ gate ä»"åˆ†ç±»æœ€ä¼˜"å‡çº§ä¸º"å›å½’æœ€ä¼˜"çš„ soft mixing |
| **éªŒè¯å‡è®¾** | H-A: å½“å‰ç”¨ LogReg åš 9-class åˆ†ç±»å¾—åˆ°çš„æ¦‚ç‡ $p_k$ ä¸æ˜¯è®© log g MSE æœ€å°çš„æƒé‡ï¼›å¦‚æœç›´æ¥ç”¨éªŒè¯é›†æœ€å°åŒ– log g è¯¯å·®æ¥å­¦ä¹ æƒé‡æ˜ å°„ï¼ŒRÂ² è¿˜èƒ½æ¶¨ä¸€æˆªï¼ˆå°¤å…¶åœ¨ bin è¾¹ç•Œä¸ metal-poor binsï¼‰ |
| **ä¸“å®¶è®¾ç½®** | **å†»ç»“ 9 ä¸ª ridge experts**ï¼ˆå®Œå…¨å¤ç”¨ MVP-9E1 çš„ä¸“å®¶ï¼‰ |
| **Gate è®¾ç½®** | ä¸å†ç”¨ class CE lossï¼Œè€Œæ˜¯å­¦ä¸€ä¸ªå° gateï¼šè¾“å…¥ 13D gate features â†’ è¾“å‡º 9 ä¸ªæƒé‡ï¼ˆsoftmaxï¼‰â†’ æŸå¤±ï¼š**validation MSEï¼ˆå›å½’ï¼‰** |
| **å¯¹ç…§ç»„** | (1) ç°æœ‰åˆ†ç±» LogReg + soft routingï¼ˆbaseline = 0.9213ï¼‰; (2) å›å½’è®­ç»ƒçš„ soft weightsï¼ˆæ–°ï¼‰ |
| **éªŒæ”¶æ ‡å‡†** | æ•´ä½“ RÂ² æ˜æ˜¾é«˜äº 0.9213ï¼ˆå“ªæ€• +0.003~0.01 éƒ½æ˜¯å¾ˆçœŸå®çš„æå‡ï¼‰ï¼›é‡ç‚¹çœ‹ Bin3/Bin6 |
| **æ­¢æŸç‚¹** | å¦‚æœ Î”RÂ² < 0.001 â†’ è¯´æ˜åˆ†ç±»æƒé‡å·²ç»æ¥è¿‘æœ€ä¼˜ |

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: å‡†å¤‡
â”œâ”€â”€ å¤ç”¨ MVP-9E1 çš„ 9 ä¸ª Ridge expertï¼ˆå®Œå…¨å†»ç»“ï¼‰
â”œâ”€â”€ å¤ç”¨ 13 ç»´ gate ç‰¹å¾
â””â”€â”€ åˆ†å‡º held-out validation set (ç”¨äºè®­ç»ƒ gate)

Step 2: è®­ç»ƒå›å½’ Gate
â”œâ”€â”€ æ–¹æ³• A: å° MLP (13 â†’ 64 â†’ 9) + softmax + MSE loss
â”œâ”€â”€ æ–¹æ³• B: çº¿æ€§å±‚ (13 â†’ 9) + softmax + MSE loss
â”œâ”€â”€ åœ¨ validation set ä¸Šæœ€å°åŒ– MSE
â””â”€â”€ ç”¨ test set è¯„ä¼°

Step 3: å¯¹æ¯”
â”œâ”€â”€ åˆ†ç±» gate (LogReg): RÂ²_classify
â”œâ”€â”€ å›å½’ gate (å° MLP/çº¿æ€§): RÂ²_regress
â””â”€â”€ é‡ç‚¹çœ‹ per-bin æ”¹å–„ï¼Œå°¤å…¶ Bin3/Bin6

Step 4: ç»Ÿè®¡éªŒè¯
â”œâ”€â”€ Bootstrap CI éªŒè¯ Î”RÂ² çš„æ˜¾è‘—æ€§
â””â”€â”€ å¦‚æœ Î”RÂ² > 0.003 ä¸” CI_low > 0 â†’ é‡‡ç”¨å›å½’ gate
```

**å¥½å¤„**ï¼šä¸éœ€è¦ NN expertsï¼Œä¹Ÿä¸éœ€è¦æ¢ç‰¹å¾ï¼›çº¯ç²¹æŠŠ"æƒé‡å­¦ä¹ ç›®æ ‡"ä»åˆ†ç±»æ”¹æˆå›å½’ï¼Œä¿¡æ¯å¢é‡æœ€å¤§ã€‚

---

### MVP-Next-B: 100% Coverage âœ… å®Œæˆ

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | åš"100% coverage çš„æœ€ç»ˆæŒ‡æ ‡"ï¼Œç¡®ä¿å¢ç›Šä¸ä¾èµ–äºç­›æ ·æœ¬ |
| **éªŒè¯å‡è®¾** | H-B: æŠŠ out-of-range æ ·æœ¬çº³å…¥ç»Ÿä¸€æµç¨‹åï¼Œæ•´ä½“ RÂ² ä»ç»´æŒåœ¨ä¸€ä¸ª"å®é™…å¯ç”¨"çš„é«˜æ°´å¹³ |
| **èƒŒæ™¯** | MVP-9E1 test 1000 é‡Œ 816 coveredï¼ˆæ•™æˆä¸€å®šä¼šé—®ï¼ï¼‰ |
| **ç­–ç•¥é€‰é¡¹** | (1) **Edge-clamp**: è½åˆ°æœ€è¿‘çš„ Teff/[M/H] bin; (2) **Extra "other" expert**: ç¬¬ 10 ä¸ªä¸“å®¶è®­ç»ƒ out-of-range train; (3) **Global fallback**: æœ€ç¨³ä½†é€šå¸¸ä¼šç¨é™ |
| **æ±‡æŠ¥æ–¹å¼** | ä¸¤å¥—ï¼šcovered-onlyï¼ˆä¾¿äºå¯¹æ¯”å†å²ï¼‰+ full-1000ï¼ˆå¯å±•ç¤º/å¯äº¤ä»˜ç‰ˆæœ¬ï¼‰ |
| **éªŒæ”¶æ ‡å‡†** | full-1000 çš„ RÂ² ä»æ˜¾è‘—é«˜äº globalï¼Œå¹¶ä¸”"å·®è·åŸå› å¯è§£é‡Š" |
| **æ­¢æŸç‚¹** | å¦‚æœ full-1000 RÂ² < global RÂ² + 0.03 â†’ éœ€è¦åˆ†æ out-of-range æ ·æœ¬ç‰¹æ€§ |

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: åˆ†æ out-of-range æ ·æœ¬
â”œâ”€â”€ è¯†åˆ« 184 ä¸ª out-of-range æ ·æœ¬
â”œâ”€â”€ åˆ†æå…¶ (Teff, [M/H]) åˆ†å¸ƒ
â””â”€â”€ ç†è§£ä¸ºä»€ä¹ˆè½åœ¨ 9 bin ä¹‹å¤–

Step 2: å®ç°ä¸‰ç§ç­–ç•¥
â”œâ”€â”€ (A) Edge-clamp: æ˜ å°„åˆ°æœ€è¿‘çš„è¾¹ç•Œ bin
â”œâ”€â”€ (B) Extra expert: è®­ç»ƒç¬¬ 10 ä¸ªä¸“å®¶
â””â”€â”€ (C) Global fallback: ç›´æ¥ç”¨å…¨å±€ Ridge

Step 3: è¯„ä¼°
â”œâ”€â”€ covered-only (816): RÂ²_covered
â”œâ”€â”€ out-of-range (184): RÂ²_oor
â”œâ”€â”€ full-1000: RÂ²_full = weighted average
â””â”€â”€ å¯¹æ¯”ä¸‰ç§ç­–ç•¥çš„ RÂ²_full

Step 4: é€‰æ‹©æœ€ä¼˜ç­–ç•¥
â”œâ”€â”€ å¦‚æœ edge-clamp æ•ˆæœå¥½ â†’ æœ€ç®€å•
â”œâ”€â”€ å¦‚æœ extra expert æ›´å¥½ â†’ æ›´ç²¾ç¡®
â””â”€â”€ è¾“å‡ºå¯äº¤ä»˜ç‰ˆæœ¬çš„æœ€ç»ˆæŒ‡æ ‡
```

---

### MVP-Next-C: Expert æ ¡å‡† ğŸ”´ å†² RÂ² ä¸»æˆ˜åœº

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | ä¸“æ‰“æœ€å¼± bins çš„"åå·®é¡¹/æ ¡å‡†"ï¼Œæå‡æ€»ä½“ RÂ² |
| **éªŒè¯å‡è®¾** | H-C: æœ€å¼± bins (Bin3/Bin6) çš„è¯¯å·®ä¸»è¦æ˜¯"ç³»ç»Ÿæ€§ bias/å°ºåº¦ä¸åŒ¹é…"ï¼Œå…ˆåšè½»é‡æ ¡å‡†å°±èƒ½æå‡ |
| **èƒŒæ™¯** | Bin3 (Mid Metal-poor) å’Œ Bin6 (Hot Metal-poor) è™½ç„¶ soft å·²ç»æ•‘äº†å¾ˆå¤šï¼Œä½† RÂ² ä»æ˜æ˜¾ä½äºå…¶ä»– bin |
| **æ–¹æ³•** | åœ¨éªŒè¯é›†ä¸Šå¯¹æ¯ä¸ª expert è¾“å‡ºåš **affine æ ¡å‡†**: $\hat{y}'_k = a_k \hat{y}_k + b_k$ï¼Œç„¶åå†åš soft mixing: $\hat{y} = \sum_k p_k \hat{y}'_k$ |
| **å¯¹ç…§** | æ— æ ¡å‡† vs æ ¡å‡† |
| **éªŒæ”¶æ ‡å‡†** | Bin3/Bin6 çš„ RÂ² æœ‰æ˜ç¡®æå‡ï¼ŒåŒæ—¶æ•´ä½“ RÂ² å¢åŠ  |
| **æ­¢æŸç‚¹** | å¦‚æœæ ¡å‡†å Î”RÂ² < 0.005 â†’ è¯´æ˜åå·®ä¸æ˜¯ä¸»å› ï¼Œéœ€è¦çœ‹ç‰¹å¾ |

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: åˆ†æ per-expert åå·®
â”œâ”€â”€ å¯¹æ¯ä¸ª expert kï¼Œåœ¨ validation ä¸Šç”» pred vs true
â”œâ”€â”€ æ£€æŸ¥æ˜¯å¦æœ‰ç³»ç»Ÿæ€§ bias (æˆªè·åç§») æˆ– scale mismatch (æ–œç‡ â‰  1)
â””â”€â”€ é‡ç‚¹çœ‹ Bin3 å’Œ Bin6

Step 2: å­¦ä¹ æ ¡å‡†å‚æ•°
â”œâ”€â”€ å¯¹æ¯ä¸ª expert kï¼Œç”¨ validation æ‹Ÿåˆ a_k, b_k
â”œâ”€â”€ æ–¹æ³•: ç®€å•çº¿æ€§å›å½’ y ~ a_k * y_hat_k + b_k
â””â”€â”€ å…± 9Ã—2=18 ä¸ªå‚æ•°

Step 3: åº”ç”¨æ ¡å‡†
â”œâ”€â”€ å¯¹æ¯ä¸ª expert è¾“å‡ºåš affine å˜æ¢
â”œâ”€â”€ ç„¶åç”¨ soft gate æƒé‡æ··åˆ
â””â”€â”€ åœ¨ test ä¸Šè¯„ä¼°

Step 4: åˆ†æå¢ç›Šæ¥æº
â”œâ”€â”€ æ•´ä½“ Î”RÂ² = RÂ²_calibrated - RÂ²_uncalibrated
â”œâ”€â”€ Per-bin Î”RÂ²ï¼Œé‡ç‚¹çœ‹ Bin3/Bin6
â””â”€â”€ å¦‚æœæœ‰æ•ˆ â†’ çº³å…¥æœ€ç»ˆæµç¨‹
```

**ä¿æŒå¯è§£é‡Šæ€§**ï¼šè¿™ä¸ªæ–¹æ³•æ˜¯çº¿æ€§ã€é€æ˜çš„ï¼Œæ¯ä¸ªä¸“å®¶çš„æ ¡å‡†å‚æ•° $(a_k, b_k)$ éƒ½æœ‰æ˜ç¡®çš„ç‰©ç†è§£é‡Šã€‚

</details>

## ğŸ”´ å½“å‰æ‰§è¡Œï¼šPhase 12-13
</details>

---

## ğŸ”´ å½“å‰æ‰§è¡Œï¼šPhase 12-13

---

## ğŸ”´ Phase 12: å¤§è§„æ¨¡éªŒè¯ï¼ˆ2025-12-05 æ–°ç«‹é¡¹ï¼‰

> **æ ¸å¿ƒç›®æ ‡**ï¼šæŠŠ 0.9310 ä» 32k/816 test å‡çº§ä¸º 100k è§„æ¨¡çš„"ç¨³æ€ç»“è®º"ï¼Œå¹¶æŠŠ full coverage æ‹‰å› >0.91
>
> **æ€»ç­–ç•¥**ï¼šå…ˆå·©å›ºç¨³æ€ï¼Œå†è¶…è¶Š LGBM=0.91

### MVP-12A: 100k è§„æ¨¡å¤åˆ» Next-A ğŸ”´ P0 æœ€é«˜ä¼˜å…ˆçº§

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | æŠŠ 0.9310 ä»"32k/816 test"å‡çº§æˆ"100k/æ›´å¤§ test çš„ç¨³å®šç»“è®º"ï¼Œå¹¶ç»™å‡ºæ›´ç¡¬çš„ CI |
| **éªŒè¯å‡è®¾** | H-12A: 100k è§„æ¨¡ä¸‹ MoE RÂ²â‰¥0.93 å¯å¤ç°ï¼ŒCI_low>0ï¼Œä¸”æ˜æ˜¾ä¼˜äº LGBM=0.91 |
| **ä¸“å®¶è®¾ç½®** | ä»ç„¶ 9Ã—Ridgeï¼ˆå’Œç°åœ¨ä¸€è‡´ï¼‰ï¼Œä½†ç”¨ 100k train é‡æ–°è®­ç»ƒ |
| **Gate è®¾ç½®** | ä»ç„¶å›å½’ gate(MLP) soft mixingï¼ˆNext-A é…ç½®ï¼‰ |
| **Baseline å¯¹ç…§** | åŒä¸€ split ä¸‹åŒæ—¶è·‘ **LGBM baseline**ï¼Œç¡®ä¿å…¬å¹³ |
| **éªŒæ”¶æ ‡å‡†** | covered-test RÂ² â‰¥ 0.93ï¼ˆæˆ–æ›´ç¨³çš„ CI_low > 0ï¼‰ï¼›åŒ split ä¸‹ MoE æ˜æ˜¾é«˜äº LGBM 0.91 |
| **æ­¢æŸç‚¹** | å¦‚æœ RÂ² ä¸‹é™æˆ– CI åŒ…å« 0 â†’ éœ€è¦åˆ†ææ˜¯å¦ 100k å¸¦æ¥æ›´å¤šéš¾æ ·æœ¬ |

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: å‡†å¤‡ 100k æ•°æ®
â”œâ”€â”€ é‡æ–° split train/val/test
â”œâ”€â”€ ç¡®ä¿ test æ›´å¤§ã€åˆ†å¸ƒæ›´æ¥è¿‘çœŸå®
â””â”€â”€ è®°å½•å„ bin æ ·æœ¬æ•°

Step 2: è®­ç»ƒ 9 ä¸“å®¶
â”œâ”€â”€ ç”¨çœŸå€¼ (Teff, [M/H]) åˆ†ç»„
â”œâ”€â”€ æ¯ç»„ç”¨ 100k å­é›†è®­ç»ƒ Ridge
â””â”€â”€ è®°å½• Î±_optimal

Step 3: è®­ç»ƒå›å½’ Gate
â”œâ”€â”€ å¤ç”¨ Next-A çš„ MLP gate é…ç½®
â”œâ”€â”€ åœ¨ val ä¸Šæœ€å°åŒ– MSE
â””â”€â”€ è¾“å‡º RÂ²_moe

Step 4: LGBM Baseline å¯¹ç…§
â”œâ”€â”€ åŒ split è®­ç»ƒ LGBM
â”œâ”€â”€ ä½¿ç”¨ç›¸åŒç‰¹å¾
â””â”€â”€ è¾“å‡º RÂ²_lgbm

Step 5: ç»Ÿè®¡éªŒè¯
â”œâ”€â”€ Bootstrap CI for RÂ²_moe
â”œâ”€â”€ å…¬å¹³å¯¹æ¯” RÂ²_moe vs RÂ²_lgbm
â””â”€â”€ ç¡®è®¤ MoE > LGBM çš„æ˜¾è‘—æ€§
```

---

### MVP-12B: Coverage++ ğŸ”´ P0

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | è®© full-test RÂ² æ¥è¿‘ covered-testï¼Œä½¿ MoE å¯äº¤ä»˜ |
| **éªŒè¯å‡è®¾** | H-12B: ç¬¬ 10 ä¸ª out-of-range expert èƒ½æŠŠ full-test RÂ² æ‹‰å› >0.91 |
| **èƒŒæ™¯** | å½“å‰æœ€å¤§çŸ­æ¿ä¸æ˜¯ 0.93ï¼Œè€Œæ˜¯ full coverage ç‰ˆæœ¬æ‹‰èƒ¯ï¼ˆä¼šç›´æ¥è¾“ç»™ LGBMï¼‰ |
| **ç­–ç•¥ 1** | **ç¬¬ 10 ä¸ª "out-of-range expert"**ï¼šä¸“é—¨ç”¨ out-of-range çš„ train æ ·æœ¬è®­ç»ƒ |
| **ç­–ç•¥ 2** | fallback ä¸æ˜¯ global ridgeï¼Œè€Œæ˜¯ **conditional ridge / æˆ–è€… lightgbm-lite** |
| **è¾“å‡ºæŒ‡æ ‡** | åŒæ—¶è¾“å‡º covered & full ä¸¤å¥—æŒ‡æ ‡ï¼Œä¿ç•™å¯æ¯”æ€§ |
| **éªŒæ”¶æ ‡å‡†** | full-test RÂ² â‰¥ max(LGBM, global+0.05)ï¼›è‡³å°‘è¦æŠŠ full æ‹‰å›åˆ° >0.91 |
| **æ­¢æŸç‚¹** | å¦‚æœ full RÂ² < 0.88 â†’ åˆ†æ out-of-range æ ·æœ¬ç‰¹æ€§ |

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: åˆ†æ out-of-range æ ·æœ¬
â”œâ”€â”€ è¯†åˆ«è½åœ¨ 9 bin ä¹‹å¤–çš„æ ·æœ¬
â”œâ”€â”€ åˆ†æå…¶ (Teff, [M/H]) åˆ†å¸ƒ
â””â”€â”€ ç†è§£ä¸ºä»€ä¹ˆè½åœ¨ 9 bin ä¹‹å¤–

Step 2: è®­ç»ƒç¬¬ 10 ä¸ªä¸“å®¶
â”œâ”€â”€ åªç”¨ out-of-range train æ ·æœ¬
â”œâ”€â”€ ä½¿ç”¨ Ridge æˆ– LGBM-lite
â””â”€â”€ è®°å½•è¯¥ä¸“å®¶çš„å•ç‹¬æ€§èƒ½

Step 3: æ‰©å±• Gate
â”œâ”€â”€ æ–¹æ¡ˆ A: 10-class gate
â”œâ”€â”€ æ–¹æ¡ˆ B: 9-class + "å…¶ä»–"æ£€æµ‹å™¨
â””â”€â”€ æ–¹æ¡ˆ C: æ¦‚ç‡ä½äºé˜ˆå€¼æ—¶ fallback

Step 4: è¯„ä¼°
â”œâ”€â”€ covered-only (åŸ 816)
â”œâ”€â”€ out-of-range only
â”œâ”€â”€ full coverage (1000)
â””â”€â”€ å¯¹æ¯”ä¸‰ç§ç­–ç•¥
```

---

## ğŸŸ¡ Phase 13: ç‰¹å¾å¢å¼º & å°æ¨¡å‹ï¼ˆP1 å¾…éªŒè¯ï¼‰

> **æ ¸å¿ƒç›®æ ‡**ï¼šæ‰€æœ‰åˆ›æ–°éƒ½åªå…è®¸é’ˆå¯¹ Bin3/Bin6 åšå¢é‡
>
> **å‰æ**ï¼šH-C æ ¡å‡†å¤±è´¥è¡¨æ˜ Metal-poor è¯¯å·®ä¸æ˜¯ç®€å• biasï¼Œéœ€è¦ç‰¹å¾/å®¹é‡/åˆ†å¸ƒå±‚é¢æ”¹è¿›
>
> **âš ï¸ æ•°æ®è§„æ¨¡**ï¼šMVP-13/14/15 **åœ¨ 32k ä¸Šæ“ä½œ**ï¼ˆå¿«é€ŸéªŒè¯ç‰¹å¾/æ–¹æ³•æœ‰æ•ˆæ€§åå†ä¸Š 100kï¼‰

### MVP-13: Feature Mining Bin3/Bin6 ğŸŸ¡ P1

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | åªæ”¹å–„ Bin3/Bin6ï¼ˆMetal-poor binsï¼‰ |
| **éªŒè¯å‡è®¾** | H-13: ç”¨ ridge ç³»æ•°/æ®‹å·®é€‰çº¿æ·»åŠ çª—å£ç‰¹å¾èƒ½æ”¹å–„ Bin3/Bin6 |
| **èƒŒæ™¯** | H-C æ ¡å‡†å¤±è´¥è¯´æ˜ Metal-poor è¯¯å·®ä¸æ˜¯ç®€å• biasï¼Œæ˜¯"ç¼ºä¿¡æ¯/å¼‚è´¨æ€§" |
| **æ–¹æ³•** | ç”¨ ridge expert ç³»æ•°/æ®‹å·®åš"é€‰çº¿"ï¼šæ‰¾å¯¹ log g æˆ– [M/H]/Teff æœ€æ•æ„Ÿçš„å±€éƒ¨çª— |
| **æ–°å¢ç‰¹å¾** | æŠŠè¿™äº›çª—çš„ depth/EW/shape ç‰¹å¾å†™è¿› gate features æˆ– Bin3/Bin6 ä¸“ç”¨ expert features |
| **æ³¨æ„** | æ¯æ¬¡åªåŠ ä¸€ç±»çª—å£ï¼ˆæ¯”å¦‚æ–°å¢ 1 ç»„çº¿ï¼‰ï¼Œåš ablationï¼Œé¿å…"å †ä¸€å †ä¸çŸ¥é“è°æœ‰ç”¨" |
| **éªŒæ”¶æ ‡å‡†** | Bin3 æˆ– Bin6 è‡³å°‘ä¸€ä¸ª **Î”RÂ² â‰¥ +0.02**ï¼Œå¦åˆ™ç«‹åˆ»æ­¢æŸ |
| **æ­¢æŸç‚¹** | å¦‚æœ Î”RÂ² < 0.01 â†’ åœæ­¢è¯¥æ–¹å‘ï¼Œè½¬ MVP-15 |

**å€™é€‰çª—å£**ï¼š
- Ca II ä»¥å¤–çš„é‡‘å±çº¿ï¼ˆNa, Mg, Fe...ï¼‰
- H çº¿ (HÎ±/HÎ²) â€” å¯èƒ½å¸®åŠ©åŒºåˆ† Teff
- å¼±é‡‘å±çº¿ç‰¹å¾ï¼ˆåœ¨ Metal-poor åŒºåŸŸå¯èƒ½æ›´æ•æ„Ÿï¼‰

---

### MVP-14: 1M å‚æ•° Embedding for Gate ğŸŸ¡ P1

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | å­¦ä¸€ä¸ªæ›´å¼ºçš„ä½ç»´è¡¨å¾ï¼ˆembeddingï¼‰å½“ gate çš„ Teff/[M/H] proxy |
| **éªŒè¯å‡è®¾** | H-14: å°æ¨¡å‹ (1M å‚æ•°) å­¦ä¹ çš„ embedding èƒ½æ”¹å–„ gate è´¨é‡ |
| **å®šä½** | **ä¸æ˜¯æ›¿ä»£ä¸“å®¶**ï¼Œåªæ˜¯ç»™ gate æä¾›æ›´å¥½çš„è¾“å…¥ï¼ˆä¸“å®¶æ¢ NN å·²è¸©è¿‡å‘ï¼‰ |
| **æ¶æ„** | å°çš„ 1D-CNN/autoencoder/supervised proxyï¼ˆå‚æ•°é‡ ~1Mï¼‰ |
| **è¾“å…¥** | åªç”¨"å€™é€‰çª—å£ + å°‘é‡ä¸Šä¸‹æ–‡"ï¼ˆä¸éœ€è¦å…¨è°±ï¼‰ |
| **è¾“å‡º** | 8~32 ç»´ embeddingï¼Œæ‹¼åˆ°ç°æœ‰ 13D gate features é‡Œ |
| **Gate** | ä»ç„¶ç”¨å›å½’ gate(MLP) å­¦ soft weightsï¼ˆNext-A ä¸»çº¿ä¸å˜ï¼‰ |
| **éªŒæ”¶æ ‡å‡†** | æ€»ä½“ RÂ² +0.003 ä»¥ä¸Š æˆ– Bin3/Bin6 æ˜æ˜¾æ”¹å–„ |
| **æ­¢æŸç‚¹** | å¦‚æœ Î”RÂ² < 0.001 â†’ embedding ä¸å€¼å¾—ï¼Œç»´æŒç°æœ‰ gate features |

---

### MVP-15: Hard Bins å° LightGBM Expert ğŸŸ¡ P1

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | ç”¨å° LightGBM æ›¿æ¢/å¢å¼º Bin3/Bin6 çš„ expert |
| **éªŒè¯å‡è®¾** | H-15: ç”¨å° LightGBM æ›¿æ¢å›°éš¾ bin expert èƒ½æ”¹å–„è¯¥åŒºåŸŸæ€§èƒ½ |
| **å®šä½** | **åªæ›¿æ¢ Bin3ã€Bin6 çš„ expert**ï¼ˆæˆ–ä½œä¸º residual correctorï¼‰ï¼Œå…¶ä½™ bin ç»§ç»­ Ridge |
| **è¾“å…¥** | ä¸è¦å…¨è°±ï¼Œä¼˜å…ˆç”¨"MVP-13 é€‰å‡ºæ¥çš„çª—å£ç‰¹å¾ + å°‘é‡ summary" |
| **å…³é”®é˜²ç¿»è½¦** | **stacking-safe** ç‰ˆæœ¬ï¼šå¯¹ gate/äºŒçº§æ¨¡å‹ç”¨ **out-of-fold çš„ expert é¢„æµ‹** è®­ç»ƒï¼ˆé¿å… meta-model è¿‡æ‹Ÿåˆï¼‰ |
| **éªŒæ”¶æ ‡å‡†** | full coverage ç¨³å®šè¶…è¿‡ 0.91ï¼ŒBin3/Bin6 ä¸å†æ‹–åè…¿ |
| **æ­¢æŸç‚¹** | å¦‚æœ LGBM expert åªæå‡ <0.01 â†’ è¯´æ˜ç‰¹å¾æ‰æ˜¯ç“¶é¢ˆï¼Œå›åˆ° MVP-13 |

**å®éªŒæ­¥éª¤**ï¼š
```
Step 1: é€‰æ‹©çª—å£ç‰¹å¾
â”œâ”€â”€ å¤ç”¨ MVP-13 é€‰å‡ºçš„çª—å£
â”œâ”€â”€ æå– depth/EW/shape ç‰¹å¾
â””â”€â”€ åŠ å°‘é‡ summaryï¼ˆå¦‚ PCA å‰å‡ ç»´ï¼‰

Step 2: è®­ç»ƒ LGBM Expert
â”œâ”€â”€ åªä¸º Bin3 è®­ç»ƒä¸€ä¸ª LGBM
â”œâ”€â”€ åªä¸º Bin6 è®­ç»ƒä¸€ä¸ª LGBM
â””â”€â”€ ä½¿ç”¨ OOF é¢„æµ‹é¿å…è¿‡æ‹Ÿåˆ

Step 3: é›†æˆ
â”œâ”€â”€ Bin3/Bin6 ç”¨ LGBM expert
â”œâ”€â”€ å…¶ä»– bin ç»§ç»­ç”¨ Ridge expert
â””â”€â”€ Gate æƒé‡ä¿æŒä¸å˜

Step 4: è¯„ä¼°
â”œâ”€â”€ per-bin RÂ² å¯¹æ¯”
â”œâ”€â”€ full coverage RÂ²
â””â”€â”€ ç¡®è®¤ Bin3/Bin6 ä¸å†æ‹–åè…¿
```

## å·²å®Œæˆ Phase è¯¦ç»†è®¾è®¡

### Phase 1: åˆ†åŒºé—´ Ridge

#### MVP-1.0: Piecewise Ridge âœ…

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | éªŒè¯æŒ‰ $(T_{\text{eff}}, [\text{M/H}])$ åˆ† bin åï¼Œåˆ†åŒº Ridge æ˜¯å¦æ¯”å…¨å±€ Ridge æ›´å¥½ |
| **åˆ† bin æ–¹æ¡ˆ** | $T_{\text{eff}} \in [3750, 4500), [4500, 5250), [5250, 6000]$; $[\text{M/H}] \in [-2, -1), [-1, 0.0], (0.0, 0.5]$ â†’ 3Ã—3=9 bins |
| **ç»“æœ** | âš ï¸ åŸ Î”RÂ²=0.078 è¢«é«˜ä¼°ï¼Œè§ MVP-1.1 |

#### MVP-1.1: ä¸¥è°¨éªŒè¯ âœ…

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | mask-aligned å…¬å¹³æ¯”è¾ƒ + Bootstrap CI + æ¶ˆè |
| **ç»“æœ** | **Î”RÂ²=0.050**, CI=[0.033, 0.067]ï¼›[M/H] è´¡çŒ® 68.7% |

---

### Phase 2: æŒ‰ SNR åˆ†ä¸“å®¶

#### MVP-2.0: Noise-conditioned Ridge âœ…

| é¡¹ç›® | é…ç½® |
|------|------|
| **ç›®æ ‡** | éªŒè¯ä¸ºæ¯ä¸ª noise level å•ç‹¬è®­ç»ƒæ¨¡å‹æ˜¯å¦æ¯”æ··åˆè®­ç»ƒæ›´å¥½ |
| **ç»“æœ** | **å¹³å‡ Î”RÂ²=+0.080**ï¼›ä½† noise=0.5 ç¿»è½¦ |

---

# 4. ğŸ“Š è¿›åº¦è¿½è¸ª

## 4.1 çœ‹æ¿è§†å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â³ è®¡åˆ’ä¸­   â”‚  ğŸ”´ å¾…æ‰§è¡Œ   â”‚  ğŸš€ è¿è¡Œä¸­   â”‚   âœ… å·²å®Œæˆ   â”‚   âŒ å·²å–æ¶ˆ   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ MVP-4.0      â”‚ MVP-12B      â”‚              â”‚ MVP-0        â”‚ MVP-7.1~7.3  â”‚
â”‚ MVP-6.0      â”‚ MVP-13~15    â”‚              â”‚ MVP-1.0      â”‚ MVP-PG2      â”‚
â”‚ MVP-PG3      â”‚              â”‚              â”‚ MVP-1.1 âœ“    â”‚ MVP-Next-C âŒâ”‚
â”‚              â”‚              â”‚              â”‚ MVP-2.0      â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-3.0 âœ“    â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-3.1 âŒ   â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-3.2 âœ“    â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-5.0 âœ“    â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-PG1 âœ“ ğŸŸ¢ â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-NN1 âœ“ âš ï¸ â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-9E1 âœ“ ğŸŸ¢ â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-Next-A âœ“ â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-Next-B âœ“ â”‚              â”‚
â”‚              â”‚              â”‚              â”‚ MVP-12A âœ“ ğŸŸ¢ â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… Phase 12A å®Œæˆï¼ˆ2025-12-07ï¼‰ï¼š
- MVP-12A âœ…: 100k è§„æ¨¡å¤åˆ» â†’ RÂ²=0.9400 ç¨³å®šå¤ç°ï¼
- CI_low=0.0045 > 0ï¼Œæ˜¾è‘—ä¼˜äº 32k baseline (+0.0090)
- H-12A å‡è®¾éªŒè¯é€šè¿‡

âœ… Phase 11 å®Œæˆï¼ˆ2025-12-04ï¼‰ï¼š
- MVP-Next-A âœ…: å›å½’æœ€ä¼˜ soft mixing â†’ RÂ²=0.9310
- MVP-Next-B âœ…: 100% coverage â†’ RÂ²=0.8957
- MVP-Next-C âŒ: Expert æ ¡å‡† â†’ å‡è®¾è¢«å¦å®š
- M2 é‡Œç¨‹ç¢‘ï¼šâœ… è¾¾æˆï¼å›å½’ gate + full coverage éªŒè¯å®Œæˆ

ğŸ”´ Phase 12-13 ç«‹é¡¹ï¼ˆ2025-12-05ï¼‰ï¼š
- MVP-12A: 100k è§„æ¨¡å¤åˆ»ï¼ˆæœ€é«˜ä¼˜å…ˆçº§ï¼‰
- MVP-12B: Coverage++ï¼ˆå¯äº¤ä»˜æ€§ï¼‰
- MVP-13~15: ç‰¹å¾å¢å¼º & å°æ¨¡å‹ï¼ˆP1 å¾…éªŒè¯ï¼‰

ğŸŸ¢ Phase 9 å®Œæˆï¼ˆ2025-12-04ï¼‰ï¼š
- MVP-9E1 âœ… å¤§æˆåŠŸï¼RÂ²=0.9213, Ï=1.13, Gate å‡†ç¡®ç‡ 94.6%

âš ï¸ Phase 10 MVP-NN1 å®Œæˆï¼ˆ2025-12-04ï¼‰ï¼š
- Î”RÂ²=+0.257ï¼ˆMoE vs Globalï¼‰âœ… è¾¾æ ‡
- ä½† NN RÂ²=0.38 << Ridge RÂ²=0.87 âŒ å…¨è°± MLP æ¶æ„ä¸é€‚åˆ

ğŸŸ¢ Phase 8 é‡å¤§çªç ´ï¼ˆ2025-12-04ï¼‰ï¼š
- MVP-PG1 âœ… å®Œæˆï¼Ï=1.00ï¼ŒSoft routing ä¿ä½ 100% oracle å¢ç›Š
- Gate é—®é¢˜å·²è§£å†³ï¼ç“¶é¢ˆè½¬ç§»åˆ°ä¸“å®¶æ•°é‡å’Œè¡¨è¾¾èƒ½åŠ›

âŒ Phase 7 å–æ¶ˆï¼ˆä¸å†éœ€è¦ï¼‰ï¼š
- MVP-7.1~7.3 å–æ¶ˆï¼Œç‰©ç†çª— Gate å·²è§£å†³ gating é—®é¢˜
- æ— éœ€è½¬å‘ Conditional è·¯çº¿
```

## 4.2 æ ¸å¿ƒç»“è®ºå¿«ç…§

| MVP | æ ¸å¿ƒç»“è®ºï¼ˆä¸€å¥è¯ï¼‰ | å…³é”®æ•°å­— | åŒæ­¥åˆ° Hub |
|-----|------------------|---------|-----------|
| MVP-0 | baseline | RÂ²=0.8616 | âœ… Â§5.3 |
| MVP-1.0 | âš ï¸ åŸ Î”RÂ²=0.078 è¢«é«˜ä¼° | - | âœ… Â§3.1 C1 |
| MVP-1.1 | MoE æ•ˆæœç¨³å¥ï¼Œ[M/H] ä¸»å¯¼ | Î”RÂ²=+0.050, CI=[0.033,0.067] | âœ… Â§3.2 C1, C2 |
| MVP-2.0 | Noise-matched æœ‰ä»·å€¼ï¼Œä½†ç¦»æ•£åˆ†æ¡£ä¸ç¨³å®š | Î”RÂ²=+0.080 avg | âœ… Â§3.2 C5 |
| MVP-3.0 | Quantile bins å¤±è´¥ | K=2 å”¯ä¸€æ­£å¢ç›Š | âœ… Â§3.2 C3 |
| MVP-3.1 | Pseudo gating å‡ ä¹æ— ç”¨ | ä»… 7.3% Oracle | âœ… Â§3.2 C3 |
| MVP-3.2 | æ¡ä»¶çº¿æ€§è¾¾ 80% MoE | RÂ²=0.9018 | âœ… Â§3.2 C4 |
| MVP-5.0 | Ca II triplet é‡è¦ï¼Œé«˜[M/H]åˆ†æ•£ | 1.65Ã— | âœ… Â§3.2 C2 |
| **MVP-PG1** | **ğŸŸ¢ ç‰©ç†çª— Gate è¶…é¢„æœŸï¼Soft routing ä¿ä½ 100% å¢ç›Š** | **Ï=1.00, Acc=82%** | âœ… **Â§3.2 C6** |
| **MVP-NN1** | **âš ï¸ MoE NN æå‡æ˜æ˜¾ä½† NN<<Ridgeï¼›å…¨è°± MLP ä¸é€‚åˆ** | **Î”RÂ²=+0.257, RÂ²_NN=0.38** | âœ… **Â§3.2 C7** |
| **MVP-9E1** | **ğŸŸ¢ 9ä¸“å®¶æ‰©å±•å¤§æˆåŠŸï¼Ï=1.13è¶…è¶ŠOracleï¼ŒRÂ²=0.9213çªç ´0.90** | **Ï=1.13, RÂ²=0.9213, Acc=94.6%** | âœ… **Â§3.2 C8** |
| **MVP-Next-A** | **ğŸŸ¢ å›å½’Gateä¼˜äºåˆ†ç±»Gateï¼ŒRÂ²=0.9310** | **Î”RÂ²=+0.0097** | âœ… **Â§3.2 C8** |
| **MVP-Next-C** | **âŒ H-C æ ¡å‡†å‡è®¾è¢«å¦å®šï¼ŒMetal-poor è¯¯å·®éç³»ç»Ÿæ€§ bias** | **Î”RÂ²=-0.0013, Bin3 Î”RÂ²=-0.0083** | âœ… **Â§3.2 C9** |
| **ğŸŸ¢ MVP-12A** | **ğŸŸ¢ 100k è§„æ¨¡å¤åˆ»å¤§æˆåŠŸï¼RÂ²=0.9400 ç¨³æ€ï¼Œæ˜¾è‘—è¶…è¶Š 32k** | **RÂ²=0.9400, CI=[0.0045,0.0175], vs 32k +0.0090** | âœ… **Â§3.2 C10** |

## 4.3 æ—¶é—´çº¿

| æ—¥æœŸ | äº‹ä»¶ | å¤‡æ³¨ |
|------|------|------|
| 2025-12-03 | åˆ›å»º MoE å®éªŒæ¡†æ¶ | Phase 0-2 å¯åŠ¨ |
| 2025-12-03 | MVP-1.0 å®Œæˆ | âš ï¸ åŸæŠ¥å‘Š Î”RÂ²=0.078 è¢«é«˜ä¼° |
| 2025-12-03 | MVP-2.0 å®Œæˆ | Î”RÂ²=+0.080 |
| 2025-12-03 | MVP-1.1 å®Œæˆ | **ä¿®æ­£ Î”RÂ²=0.050**ï¼Œ[M/H] 68.7% |
| 2025-12-03 | å¤§æ•°æ®é›†éªŒè¯ | Î”RÂ²=0.050 åœ¨ 100k/10k å¤ç° |
| 2025-12-03 | MVP-3.0~3.2 å®Œæˆ | Quantile âŒï¼ŒPseudo âŒï¼ŒCond âœ… |
| 2025-12-03 | MVP-5.0 å®Œæˆ | Ca II 1.65Ã—ï¼Œç³»æ•°åˆ†æ |
| 2025-12-03 | å†³ç­–ç‚¹ D2 è§¦å‘ | Pseudo <50%ï¼Œè½¬ Phase 7 |
| 2025-12-04 | æ‹†åˆ† main â†’ hub + roadmap | æ¶æ„é‡æ„ |
| 2025-12-04 | **ç«‹é¡¹ Phase 8: ç‰©ç†çª— Gate** | MVP-PG1/PG2/PG3ï¼ŒéªŒè¯ gate å¯è½åœ°æ€§ |
| **2025-12-04** | **ğŸŸ¢ MVP-PG1 å®Œæˆï¼** | **Ï=1.00ï¼ŒSoft routing è¶…é¢„æœŸæˆåŠŸ** |
| **2025-12-07** | **ğŸŸ¢ MVP-12A å®Œæˆï¼** | **100k RÂ²=0.9400 ç¨³æ€å¤ç°ï¼CI_low > 0** |

---

# 5. ğŸ”— è·¨ä»“åº“é›†æˆ

## 5.1 å®éªŒç´¢å¼•

| experiment_id | project | topic | çŠ¶æ€ | å¯¹åº” MVP |
|---------------|---------|-------|------|---------|
| `VIT-20251203-moe-piecewise-01` | VIT | moe | âœ… | MVP-1.0 |
| `VIT-20251203-moe-snr-02` | VIT | moe | âœ… | MVP-2.0 |
| `VIT-20251203-moe-rigorous-01` | VIT | moe | âœ… | MVP-1.1 |
| `VIT-20251203-moe-quantile-01` | VIT | moe | âœ… | MVP-3.0 |
| `VIT-20251203-moe-pseudo-01` | VIT | moe | â³ | MVP-3.1 |
| `VIT-20251203-moe-conditional-01` | VIT | moe | âœ… | MVP-3.2 |
| `VIT-20251203-moe-logg-gate-01` | VIT | moe | â³ | MVP-4.0 |
| `VIT-20251203-moe-coef-01` | VIT | moe | âœ… | MVP-5.0 |
| `VIT-20251203-moe-nn-03` | VIT | moe | â³ | MVP-6.1 |
| `VIT-20251204-moe-phys-gate-01` | VIT | moe | âœ… **å®Œæˆ** | MVP-PG1 |
| **`VIT-20251204-moe-9expert-01`** | VIT | moe | âœ… **å®Œæˆï¼** | **MVP-9E1** |
| `VIT-20251204-moe-nn-expert-01` | VIT | moe | âœ… **å®Œæˆ** | MVP-NN1 |
| **`VIT-20251204-moe-regress-gate-01`** | VIT | moe | âœ… **RÂ²=0.9310** | **MVP-Next-A** |
| **`VIT-20251204-moe-full-coverage-01`** | VIT | moe | âœ… **å®Œæˆ** | **MVP-Next-B** |
| **`VIT-20251204-moe-calibration-01`** | VIT | moe | â³ **ç«‹é¡¹** | **MVP-Next-C** |
| **`VIT-20251205-moe-100k-01`** | VIT | moe | âœ… **RÂ²=0.9400 å®Œæˆ** | **MVP-12A** |
| **`VIT-20251205-moe-coverage-plus-01`** | VIT | moe | â³ **ç«‹é¡¹ä¸­** | **MVP-12B** |
| **`VIT-20251205-moe-feature-mining-01`** | VIT | moe | â³ **ç«‹é¡¹ä¸­** | **MVP-13** |
| **`VIT-20251205-moe-embedding-01`** | VIT | moe | â³ **ç«‹é¡¹ä¸­** | **MVP-14** |
| **`VIT-20251205-moe-lgbm-expert-01`** | VIT | moe | â³ **ç«‹é¡¹ä¸­** | **MVP-15** |

## 5.2 ä»“åº“å…³è”

| ä»“åº“ | ç›¸å…³ç›®å½• | è¯´æ˜ |
|------|---------|------|
| VIT | `~/VIT/results/moe/` | è®­ç»ƒç»“æœ |
| æœ¬ä»“åº“ | `logg/moe/` | çŸ¥è¯†æ²‰æ·€ |

---

# 6. ğŸ“ é™„å½•

## 6.1 æ•°å€¼ç»“æœæ±‡æ€»è¡¨

### ä¸»è¦æŒ‡æ ‡å¯¹æ¯” (noise=0.2, mask-aligned)

| MVP | é…ç½® | $R^2$ | Î”RÂ² | 95% CI | å¤‡æ³¨ |
|-----|------|-------|-----|--------|------|
| MVP-0 | å…¨å±€ Ridge | 0.8616 | - | - | baseline |
| MVP-1.0 | åˆ†åŒº Ridge | **0.9116** | **+0.050** | [0.033, 0.067] | âš ï¸ åŸ +0.078 è¢«é«˜ä¼° |
| MVP-1.1 æ¶ˆè ([M/H] only) | 3 ä¸“å®¶ | - | +0.034 | - | è´¡çŒ® 68.7% |
| MVP-1.1 æ¶ˆè (Teff only) | 3 ä¸“å®¶ | - | +0.021 | - | è´¡çŒ® 42.9% |
| MVP-2.0 | Noise-cond Expert (avg) | - | **+0.0797** | - | âœ… æœ‰ä»·å€¼ |
| MVP-3.2 | Conditional Ridge 1st | **0.9018** | - | - | è¾¾ MoE 80% |
| **MVP-PG1** | **Phys Gate (Soft)** | **0.8724** | - | - | ğŸŸ¢ **Ï=1.00ï¼** |

### ğŸŸ¢ ç‰©ç†çª— Gate ç»“æœ (MVP-PG1)

| è·¯ç”±æ–¹å¼ | RÂ² | Ï | å¤‡æ³¨ |
|---------|-----|---|------|
| Oracle | 0.8725 | 1.000 | ä¸Šé™ |
| **Soft** | **0.8724** | **0.997** | âœ… **æ¨è** |
| Soft+fallback | 0.8727 | 1.006 | æœ€ä½³ä½†å·®å¼‚å° |
| Hard | 0.8619 | 0.722 | æŸå¤± 28% |
| Global Ridge | 0.8341 | 0.000 | baseline |

**æ¶ˆèå®éªŒ**ï¼š
| ç‰¹å¾é…ç½® | Ï | è¯´æ˜ |
|---------|---|------|
| All (11 ç»´) | 0.997 | å®Œæ•´ |
| No Teff proxy | 0.887 | -11% |
| Only Ca II | 0.629 | æ ¸å¿ƒç‰¹å¾ |
| Only EW_CaT | 0.548 | æœ€å°å¯ç”¨ |

### å¤§æ•°æ®é›†éªŒè¯ (100k train / 10k test)

| Noise | Global RÂ² | MoE RÂ² | Î”RÂ² | 95% CI | Verdict |
|-------|-----------|--------|-----|--------|---------|
| **0.2** | 0.8745 | **0.9246** | **+0.0501** | **[0.0451, 0.0552]** | âœ… ç¨³å¥ |
| **0.5** | 0.7198 | **0.7719** | **+0.0521** | **[0.0421, 0.0611]** | âœ… ç¨³å¥ |

### ğŸŸ¢ MVP-12A: 100k è§„æ¨¡å¤åˆ» (2025-12-07)

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| **covered-test RÂ²** | **0.9400** | MLP gate, 100k train |
| **Bootstrap CI (MLP - Classify)** | **[0.0045, 0.0175]** | CI_low > 0ï¼ |
| **vs 32k baseline** | **+0.0090** | 0.9400 vs 0.9310 |
| **è¿è¡Œæ—¶é—´** | ~5 å°æ—¶ | 2025-12-07 å®Œæˆ |

**Per-bin Î”RÂ² (MLP vs Classify)**:
| Bin | æè¿° | RÂ²_MLP | Î”RÂ² |
|-----|------|--------|-----|
| 0 | Cool Metal-poor | 0.9573 | +0.0166 |
| 4 | Mid Solar | 0.9392 | **+0.0212** |
| 6 | Hot Metal-poor | 0.8637 | **+0.0199** |

### åˆ† bin ç»Ÿè®¡ (noise=0.2)

| Bin | $T_{\text{eff}}$ èŒƒå›´ | $[\text{M/H}]$ èŒƒå›´ | Train | Test | å±€éƒ¨ $R^2$ | vs å…¨å±€ |
|-----|---------------------|-------------------|-------|------|-----------|--------|
| 1 | [3750, 4500) | [-2, -1) | 2,910 | 90 | 0.8971 | +0.063 |
| 2 | [3750, 4500) | [-1, 0.0] | 2,872 | 76 | 0.9569 | +0.123 |
| 3 | [3750, 4500) | (0.0, 0.5] | 2,064 | 59 | **0.9803** | **+0.146** |
| 4 | [4500, 5250) | [-2, -1) | 3,278 | 105 | **0.7726** | **-0.062** |
| 5 | [4500, 5250) | [-1, 0.0] | 3,224 | 83 | 0.9159 | +0.082 |
| 6 | [4500, 5250) | (0.0, 0.5] | 2,308 | 65 | 0.9789 | +0.145 |
| 7 | [5250, 6000] | [-2, -1) | 3,658 | 107 | **0.7869** | **-0.047** |
| 8 | [5250, 6000] | [-1, 0.0] | 3,769 | 129 | 0.9277 | +0.094 |
| 9 | [5250, 6000] | (0.0, 0.5] | 2,526 | 102 | 0.9691 | +0.135 |

### Noise-conditioned Expert å¯¹æ¯”

| Test Noise | Expert RÂ² | Mixed RÂ² | Î”RÂ² | Expert æœ€ä¼˜ Î± |
|------------|-----------|----------|-----|--------------|
| 0.0 | 0.9991 | 0.8207 | **+0.178** | 0.001 |
| 0.1 | 0.9130 | 0.8168 | +0.096 | 1.0 |
| 0.2 | 0.8341 | 0.8001 | +0.034 | 10.0 |
| 0.5 | 0.6552 | 0.6863 | **-0.031** | 100.0 |
| 1.0 | 0.4601 | 0.3393 | **+0.121** | 100.0 |

---

## 6.2 ç›¸å…³æ–‡ä»¶ç´¢å¼•

| ç±»å‹ | æ–‡ä»¶è·¯å¾„ | è¯´æ˜ |
|------|---------|------|
| Roadmap | `logg/moe/moe_roadmap_20251203.md` | å½“å‰æ–‡ä»¶ |
| Hub | `logg/moe/moe_hub_20251203.md` | æ™ºåº“å¯¼èˆª |
| MVP-1.0 æŠ¥å‘Š | `logg/moe/exp/exp_moe_piecewise_ridge_20251203.md` | Piecewise Ridge |
| MVP-1.1 æŠ¥å‘Š | `logg/moe/exp/exp_moe_rigorous_validation_20251203.md` | ä¸¥è°¨éªŒè¯ |
| MVP-2.0 æŠ¥å‘Š | `logg/moe/exp/exp_moe_noise_conditioned_20251203.md` | Noise-conditioned |
| MVP-3.0 æŠ¥å‘Š | `logg/moe/exp/exp_moe_quantile_bins_sweep_20251203.md` | Quantile Bins |
| MVP-3.2 æŠ¥å‘Š | `logg/moe/exp/exp_moe_conditional_ridge_20251203.md` | Conditional Ridge |
| MVP-5.0 æŠ¥å‘Š | `logg/moe/exp/exp_moe_coefficient_analysis_20251203.md` | ç³»æ•°åˆ†æ |
| **MVP-PG1 æŠ¥å‘Š** | `logg/moe/exp/exp_moe_phys_gate_baseline_20251204.md` | ğŸŸ¢ ç‰©ç†çª— Gate |
| **MVP-12A æŠ¥å‘Š** | `logg/moe/exp/exp_moe_100k_replication_20251205.md` | ğŸŸ¢ 100k å¤åˆ» |
| å›¾è¡¨ç›®å½• | `logg/moe/img/` | å®éªŒå›¾è¡¨ |

---

## 6.3 å˜æ›´æ—¥å¿—

| æ—¥æœŸ | å˜æ›´å†…å®¹ | å½±å“ |
|------|---------|------|
| 2025-12-03 | ä» moe_main.md æ‹†åˆ†åˆ›å»º Roadmap | å…¨éƒ¨ |
| 2025-12-03 | Phase 1-5 å®ŒæˆçŠ¶æ€åŒæ­¥ | Â§2, Â§4 |
| 2025-12-03 | æ·»åŠ  Phase 7 è¯¦ç»†è®¾è®¡ | Â§3 |
| 2025-12-04 | æ¶æ„é‡æ„ï¼šmain â†’ hub + roadmap | å…¨éƒ¨ |
| **2025-12-04** | **ğŸŸ¢ MVP-PG1 å®Œæˆï¼Ï=1.00** | Â§1.1, Â§2.1, Â§3, Â§4, Â§5.1 |
| 2025-12-04 | æ›´æ–° MVP-PG1 è¯¦ç»†è®¾è®¡åŠ å…¥å®é™…ç»“æœ | Â§3 |
| 2025-12-04 | Phase 7 å–æ¶ˆï¼ˆä¸å†éœ€è¦ï¼‰ | Â§4.1 |
| 2025-12-04 | æ¨èä¸‹ä¸€æ­¥ï¼šPhase 6 NN-MoE é›†æˆ | Â§1.2 |
| **2025-12-04** | **ğŸ”´ ç«‹é¡¹ Phase 9-10: MVP-9E1, MVP-NN1** | Â§1.1, Â§2.1, Â§2.2, Â§3, Â§4.1, Â§5.1 |
| 2025-12-04 | æ·»åŠ  Phase 9 (9ä¸“å®¶æ‰©å±•) è¯¦ç»†è®¾è®¡ | Â§3 |
| 2025-12-04 | æ·»åŠ  Phase 10 (NN Expert) è¯¦ç»†è®¾è®¡ | Â§3 |
| 2025-12-04 | æ›´æ–°çœ‹æ¿è§†å›¾å’Œå®éªŒç´¢å¼• | Â§4.1, Â§5.1 |
| **2025-12-04** | **âš ï¸ MVP-NN1 å®Œæˆï¼Î”RÂ²=+0.257 ä½† NN<<Ridge** | Â§2.1, Â§4.1, Â§4.2, Â§5.1 |
| **2025-12-04** | **ğŸŸ¢ MVP-9E1 å¤§æˆåŠŸï¼Ï=1.13, RÂ²=0.9213, Acc=94.6%** | Â§1.1, Â§2.1, Â§4.1, Â§4.2, Â§5.1 |
| **2025-12-04** | **ğŸ”´ ç«‹é¡¹ Phase 11: MVP-Next-A/B/C** | Â§1.1, Â§2.1, Â§2.2, Â§3, Â§4.1, Â§5.1 |
| 2025-12-04 | æ·»åŠ  Phase 11 è¯¦ç»†è®¾è®¡ï¼šå›å½’ gate + coverage + æ ¡å‡† | Â§3 |
| 2025-12-04 | æ›´æ–°çœ‹æ¿è§†å›¾å’Œå®éªŒç´¢å¼• | Â§4.1, Â§5.1 |
| 2025-12-04 | è®¾å®š M2 é‡Œç¨‹ç¢‘ç›®æ ‡ | Â§3 |
| **2025-12-04** | **âŒ MVP-Next-C å®Œæˆï¼H-C æ ¡å‡†å‡è®¾è¢«å¦å®š** | Â§2.1, Â§4.1, Â§4.2, Â§5.1 |
| 2025-12-04 | æ›´æ–°çœ‹æ¿è§†å›¾ï¼šMVP-Next-C ç§»è‡³å·²å–æ¶ˆï¼ŒMVP-Next-A ç§»è‡³å·²å®Œæˆ | Â§4.1 |
| **2025-12-05** | **ğŸ”´ ç«‹é¡¹ Phase 12-13: MVP-12A/12B/13/14/15** | Â§1.1, Â§2.1, Â§2.2, Â§3, Â§5.1 |
| 2025-12-05 | æ·»åŠ  Phase 12 (å¤§è§„æ¨¡éªŒè¯) è¯¦ç»†è®¾è®¡ | Â§3 |
| 2025-12-05 | æ·»åŠ  Phase 13 (ç‰¹å¾å¢å¼º & å°æ¨¡å‹) è¯¦ç»†è®¾è®¡ | Â§3 |
| 2025-12-05 | æ›´æ–°å®éªŒç´¢å¼•ï¼šæ·»åŠ  MVP-12A~15 | Â§5.1 |
| **2025-12-07** | **Review & Fixï¼šçŠ¶æ€ä¸€è‡´æ€§ä¿®å¤** | Â§1.1, Â§1.2, Â§2.1, Â§3, Â§4.1 |
| 2025-12-07 | æ›´æ–°ä¾èµ–å›¾ä¸º Phase 11-13 é‡ç‚¹ | Â§1.2 |
| 2025-12-07 | Phase 7 è¯¦ç»†è®¾è®¡æ ‡è®°ä¸ºå·²å–æ¶ˆ | Â§3 |
| 2025-12-07 | å·²å®Œæˆ Phase æŠ˜å åˆ° `<details>` åŒºå— | Â§3 |
| 2025-12-07 | MVP-Next-B ç§»è‡³çœ‹æ¿å·²å®ŒæˆåŒºåŸŸ | Â§4.1 |
| 2025-12-07 | å¾…åˆ›å»ºå®éªŒæŠ¥å‘Šé“¾æ¥æ ‡æ³¨ä¸º (å¾…åˆ›å»º) | Â§2.1 |
| **2025-12-09** | **ğŸŸ¢ MVP-12A å®Œæˆï¼100k RÂ²=0.9400 ç¨³æ€å¤ç°** | Â§1.1, Â§1.2, Â§2.1, Â§4.1, Â§4.2, Â§4.3, Â§5.1 |
| 2025-12-09 | æ›´æ–° MVP-13/14/15ï¼šåœ¨ 32k ä¸Šæ“ä½œ | Â§2.2 |
