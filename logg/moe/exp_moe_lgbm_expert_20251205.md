# ğŸ“— å®éªŒæŠ¥å‘Šï¼šHard Bins å° LightGBM Expert

---
> **å®éªŒåç§°ï¼š** MVP-15: Hard Bins å° LightGBM Expert  
> **å¯¹åº” MVPï¼š** MVP-15  
> **ä½œè€…ï¼š** Viska Wei  
> **æ—¥æœŸï¼š** 2025-12-05  
> **æ•°æ®ç‰ˆæœ¬ï¼š** å…¨é‡  
> **æ¨¡å‹ç‰ˆæœ¬ï¼š** Bin3/Bin6 ç”¨ LGBM expertï¼Œå…¶ä½™ Ridge  
> **çŠ¶æ€ï¼š** ğŸ”„ ç«‹é¡¹ä¸­  
> **éªŒè¯å‡è®¾ï¼š** H-15

---

## ğŸ”— ä¸Šæ¸¸è¿½æº¯é“¾æ¥

| ç±»å‹ | é“¾æ¥ | è¯´æ˜ |
|------|------|------|
| ğŸ“ Roadmap | [`moe_roadmap.md`](./moe_roadmap_20251203.md) | Phase 13 |
| ğŸ§  Hub | [`moe_hub.md`](./moe_hub_20251203.md) | Q9.5, H-15 |
| ğŸ“‹ Kanban | [`kanban.md`](../../status/kanban.md) | VIT-20251205-moe-lgbm-expert-01 |
| ğŸ“— å‰åºå®éªŒ | [`exp_moe_feature_mining`](./exp_moe_feature_mining_20251205.md) | MVP-13 é€‰çº¿çª—å£ |

---

## âš¡ æ ¸å¿ƒç»“è®ºé€Ÿè§ˆ

> **ä¸€å¥è¯æ€»ç»“**ï¼šâ³ å®éªŒè¿›è¡Œä¸­
>
> **å‡è®¾éªŒè¯**ï¼š
> - H-15: ç”¨å° LightGBM æ›¿æ¢å›°éš¾ bin expert èƒ½æ”¹å–„è¯¥åŒºåŸŸæ€§èƒ½ â†’ â³
>
> **å…³é”®æ•°å­—**ï¼š
> - full coverage RÂ²: â³
> - Bin3 RÂ²: â³
> - Bin6 RÂ²: â³

---

# 1. ğŸ¯ ç›®æ ‡

## 1.1 å®éªŒç›®çš„

ç”¨å° LightGBM æ›¿æ¢/å¢å¼º Bin3/Bin6 çš„ expertã€‚

**ä¸ºä»€ä¹ˆåš**ï¼š
- Bin3 (Metal-poor Cool) å’Œ Bin6 (Metal-poor Hot) æ˜¯å½“å‰æœ€å¼±çš„åŒºåŸŸ
- Ridge å¯èƒ½æ— æ³•æ•æ‰å¤æ‚çš„éçº¿æ€§å…³ç³»
- LightGBM åœ¨ç±»ä¼¼ä»»åŠ¡ä¸Šè¡¨ç°è‰¯å¥½ (LGBM baseline = 0.91)

**å…³é”®è®¾è®¡åŸåˆ™**ï¼š
- **åªæ›¿æ¢ Bin3ã€Bin6 çš„ expert**ï¼ˆæˆ–ä½œä¸º residual correctorï¼‰
- å…¶ä½™ bin ç»§ç»­ Ridgeï¼Œé¿å…å¤æ‚åº¦çˆ†ç‚¸
- è¾“å…¥ä¸è¦å…¨è°±ï¼Œä¼˜å…ˆç”¨"MVP-13 é€‰å‡ºæ¥çš„çª—å£ç‰¹å¾ + å°‘é‡ summary"
- **Stacking-safe**ï¼šå¯¹ gate/äºŒçº§æ¨¡å‹ç”¨ **out-of-fold çš„ expert é¢„æµ‹** è®­ç»ƒ

**åšå®Œèƒ½ä¸èƒ½åœ**ï¼š
- âœ… å¦‚æœ full coverage RÂ² > 0.91 ä¸” Bin3/Bin6 ä¸å†æ‹–åè…¿ â†’ å¯äº¤ä»˜
- âš ï¸ å¦‚æœ LGBM expert åªæå‡ <0.01 â†’ è¯´æ˜ç‰¹å¾æ‰æ˜¯ç“¶é¢ˆï¼Œå›åˆ° MVP-13

## 1.2 é¢„æœŸç»“æœ

| æŒ‡æ ‡ | é¢„æœŸå€¼ | æœ€ä½å¯æ¥å— |
|------|--------|----------|
| full coverage RÂ² | > 0.91 | â‰¥ 0.90 |
| Bin3 RÂ² | æ˜æ˜¾æ”¹å–„ | ä¸æ‹–åè…¿ |
| Bin6 RÂ² | æ˜æ˜¾æ”¹å–„ | ä¸æ‹–åè…¿ |

---

# 2. ğŸ§ª å®éªŒè®¾è®¡

## 2.1 æ•°æ®é…ç½®

| é…ç½®é¡¹ | å€¼ | è¯´æ˜ |
|--------|-----|------|
| **ç›®æ ‡ bins** | Bin3, Bin6 | Metal-poor |
| **å…¶ä»– bins** | ç»§ç»­ç”¨ Ridge | ä¿æŒç¨³å®š |
| **ç‰¹å¾è¾“å…¥** | MVP-13 é€‰çº¿çª—å£ + summary | ä¸è¦å…¨è°± |

## 2.2 æ¨¡å‹ä¸ç®—æ³•

### æ··åˆä¸“å®¶æ¶æ„

```
9-expert MoE:
â”œâ”€â”€ Bin1: Ridge (ä¿æŒ)
â”œâ”€â”€ Bin2: Ridge (ä¿æŒ)
â”œâ”€â”€ Bin3: LightGBM-lite (æ›¿æ¢ï¼)
â”œâ”€â”€ Bin4: Ridge (ä¿æŒ)
â”œâ”€â”€ Bin5: Ridge (ä¿æŒ)
â”œâ”€â”€ Bin6: LightGBM-lite (æ›¿æ¢ï¼)
â”œâ”€â”€ Bin7: Ridge (ä¿æŒ)
â”œâ”€â”€ Bin8: Ridge (ä¿æŒ)
â””â”€â”€ Bin9: Ridge (ä¿æŒ)
```

### LGBM Expert è®¾è®¡

| é…ç½®é¡¹ | å€¼ | è¯´æ˜ |
|--------|-----|------|
| **n_estimators** | 100 | lite ç‰ˆæœ¬ |
| **max_depth** | 6 | é˜²è¿‡æ‹Ÿåˆ |
| **learning_rate** | 0.1 | - |
| **feature_fraction** | 0.8 | - |
| **bagging_fraction** | 0.8 | - |

### ç‰¹å¾è®¾è®¡

| ç‰¹å¾ç±»å‹ | æ¥æº | ç»´åº¦ |
|---------|------|------|
| **é€‰çº¿çª—å£** | MVP-13 é€‰å‡º | ~20 ç»´ |
| **Summary** | PCA å‰å‡ ç»´ | ~5 ç»´ |
| **Gate features** | ç°æœ‰ 13 ç»´ | å¯é€‰ |

### Stacking-Safe è®­ç»ƒ

**å…³é”®é˜²ç¿»è½¦**ï¼š

```
Step 1: K-fold split (K=5)
    â†“
Step 2: å¯¹æ¯ä¸ª fold:
    â”œâ”€â”€ ç”¨å…¶ä»– 4 folds è®­ç»ƒ LGBM expert
    â””â”€â”€ åœ¨è¯¥ fold ä¸Šé¢„æµ‹ â†’ OOF é¢„æµ‹
    â†“
Step 3: OOF é¢„æµ‹ç”¨äº:
    â”œâ”€â”€ Gate/äºŒçº§æ¨¡å‹è®­ç»ƒ
    â””â”€â”€ æœ€ç»ˆè¯„ä¼°
```

**å¥½å¤„**ï¼šé¿å… meta-model è¿‡æ‹Ÿåˆåˆ° in-sample é¢„æµ‹

## 2.3 è¶…å‚æ•°é…ç½®

| å‚æ•° | å€¼ | è¯´æ˜ |
|------|-----|------|
| LGBM n_estimators | 100 | lite |
| LGBM max_depth | 6 | é˜²è¿‡æ‹Ÿåˆ |
| K-fold | 5 | OOF |
| ç‰¹å¾ç»´åº¦ | ~25 | ç²¾ç®€ |

## 2.4 è¯„ä»·æŒ‡æ ‡

| æŒ‡æ ‡ | å…¬å¼ | è¯´æ˜ |
|------|------|------|
| **full coverage RÂ²** | ä¸»æŒ‡æ ‡ | å¯äº¤ä»˜æ€§ |
| **Bin3 RÂ²** | per-bin | Metal-poor Cool |
| **Bin6 RÂ²** | per-bin | Metal-poor Hot |
| **vs Ridge baseline** | Î”RÂ² | æ”¹å–„å¹…åº¦ |

---

# 3. ğŸ“Š å®éªŒå›¾è¡¨

> â³ å®éªŒè¿›è¡Œä¸­ï¼Œå¾…å¡«å……

---

# 4. ğŸ’¡ å…³é”®æ´è§

> â³ å®éªŒè¿›è¡Œä¸­ï¼Œå¾…å¡«å……

---

# 5. ğŸ“ ç»“è®º

> â³ å®éªŒè¿›è¡Œä¸­ï¼Œå¾…å¡«å……

---

# 6. ğŸ“ é™„å½•

## 6.1 æ•°å€¼ç»“æœè¡¨

> â³ å®éªŒè¿›è¡Œä¸­ï¼Œå¾…å¡«å……

## 6.2 å®éªŒæµç¨‹è®°å½•

### æ‰§è¡Œå‘½ä»¤

```bash
# TBD
```

### å…³é”®æ—¥å¿—

> â³ å®éªŒè¿›è¡Œä¸­ï¼Œå¾…å¡«å……

## 6.3 ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ç±»å‹ | è·¯å¾„ | è¯´æ˜ |
|---------|------|------|
| è®­ç»ƒè„šæœ¬ | `~/VIT/scripts/moe_lgbm_expert.py` | TBD |
| ç»“æœç›®å½• | `~/VIT/results/moe/lgbm_expert/` | TBD |
| å›¾è¡¨ç›®å½• | `logg/moe/img/` | TBD |

---

*å®éªŒ ID: VIT-20251205-moe-lgbm-expert-01*

