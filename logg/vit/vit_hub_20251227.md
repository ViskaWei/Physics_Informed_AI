# ğŸ§  ViT Hub: Scaling Vision Transformers for Stellar Spectra
> **ID:** VIT-20251227-vit-hub | **Status:** ğŸŒºç¨³å®š |  
> **Date:** 2025-12-27 | **Update:** 2025-12-28 (Fisher Residual Overlay)  
> **Root:** [master_hub](../master_hub.md) | **Child:** - |
> **ğŸ¯ å¤§æ–¹å‘:** éªŒè¯ ViT åœ¨å¤§è§„æ¨¡å…‰è°±æ•°æ®ä¸Šçš„ log_g é¢„æµ‹èƒ½åŠ› â†’ é€¼è¿‘ Fisher/CRLB ç†è®ºä¸Šé™ â†’ å‘è¡¨ Scaling + Ceiling è®ºæ–‡

| # | ğŸ’¡ å…±è¯†[æŠ½è±¡æ´è§] | è¯æ® | å†³ç­– |
|---|----------------------------|----------------|------|
| K1 | **æ•°æ®è§„æ¨¡æ˜¯ ViT çš„å¿…è¦æ¡ä»¶ï¼Œä½†éå……åˆ†æ¡ä»¶**ï¼š100k+ æ•°æ®æ‰èƒ½è¶…è¶Šä¼ ç»Ÿ MLï¼Œä½† 500kâ†’1M å‡ ä¹æ— æå‡ | 100k é¦–è¶… LightGBM; 500kâ†’1M Î”RÂ²=+0.002 | ä¼˜å…ˆ scale åˆ° 100k+ï¼Œä¹‹å scale model |
| K2 | **âš ï¸ å½“å‰æ¶æ„å·²é¥±å’Œï¼ˆp16_h256_L6ï¼‰**ï¼šæ¨¡å‹å®¹é‡ä¸è¶³ï¼Œæ— æ³•ä»æ›´å¤šæ•°æ®ä¸­æå–ä¿¡æ¯ | 500kâ†’1M: ViT +0.002 vs LightGBM +0.040 | **ç“¶é¢ˆå·²ä¸æ˜¯ data sizeï¼Œæ˜¯æ¶æ„å®¹é‡** |
| K3 | **å…‰è°± tokenization å†³å®šä¿¡æ¯ä¿ç•™ç¨‹åº¦**ï¼špatch_sizeã€strideã€C1D/SW é€‰æ‹©å½±å“ç‰¹å¾æå– | p16_h256_L6 æœ€ä¼˜ (sweep 21 runs) | patch_size=16, hidden=256 ä¸ºé»˜è®¤ |
| K4 | **Fisher/CRLB ç»™å‡º SNR æ¡ä»¶ä¸‹çš„ç†è®ºä¸Šé™**ï¼šä»»ä½•æ— åä¼°è®¡å™¨åœ¨è¯¥å™ªå£°ä¸‹çš„æé™ | RÂ²_max=0.874 @ mag=21.5, SNRâ‰ˆ7 (5D ceiling) | ç”¨ ceiling é‡åŒ–æ¨¡å‹ headroom |
| K5 | **RÂ² å¯¹ label çº¿æ€§å½’ä¸€åŒ–ä¸å˜**ï¼šstandard/minmax ä¸å½±å“ RÂ² å¯¹æ¯” | æ•°å­¦è¯æ˜ + å®éªŒéªŒè¯ | å¯ç›´æ¥ä¸ baseline æ¯”è¾ƒ |
| K6 | **âœ… ViT > LightGBM è¯æ˜ Transformer ä¼˜åŠ¿** | RÂ²=0.711 vs 0.614 (+16%) @ 1M | Transformer æ˜¯å…‰è°±å›å½’æœ‰æ•ˆæ¶æ„ |
| K7 | **ViT scaling æ–œç‡æ˜¯ LightGBM çš„ 2.2Ã—**ï¼šä½†ä»…åœ¨æ¶æ„å®¹é‡å…è®¸æ—¶æœ‰æ•ˆ | 50kâ†’1M: ViT +0.277 vs LightGBM +0.126 | å¤§æ•°æ®ä¼˜å…ˆé€‰ ViTï¼Œä½†éœ€è¶³å¤Ÿå¤§æ¨¡å‹ |
| K8 | **ViT åœ¨ SNR~5 é€¼è¿‘ç†è®ºä¸Šé™** | gap=0.13 @ mag=22.0 (ViT=0.68 vs ceiling=0.698) | æ¨¡å‹å·²æ¥è¿‘ç‰©ç†æé™ |

**ğŸ¦¾ ç°é˜¶æ®µä¿¡å¿µ [â‰¤10æ¡ï¼Œå†™"æ‰€ä»¥å‘¢"]**
- **âœ… ViT ä¸»ç»“æœå°±ç»ª**ï¼šRÂ²_test=0.711ï¼Œåœ¨ 100k+ è§„æ¨¡è¶…è¶Šæ‰€æœ‰ baseline â†’ So what: è®ºæ–‡ä¸»ç»“æœå®Œæˆ
- **âœ… Transformer ä¼˜åŠ¿ç¡®ç«‹**ï¼šViT (0.711) > LightGBM (0.614) > TemplateFit (0.404) â†’ So what: è®ºæ–‡ baseline æ¯”è¾ƒå®Œæˆ
- **âš ï¸ å½“å‰æ¶æ„å®¹é‡å·²æ»¡**ï¼š500kâ†’1M æå‡ä»… +0.002ï¼ŒLightGBM ä»æœ‰ +0.040 â†’ So what: **ç“¶é¢ˆä¸å†æ˜¯ dataï¼Œè€Œæ˜¯ model size**
- **æ¶æ„é€‰æ‹©éœ€ scale up**ï¼šp16_h256_L6 å·²åˆ°æé™ â†’ So what: ä¸‹ä¸€æ­¥éœ€è¦ L8-12, h512 ç­‰æ›´å¤§æ¨¡å‹
- **ç†è®ºä¸Šé™æ›²çº¿æ˜¯è®ºæ–‡æ ¸å¿ƒå™äº‹**ï¼šRÂ²_max(SNR) å®šä¹‰ç‰©ç†è¾¹ç•Œ + æ¨¡å‹ gap â†’ So what: ä¸»å›¾ RÂ² vs SNR + ceiling å·²å®Œæˆ
- **âœ… Scaling curve å®Œæˆ**ï¼šViT åœ¨ 100k é¦–è¶… LightGBMï¼Œscaling æ–œç‡ 2.2Ã— â†’ So what: è®ºæ–‡ Fig 2 scaling å™äº‹å®Œæˆ

**ğŸ‘£ ä¸‹ä¸€æ­¥æœ€æœ‰ä»·å€¼ [â‰¤2æ¡ï¼Œç›´æ¥å¯è¿› Roadmap Gate]**
- ğŸ”´ **P0**: æ›´å¤§æ¶æ„å®éªŒ (L8-12, h512) â†’ If Î”RÂ²>0.02 then æ¶æ„ scale æœ‰æ•ˆ; Else éœ€å…¶ä»–ç­–ç•¥ï¼ˆå¦‚ MoE/CNN-hybridï¼‰
- ğŸŸ¡ **P1**: Ablation è¡¨ (patch/C1D-SW/PE) â†’ è®ºæ–‡ Table 2 è®¾è®¡éªŒè¯

> **æƒå¨æ•°å­—ï¼ˆä¸€è¡Œå³å¯ï¼‰**ï¼š**Best=RÂ²=0.711 (test, 10k)**ï¼›Baseline=LightGBM=0.614ï¼›Ceiling=RÂ²_max=0.874 (5D)ï¼›Gap=0.163ï¼›æ¡ä»¶=1M train/10k test, noise=1.0

| æ¨¡å‹/æ–¹æ³• | æŒ‡æ ‡å€¼ | é…ç½® | å¤‡æ³¨ |
|-----------|--------|------|------|
| **ViT-1M (test)** | **RÂ²=0.711** | p16_h256_L6, 1M/10k | âœ… **è®ºæ–‡ä¸»ç»“æœ** |
| ViT @ 500k | RÂ²=0.709 | p16_h256_L6, 500k/10k | 500kâ†’1M ä»… +0.002 âš ï¸ |
| ViT @ 100k | RÂ²=0.596 | p16_h256_L6, 100k/10k | é¦–æ¬¡è¶…è¶Š LightGBM |
| LightGBM | RÂ²=0.614 | raw input, 1M/10k | âœ… baseline |
| LightGBM @ 500k | RÂ²=0.574 | raw input, 500k/10k | 500kâ†’1M +0.040ï¼ˆä»æœ‰æå‡ï¼‰|
| TemplateFit | RÂ²=0.404 | ä¼ ç»Ÿæ–¹æ³• | âœ… baseline |
| Ridge | RÂ²~0.50 | Î±=1e5, 1M | çº¿æ€§ baseline |
| **Fisher 5D ceiling** | **RÂ²_max=0.874** | mag=21.5, SNR=7.1 | **ç†è®ºä¸Šé™** |

### ğŸ“Š æ ¸å¿ƒå›¾è¡¨ï¼ˆè®ºæ–‡ Fig 1ï¼‰
![RÂ² vs SNR](../scaling/exp/img/r2_vs_snr_ceiling_test_10k_unified_snr.png)

**å…³é”®è§‚å¯Ÿ**:
- ViT åœ¨æ‰€æœ‰ SNR åŒºé—´æŒç»­ä¼˜äº LightGBM å’Œ TemplateFit
- åœ¨ mag=22.0 (SNR~5) å¤„ï¼ŒViT å‡ ä¹è§¦åŠ 5D ceiling (gap=0.13)
- åœ¨ä½ SNR (mag>22.5) åŒºï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ¥è¿‘å¤±æ•ˆï¼ˆç¬¦åˆç‰©ç†é¢„æœŸï¼‰

### ğŸ“ˆ Scaling Curveï¼ˆè®ºæ–‡ Fig 2ï¼‰
![ViT Scaling Curve](exp/img/vit_scaling_curve.png)

**å…³é”®ç»“æœ**:
| æ•°æ®è§„æ¨¡ | ViT RÂ² | LightGBM RÂ² | Ridge RÂ² | ViT vs LGBM |
|---------|--------|-------------|----------|-------------|
| **50k** | 0.434 | 0.488 | 0.442 | ViT < LGBM |
| **100k** | **0.596** | 0.553 | 0.475 | **é¦–æ¬¡è¶…è¶Š** âœ“ |
| **200k** | 0.673 | 0.547 | 0.474 | +23% |
| **500k** | 0.709 | 0.574 | 0.490 | +24% |
| **1M** | **0.711** | **0.614** | 0.50 | **+16%** |

**æ ¸å¿ƒæ´è§**:
- **100k æ‹ç‚¹**ï¼šViT åœ¨ 100k æ•°æ®è§„æ¨¡é¦–æ¬¡è¶…è¶Š LightGBM
- **Scaling æ–œç‡**ï¼šViT (50kâ†’1M +0.277) æ˜¯ LightGBM (+0.126) çš„ **2.2Ã—**
- **âš ï¸ æ¶æ„é¥±å’Œ**ï¼š500kâ†’1M ä»… +0.002ï¼Œå½“å‰æ¶æ„ (p16_h256_L6) å®¹é‡å·²æ»¡

---

## 1) ğŸŒ² æ ¸å¿ƒå‡è®¾æ ‘

```
ğŸŒ² æ ¸å¿ƒ: ViT èƒ½å¦åœ¨å…‰è°±æ•°æ®ä¸Šé€¼è¿‘ Fisher/CRLB ç†è®ºä¸Šé™ï¼Ÿ
â”‚
â”œâ”€â”€ Q1: ViT èƒ½å¦æœ‰æ•ˆå­¦ä¹  log_g é¢„æµ‹ï¼Ÿ âœ… å·²éªŒè¯
â”‚   â”œâ”€â”€ Q1.1: æ•°æ®è§„æ¨¡çš„å½±å“ï¼Ÿ â†’ âœ… 1M æ•°æ®æ˜¯å…³é”®ï¼Œå°æ•°æ®æ— æ³•æ”¶æ•›
â”‚   â”œâ”€â”€ Q1.2: æœ€ä¼˜æ¶æ„é…ç½®ï¼Ÿ â†’ âœ… p16_h256_L6_a8 (sweep éªŒè¯)
â”‚   â””â”€â”€ Q1.3: è®­ç»ƒç­–ç•¥ï¼ˆloss/lr/schedulerï¼‰ï¼Ÿ â†’ âœ… MSE + cosine LR æœ‰æ•ˆ
â”‚
â”œâ”€â”€ Q2: å…‰è°± Tokenization å¦‚ä½•è®¾è®¡ï¼Ÿ
â”‚   â”œâ”€â”€ Q2.1: C1D vs SW å“ªä¸ªæ›´ä¼˜ï¼Ÿ â†’ â³ ablation å¾…å®Œæˆ
â”‚   â”œâ”€â”€ Q2.2: patch_size çš„æœ€ä¼˜å€¼ï¼Ÿ â†’ âœ… 16 æœ€ä¼˜ (vs 8/32/64)
â”‚   â””â”€â”€ Q2.3: Position Encoding é€‰æ‹©ï¼Ÿ â†’ â³ learned vs PIPE å¾…éªŒè¯
â”‚
â”œâ”€â”€ Q3: ä¸ Fisher/CRLB ceiling çš„ gap åˆ†æï¼Ÿ âœ… æ ¸å¿ƒå·²å®Œæˆ
â”‚   â”œâ”€â”€ Q3.1: å½“å‰ gap å¤šå¤§ï¼Ÿ â†’ âœ… gap=0.874-0.698=0.18 @ mag=21.5
â”‚   â”œâ”€â”€ Q3.2: åœ¨å“ªä¸ª SNR åŒºé—´ gap æœ€å°ï¼Ÿ â†’ âœ… mag=22.0 æ—¶ gap=0.13ï¼Œå‡ ä¹è§¦åŠ ceiling
â”‚   â””â”€â”€ Q3.3: å¦‚ä½•è¿›ä¸€æ­¥ç¼©å° gapï¼Ÿ â†’ â³ æ›´å¤§æ¨¡å‹/ç»“æ„åŒ–ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
â”‚
â”œâ”€â”€ Q4: ä¸ baseline çš„å¯¹æ¯”ï¼Ÿ âœ… å·²å®Œæˆ
â”‚   â”œâ”€â”€ Q4.1: vs LightGBMï¼Ÿ â†’ âœ… ViT=0.698 > LightGBM=0.614 (+14%)
â”‚   â”œâ”€â”€ Q4.2: vs Template Fittingï¼Ÿ â†’ âœ… ViT=0.698 >> TemplateFit=0.404 (+73%)
â”‚   â””â”€â”€ Q4.3: vs Ridgeï¼Ÿ â†’ âœ… ViT=0.698 >> Ridge=0.46 (+52%)
â”‚
â””â”€â”€ Q5: Scaling Law æ˜¯ä»€ä¹ˆï¼Ÿ âœ… æ ¸å¿ƒå·²å®Œæˆ
    â”œâ”€â”€ Q5.1: N vs performance æ›²çº¿ï¼Ÿ â†’ âœ… ViT åœ¨ 100k é¦–è¶… LightGBMï¼Œæ–œç‡ 2.2Ã—
    â”œâ”€â”€ Q5.2: ä½•æ—¶è¿›å…¥ saturationï¼Ÿ â†’ âœ… **å½“å‰æ¶æ„åœ¨ 500k åé¥±å’Œï¼ˆ500kâ†’1M +0.002ï¼‰**
    â””â”€â”€ Q5.3: å¦‚ä½•çªç ´é¥±å’Œï¼Ÿ â†’ â³ éœ€æ›´å¤§æ¨¡å‹ï¼ˆL8-12, h512ï¼‰éªŒè¯

Legend: âœ… å·²éªŒè¯ | âŒ å·²å¦å®š | ğŸ”† è¿›è¡Œä¸­ | â³ å¾…éªŒè¯ | ğŸ—‘ï¸ å·²å…³é—­
```

---

## 2) å£å¾„å†»ç»“ï¼ˆå”¯ä¸€æƒå¨ï¼‰

| é¡¹ç›® | è§„æ ¼ |
|------|------|
| Dataset / Version | BOSZ 50000, mag205_225_lowT_1M |
| Train / Val / Test | 1,000,000 / 1,000 / 10,000 |
| Wavelength | 7100â€“8850 Ã… (MR arm, 4096 pixels) |
| Parameter Range | Teff 3750â€“6000 K, log_g 1â€“5, [M/H] -0.25â€“0.75 |
| Noise / Regime | heteroscedastic Gaussian, noise_level=1.0 |
| Metric | RÂ², MAE (åŸå§‹ç©ºé—´ log_g) |
| Seed / Repeats | 42 / 1 |

> è§„åˆ™ï¼šä»»ä½•å£å¾„å˜æ›´å¿…é¡»å†™å…¥ Â§8 å˜æ›´æ—¥å¿—ã€‚

---

## 3) å½“å‰ç­”æ¡ˆ & æˆ˜ç•¥æ¨èï¼ˆå¯¹é½é—®é¢˜æ ‘ï¼‰

### 3.1 æˆ˜ç•¥æ¨èï¼ˆåªä¿ç•™"å½“å‰æ¨è"ï¼‰

- **æ¨èè·¯çº¿ï¼šRoute Model Scale**ï¼ˆä¸€å¥è¯ç†ç”±ï¼šå½“å‰æ¶æ„å·²é¥±å’Œï¼Œéœ€è¦æ›´å¤§æ¨¡å‹çªç ´ RÂ²=0.711 ä¸Šé™ï¼‰
- éœ€è¦ Roadmap å…³é—­çš„ Gateï¼šâœ… Gate-1ï¼ˆ200ep å®Œæˆï¼‰, âœ… Gate-2ï¼ˆLightGBM å¯¹æ¯”ï¼‰, âœ… Gate-3ï¼ˆScaling curve å®Œæˆï¼‰, Gate-4ï¼ˆModel scaleï¼‰

| Route | ä¸€å¥è¯å®šä½ | å½“å‰å€¾å‘ | å…³é”®ç†ç”± | éœ€è¦çš„ Gate |
|-------|-----------|----------|---------|-------------|
| **Route Model Scale** | æ›´å¤§æ¶æ„ (L8-12, h512) | ğŸŸ¢ **æ¨è** | 500kâ†’1M é¥±å’Œï¼Œéœ€æ›´å¤§æ¨¡å‹ | Gate-4 |
| Route Tokenization | ä¼˜åŒ– patch/PE è®¾è®¡ | ğŸŸ¡ | ablation æœªå®Œæˆ | Gate-5 |
| ~~Route Data Scale~~ | ~~ç»§ç»­å¢åŠ æ•°æ®~~ | ğŸ”´ ~~å·²å…³é—­~~ | 500kâ†’1M +0.002ï¼Œæ— æ•ˆ | - |
| Route Structure | MoE/å¤šä»»åŠ¡ | ğŸŸ¡ | å¤‡é€‰æ–¹æ¡ˆ | å¦‚ Model Scale æ— æ•ˆ |

### 3.2 åˆ†æ”¯ç­”æ¡ˆè¡¨ï¼ˆæ¯è¡Œå¿…é¡»å›ç­”"æ‰€ä»¥å‘¢"ï¼‰

| åˆ†æ”¯ | å½“å‰ç­”æ¡ˆï¼ˆ1å¥è¯ï¼‰ | ç½®ä¿¡åº¦ | å†³ç­–å«ä¹‰ï¼ˆSo whatï¼‰ | è¯æ®ï¼ˆexp/MVPï¼‰ |
|------|-----------------|--------|-------------------|----------------|
| Q1: ViT æœ‰æ•ˆæ€§ | âœ… 1M æ•°æ®ä¸Š RÂ²=0.711 (test) | ğŸŸ¢ | **è®ºæ–‡ä¸»ç»“æœå®Œæˆ** | exp_vit_scaling_curve |
| Q2: Tokenization | p16_h256 æœ€ä¼˜ï¼ˆå½“å‰æ¶æ„ï¼‰ | ğŸŸ¢ | æ­¤é…ç½®ä½œä¸ºè®ºæ–‡ä¸»æ¨¡å‹ | exp_vit_sweep_analysis |
| Q3: Gap åˆ†æ | gap=0.163 @ mag=21.5, gap=0.13 @ mag=22.0 | ğŸŸ¢ | **ViT æ¥è¿‘ç‰©ç†æé™** | r2_vs_snr_ceiling |
| Q4: Baseline | âœ… ViT (0.711) > LightGBM (0.614) (+16%) | ğŸŸ¢ | **Transformer ä¼˜åŠ¿ç¡®ç«‹** | exp_vit_scaling_curve |
| Q5: Scaling | âœ… 100k é¦–è¶… LightGBMï¼Œ**500k åé¥±å’Œ** | ğŸŸ¢ | **ç“¶é¢ˆä» data â†’ model size** | exp_vit_scaling_curve |

---

## 4) æ´è§æ±‡åˆï¼ˆå¤šå®éªŒ â†’ å…±è¯†ï¼‰

> åªæ”¶å½•"ä¼šæ”¹å˜å†³ç­–"çš„æ´è§ï¼Œå»ºè®® 5â€“8 æ¡ã€‚

| # | æ´è§ï¼ˆæ ‡é¢˜ï¼‰ | è§‚å¯Ÿï¼ˆWhatï¼‰ | è§£é‡Šï¼ˆWhyï¼‰ | å†³ç­–å½±å“ï¼ˆSo whatï¼‰ | è¯æ® |
|---|-------------|-------------|-------------|-------------------|------|
| I1 | **âš ï¸ æ¶æ„å®¹é‡æ˜¯å½“å‰ç“¶é¢ˆ** | 500kâ†’1M: ViT +0.002 vs LightGBM +0.040 | p16_h256_L6 å®¹é‡å·²æ»¡ï¼Œæ— æ³•åˆ©ç”¨æ›´å¤šæ•°æ® | **æ€§èƒ½ç“¶é¢ˆä¸å†æ˜¯ dataï¼Œè€Œæ˜¯ model size** | exp_vit_scaling_curve |
| I2 | **ViT åœ¨ 100k é¦–è¶…ä¼ ç»Ÿ ML** | 100k: ViT=0.596 > LightGBM=0.553 | Transformer éœ€è¦è¶³å¤Ÿæ•°æ®å­¦ä¹  attention | 100k æ˜¯ ViT ä¼˜åŠ¿æ‹ç‚¹ | exp_vit_scaling_curve |
| I3 | **ViT scaling æ–œç‡ 2.2Ã— LightGBM** | 50kâ†’1M: ViT +0.277 vs LightGBM +0.126 | è‡ªæ³¨æ„åŠ›æ›´å—ç›Šäºå¤šæ ·åŒ–æ•°æ® | å¤§æ•°æ®åœºæ™¯ä¼˜å…ˆé€‰ ViT | exp_vit_scaling_curve |
| I4 | **æ¶æ„é€‰æ‹©æ”¶æ•›ä½†éœ€ scale up** | p16_h256_L6 åœ¨ sweep ä¸­æœ€ä¼˜ï¼Œä½†å·²é¥±å’Œ | å¹³è¡¡ token æ•°é‡å’Œå®¹é‡ | éœ€æ›´å¤§æ¨¡å‹çªç ´ | exp_vit_sweep_analysis |
| I5 | **RÂ² å°ºåº¦ä¸å˜** | å½’ä¸€åŒ–ç©ºé—´å’ŒåŸå§‹ç©ºé—´ RÂ² ä¸€è‡´ | æ•°å­¦æ€§è´¨ | å¯ç›´æ¥ä¸ baseline æ¯”è¾ƒ | note_r2_alignment |
| I6 | **âœ… ViT åœ¨ SNR~5 é€¼è¿‘ ceiling** | gap=0.13 @ mag=22.0 (ViT=0.68 vs ceiling=0.698) | æ¨¡å‹å·²æå–å¤§éƒ¨åˆ†å¯ç”¨ä¿¡æ¯ | **ViT æ¥è¿‘ç‰©ç†æé™** | r2_vs_snr_ceiling |
| I7 | **On-the-fly noise ç­‰æ•ˆå¢å¼º** | æ¯ epoch ä¸åŒå™ªå£°å®ä¾‹ | 200ep â‰ˆ 200x æ•°æ®å¢å¼º | noise_level=1.0 å¯è¡Œ | exp_vit_1m_scaling |
| I8 | **âœ… Transformer ä¼˜åŠ¿æ˜¾è‘—** | ViT (0.711) > LightGBM (0.614) (+16%) | è‡ªæ³¨æ„åŠ›æ•æ‰å…¨å±€å…‰è°±ä¾èµ– | **è®ºæ–‡ baseline æ¯”è¾ƒå®Œæˆ** | exp_vit_scaling_curve |
| I9 | **SNR æ¡ä»¶ä¸‹çš„æ€§èƒ½åˆ†å±‚** | é«˜ SNR (magâ‰¤21) RÂ²â‰ˆ0.90, ä½ SNR (mag>22.5) RÂ²â†’0 | ç‰©ç†ä¿¡æ¯é‡éš SNR é˜¶æ¢¯ä¸‹é™ | æŒ‰ SNR åˆ†æ¡¶è¯„ä¼°æ›´å…¬å¹³ | r2_vs_snr_ceiling |
| I10 | **ViT Ïƒ ä»‹äºåŒ Fisher åŒ…ç»œä¹‹é—´** | Ïƒ_VIT=0.64 åœ¨ Ïƒ_21.5=0.43 ä¸ Ïƒ_22.5=1.11 ä¹‹é—´ | æµ‹è¯•é›† mag=20.5-22.5 çš„ CRLB èŒƒå›´ | ç›¸å¯¹ mag=21.5 æé™æœ‰ ~50% headroom | exp_fisher_residual_overlay |

---

## 5) å†³ç­–ç©ºç™½ï¼ˆDecision Gapsï¼‰

> å†™"è¦å›ç­”ä»€ä¹ˆ"ï¼Œä¸å†™"æ€ä¹ˆåšå®éªŒ"ã€‚å»ºè®® 3â€“6 æ¡ã€‚

| DG | æˆ‘ä»¬ç¼ºçš„ç­”æ¡ˆ | ä¸ºä»€ä¹ˆé‡è¦ï¼ˆä¼šæ”¹å“ªä¸ªå†³ç­–ï¼‰ | ä»€ä¹ˆç»“æœèƒ½å…³é—­å®ƒ | å†³ç­–è§„åˆ™ |
|----|-------------|------------------------|----------------|---------|
| âœ… ~~DG1~~ | ~~1M 200ep æœ€ç»ˆ Test æŒ‡æ ‡~~ | ~~è®ºæ–‡ä¸»ç»“æœ~~ | âœ… RÂ²_test=0.711 | **å·²å…³é—­** - ä¸»ç»“æœå°±ç»ª |
| âœ… ~~DG2~~ | ~~LightGBM 1M åŒå£å¾„å¯¹æ¯”~~ | ~~è¯æ˜ Transformer ä¼˜åŠ¿~~ | âœ… ViT=0.711 > LightGBM=0.614 (+16%) | **å·²å…³é—­** - ä¼˜åŠ¿ç¡®ç«‹ |
| âœ… ~~DG3~~ | ~~Scaling curve (Nâ†’performance)~~ | ~~è®ºæ–‡ Fig 2~~ | âœ… 100k é¦–è¶… LightGBMï¼Œæ–œç‡ 2.2Ã— | **å·²å…³é—­** - scaling å™äº‹å®Œæˆ |
| ğŸ”´ **DG4** | **æ›´å¤§æ¶æ„èƒ½å¦çªç ´é¥±å’Œï¼Ÿ** | å†³å®šæ˜¯å¦ scale model æˆ–è½¬å‘å…¶ä»–ç­–ç•¥ | L8-12, h512 @ 1M æ•°æ® | If Î”RÂ²>0.02 â†’ scale æœ‰æ•ˆ; Else MoE/CNN |
| DG5 | Tokenization ablation | è®ºæ–‡ Table 2 ablation è¡¨ | C1D/SW/patch/overlap | ğŸŸ¡ P1 å¾…å®Œæˆ |
| ~~DG6~~ | ~~Gap æ¥æºåˆ†æ~~ | ~~æŒ‡å¯¼ä¸‹ä¸€æ­¥ä¼˜åŒ–~~ | ViT å·²é€¼è¿‘ ceiling @ mag=22.0 | **å·²å…³é—­** - gap ä¸»è¦æ¥è‡ªç‰©ç†ä¿¡æ¯é‡ |

---

## 6) è®¾è®¡åŸåˆ™ï¼ˆå¯å¤ç”¨è§„åˆ™ï¼‰

### 6.1 å·²ç¡®è®¤åŸåˆ™

| # | åŸåˆ™ | å»ºè®®ï¼ˆåš/ä¸åšï¼‰ | é€‚ç”¨èŒƒå›´ | è¯æ® |
|---|------|---------------|---------|------|
| P1 | **ViT éœ€è¦ 100k+ æ•°æ®æ‰èƒ½è¶…è¶Šä¼ ç»Ÿ ML** | âœ… å¿…é¡» | å…‰è°±å›å½’ | exp_vit_scaling_curve |
| P2 | **500k åå½“å‰æ¶æ„é¥±å’Œï¼Œéœ€ scale model** | âš ï¸ ç“¶é¢ˆè½¬ç§» | p16_h256_L6 å·²æ»¡ | exp_vit_scaling_curve |
| P3 | **patch_size=16 æœ€ä¼˜** | âœ… æ¨è | 4096-dim å…‰è°± | exp_vit_sweep_analysis |
| P4 | **hidden_size=256 > 384ï¼ˆå½“å‰è§„æ¨¡ï¼‰** | âœ… æ¨è | é¿å…è¿‡æ‹Ÿåˆ | sweep åˆ†æ |
| P5 | **noise_level=1.0 on-the-fly** | âœ… æ¨è | æ•°æ®å¢å¼º | exp_vit_1m_scaling |
| P6 | **Heteroscedastic loss ä¸é€‚ç”¨** | âŒ ä¸æ¨è | flux error â‰  label error | exp_vit_1m_scaling |

### 6.2 å¾…éªŒè¯åŸåˆ™

| # | åŸåˆ™ | åˆæ­¥å»ºè®® | éœ€è¦éªŒè¯ï¼ˆMVP/Gateï¼‰ |
|---|------|---------|-------------------|
| P6 | C1D ä¼˜äº SW | å¾…éªŒè¯ | MVP-ABL-1 |
| P7 | L1 æ¯” MSE æ›´é²æ£’ | å¾…éªŒè¯ | Run 1 vs Run 2 |
| P8 | PIPE ä¼˜äº learned PE | æœªçŸ¥ | éœ€è¦ ablation |

### 6.3 å…³é”®æ•°å­—é€ŸæŸ¥ï¼ˆåªç•™ä¼šåå¤ç”¨åˆ°çš„ï¼‰

| æŒ‡æ ‡ | å€¼ | æ¡ä»¶ | æ¥æº |
|------|-----|------|------|
| **ViT RÂ² (test)** | **0.711** | 1M/10k, p16_h256_L6 | exp_vit_scaling_curve |
| ViT @ 500k | 0.709 | 500k/10k | exp_vit_scaling_curve |
| ViT @ 100k | 0.596 | 100k/10k, é¦–è¶… LightGBM | exp_vit_scaling_curve |
| **500kâ†’1M Î”RÂ²** | **+0.002 âš ï¸** | æ¶æ„é¥±å’Œè¯æ® | exp_vit_scaling_curve |
| **LightGBM RÂ²** | **0.614** | 1M/10k, raw input | r2_vs_snr_ceiling |
| LightGBM 500kâ†’1M | +0.040 | ä»æœ‰æå‡ | exp_vit_scaling_curve |
| TemplateFit RÂ² | 0.404 | ä¼ ç»Ÿæ–¹æ³• | r2_vs_snr_ceiling |
| **ViT vs LightGBM** | **+0.097 (+16%)** | @ 1M | è®¡ç®— |
| **ViT scaling æ–œç‡** | **2.2Ã— LightGBM** | 50kâ†’1M | exp_vit_scaling_curve |
| **Fisher 5D ceiling** | **RÂ²_max=0.874** | mag=21.5, SNR=7.1 | Fisher hub |
| Gap @ mag=21.5 | 0.163 | ceiling - ViT | è®¡ç®— |
| **Gap @ mag=22.0** | **0.13** | ViT é€¼è¿‘ ceiling | r2_vs_snr_ceiling |
| æœ€ä¼˜ patch_size | 16 | sweep 21 runs | exp_vit_sweep_analysis |
| æœ€ä¼˜ hidden_size | 256 | å½“å‰æ¶æ„ | exp_vit_sweep_analysis |
| å‚æ•°é‡ | ~4.9M | p16_h256_L6 | exp_vit_1m_scaling |
| **Ïƒ_VIT (RMSE)** | **0.64** | 1M/10k test | exp_fisher_residual_overlay |
| Ïƒ_Fisher @ mag=21.5 | 0.43 | CRLB ç†è®ºä¸‹ç•Œ | Fisher 5D |
| Ïƒ_Fisher @ mag=22.5 | 1.11 | CRLB ç†è®ºä¸‹ç•Œ | Fisher 5D |

#### Per-SNR RÂ² é€ŸæŸ¥ï¼ˆæ¥è‡ªä¸»å›¾ï¼‰

| Magnitude | SNR | ViT RÂ² | LightGBM RÂ² | Ceiling RÂ² | ViT Gap |
|-----------|-----|--------|-------------|------------|---------|
| 18.0 | 87 | ~0.99 | ~0.84 | 0.999 | ~0.01 |
| 20.0 | 24 | 0.90 | 0.87 | 0.989 | 0.09 |
| 21.5 | 7.1 | 0.80 | 0.74 | 0.874 | 0.07 |
| 22.0 | 4.6 | 0.68 | 0.60 | 0.698 | **0.02** |
| 22.5 | 3.0 | 0.52 | 0.42 | 0.265 | ViT>ceiling* |
| 23.0 | 1.9 | ~0.46 | ~0.36 | 0.000 | N/A |

*æ³¨ï¼šmag=22.5 å¤„ ViT (0.52) > 5D median ceiling (0.265)ï¼Œå› ä¸º ceiling æ˜¯ medianï¼Œå­˜åœ¨é«˜åˆ†ä½åŒºåŸŸ

### 6.4 å·²å…³é—­æ–¹å‘ï¼ˆé¿å…é‡å¤è¸©å‘ï¼‰

| æ–¹å‘ | å¦å®šè¯æ® | å…³é—­åŸå›  | æ•™è®­ |
|------|---------|---------|------|
| ~~å°æ•°æ® ViT~~ | 50k RÂ²=0.434 < LightGBM 0.488 | Transformer éœ€è¦å¤§æ•°æ® | å…ˆ scale data åˆ° 100k+ |
| ~~ç»§ç»­å¢åŠ  data (>500k) ç”¨å½“å‰æ¶æ„~~ | 500kâ†’1M +0.002 | æ¶æ„å®¹é‡å·²æ»¡ | **å…ˆ scale model å† scale data** |
| ~~Heteroscedastic loss~~ | flux error â‰  label | ç‰©ç†ä¸å¯¹åº” | åªå¯¹ flux é€‚ç”¨ |
| ~~hidden_size=384 @ p16_L6~~ | æ¯” 256 å·® | å½“å‰æ¶æ„ä¸‹è¿‡æ‹Ÿåˆ | éœ€é…åˆæ›´å¤§ L æ•° |

---

## 7) æŒ‡é’ˆï¼ˆè¯¦ç»†ä¿¡æ¯åœ¨å“ªï¼‰

| ç±»å‹ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| ğŸ—ºï¸ Roadmap | `./vit_roadmap_20251227.md` | Decision Gates + MVP æ‰§è¡Œ |
| ğŸ“— **Exp Scaling Curve** | `./exp/exp_vit_scaling_curve_20251227.md` | âœ… **ViT scaling å®éªŒ**ï¼š100k é¦–è¶… LightGBMï¼Œ500k åé¥±å’Œ |
| ğŸ“— Exp 1M Scaling | `./exp/exp_vit_1m_scaling_20251226.md` | 1M è®­ç»ƒä¸»å®éªŒ |
| ğŸ“— Exp Sweep | `./exp/exp_vit_sweep_analysis_20251227.md` | æ¶æ„ sweep åˆ†æ |
| ğŸ“ Note RÂ² Alignment | `./exp/note_r2_alignment_20251226.md` | RÂ² è®¡ç®—å¯¹é½éªŒè¯ |
| ğŸ“Š **Scaling Curve å›¾** | `./exp/img/vit_scaling_curve.png` | âœ… **è®ºæ–‡ Fig 2ï¼šViT vs LightGBM vs Ridge** |
| ğŸ“— **Exp Fisher Residual Overlay** | `./exp/exp_fisher_residual_overlay_20251228.md` | âœ… **Parity+Residual å åŠ  Fisher CRLB åŒåŒ…ç»œ** |
| ğŸ§  Fisher Hub | `../scaling/fisher_hub_20251225.md` | ç†è®ºä¸Šé™åˆ†æ |
| ğŸ§  Scaling Hub | `../scaling/scaling_hub_20251222.md` | ä¼ ç»Ÿ ML scaling å®éªŒ |
| ğŸ“Š **æ ¸å¿ƒå›¾è¡¨** | `../scaling/exp/img/r2_vs_snr_ceiling_test_10k_unified_snr.png` | âœ… **è®ºæ–‡ Fig 1** |
| ğŸ“„ Paper Draft | `../../paper/vit/specvit_paper.md` | è®ºæ–‡éª¨æ¶ |

---

## 8) å˜æ›´æ—¥å¿—ï¼ˆåªè®°å½•"çŸ¥è¯†æ”¹å˜"ï¼‰

| æ—¥æœŸ | å˜æ›´ | å½±å“ |
|------|------|------|
| 2025-12-27 | åˆ›å»º ViT Hub | - |
| 2025-12-27 | æ•´åˆ 1M scaling + sweep å®éªŒç»“è®º | æ¶æ„é€‰æ‹©æ”¶æ•› |
| 2025-12-27 | é“¾æ¥ Fisher ceiling åˆ†æ | ç†è®ºä¸Šé™ä½œä¸ºè®ºæ–‡å–ç‚¹ |
| 2025-12-27 | âœ… P0 å®Œæˆï¼š1M test æŒ‡æ ‡ RÂ²=0.698 | è®ºæ–‡ä¸»ç»“æœå°±ç»ª |
| 2025-12-27 | âœ… P0 å®Œæˆï¼šViT(0.698) > LightGBM(0.614) | Transformer ä¼˜åŠ¿ç¡®ç«‹ |
| 2025-12-27 | é›†æˆ r2_vs_snr_ceiling ä¸»å›¾ | è®ºæ–‡ Fig 1 æ ¸å¿ƒå›¾è¡¨å°±ç»ª |
| 2025-12-27 | æ›´æ–° 5D ceiling=0.874 (é 0.89) | ä½¿ç”¨æ­£ç¡®çš„ 5D upper bound |
| 2025-12-27 | å‘ç° ViT @ mag=22.0 é€¼è¿‘ ceiling (gap=0.13) | ViT æ¥è¿‘ç‰©ç†æé™ |
| **2025-12-28** | **âš ï¸ é‡å¤§å…±è¯†æ›´æ–°ï¼šæ¶æ„å®¹é‡é¥±å’Œ** | 500kâ†’1M ä»… +0.002ï¼Œç“¶é¢ˆä» data è½¬ç§»åˆ° model size |
| **2025-12-28** | **æ›´æ–°æœ€ä½³ RÂ²=0.711**ï¼ˆæ¥è‡ª exp_vit_scaling_curveï¼‰ | æ¯”ä¹‹å‰ 0.698 æ›´å‡†ç¡® |
| **2025-12-28** | **æ–°å¢ K2ï¼šæ¶æ„é¥±å’Œï¼ŒK7ï¼šscaling æ–œç‡ 2.2Ã—** | æ ¸å¿ƒå…±è¯†é‡æ„ |
| **2025-12-28** | **P0 æ›´æ–°ï¼šæ›´å¤§æ¶æ„å®éªŒ (L8-12, h512)** | ä¸‹ä¸€æ­¥æ–¹å‘ä» data è½¬å‘ model |
| 2025-12-28 | æ–°å¢ Fisher Residual Overlay å¯è§†åŒ– | ViT Ïƒ=0.64 ä»‹äº mag=21.5 (Ïƒ=0.43) å’Œ mag=22.5 (Ïƒ=1.11) ä¹‹é—´ï¼Œ50% headroom |

<details>
<summary><b>é™„å½•ï¼šè®ºæ–‡æ ¸å¿ƒå›¾è¡¨è§„åˆ’</b></summary>

### è®ºæ–‡å¿…éœ€å›¾è¡¨

| # | å›¾è¡¨ | å†…å®¹ | ä½œç”¨ | çŠ¶æ€ |
|---|------|------|------|------|
| 1 | **RÂ² vs SNR (ä¸»å›¾)** | ViT vs LightGBM vs TemplateFit vs Fisher ceiling | æ ¸å¿ƒç»“æœ | âœ… å·²å®Œæˆ |
| 2 | **Scaling curve** | N â†’ performance (50kâ†’1M) | è®ºæ–‡ Fig 2ï¼Œå±•ç¤º ViT scaling ä¼˜åŠ¿ | âœ… **å·²å®Œæˆ**ï¼ˆexp_vit_scaling_curveï¼‰ |
| 3 | **Pipeline å›¾** | Tokenization â†’ Encoder â†’ Head | æ–¹æ³•è¯´æ˜ | â³ å¾…ç”» |
| 4 | **Ablation è¡¨** | patch/overlap/C1D-SW/PE | è®¾è®¡éªŒè¯ | â³ å¾…å®Œæˆ |
| 5 | **Fisher Residual Overlay** | Parity + Residual + Histogram w/ dual CRLB | è¯¯å·® vs ç†è®ºä¸‹ç•Œ | âœ… **å·²å®Œæˆ** |

### æ•°æ®æ¥æº

| å›¾è¡¨ | æ•°æ®æ¥æº | çŠ¶æ€ |
|------|---------|------|
| RÂ² vs SNR | `r2_vs_snr_ceiling_test_10k_unified_snr.png` | âœ… **å·²å®Œæˆ** |
| Scaling curve | `vit_scaling_curve.png`ï¼ˆexp_vit_scaling_curveï¼‰ | âœ… **å·²å®Œæˆ** - ViT vs LightGBM vs Ridge |
| Ablation | éœ€è¦ ablation runs | â³ P1 |

### âœ… è®ºæ–‡ Fig 1 é¢„è§ˆ

**è·¯å¾„**: `logg/scaling/exp/img/r2_vs_snr_ceiling_test_10k_unified_snr.png`

**æ ¸å¿ƒä¿¡æ¯**:
- **ViT RÂ²=0.698** (overall) - é»„è‰²è±å½¢
- **LightGBM RÂ²=0.614** (overall) - ç»¿è‰²æ–¹å—
- **TemplateFit RÂ²=0.404** (overall) - çº¢è‰²ä¸‰è§’
- **Fisher/CRLB 5D Median** - è“è‰²åœ†ç‚¹ (ç†è®ºä¸Šé™)
- **Gap @ SNR=5**: 0.13 (ViT é€¼è¿‘ ceiling)

**å…³é”®å–ç‚¹**:
1. ViT åœ¨æ‰€æœ‰ SNR åŒºé—´æŒç»­ä¼˜äºä¼ ç»Ÿæ–¹æ³•
2. åœ¨ mag=22.0 (SNR~5) å¤„ï¼ŒViT å‡ ä¹è§¦åŠç†è®º ceiling
3. ç†è®ºä¸Šé™æ›²çº¿ä¸º Ceilingâ€“Gapâ€“Structure å™äº‹æä¾›ç‰©ç†é”šç‚¹

</details>
