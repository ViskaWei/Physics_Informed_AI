# ğŸ“˜ å­å®éªŒæŠ¥å‘Šï¼šCNN Dilated/Large Kernel ç³»ç»Ÿæ€§å®éªŒ

---
> **å®éªŒåç§°ï¼š** CNN Kernel Size & Dilation ç³»ç»Ÿæ€§å¯¹æ¯”  
> **å¯¹åº” MVPï¼š** MVP-0.x (Sanity Check) + MVP-1.x (å…¨è°± CNN)  
> **ä½œè€…ï¼š** Viska Wei  
> **æ—¥æœŸï¼š** 2025-12-01  
> **æ•°æ®ç‰ˆæœ¬ï¼š** BOSZ 50k z0 (train 16k / val 1k / test 1k)  
> **æ¨¡å‹ç‰ˆæœ¬ï¼š** 2-Layer CNN, channels=[32, 64]  
> **çŠ¶æ€ï¼š** ğŸ”„ è¿›è¡Œä¸­ (Level 0: 5/5 âœ…, Level 1: 11/28)

---

# ğŸ“‘ ç›®å½•

- [1. ğŸ¯ ç›®æ ‡](#1--ç›®æ ‡)
- [2. ğŸ§ª å®éªŒè®¾è®¡](#2--å®éªŒè®¾è®¡)
- [3. ğŸ“Š å®éªŒå›¾è¡¨](#3--å®éªŒå›¾è¡¨)
- [4. ğŸ’¡ å…³é”®æ´è§](#4--å…³é”®æ´è§)
- [5. ğŸ“ ç»“è®º](#5--ç»“è®º)
- [6. ğŸ“ é™„å½•](#6--é™„å½•)

---

# âš¡ æ ¸å¿ƒç»“è®ºé€Ÿè§ˆï¼ˆä¾› main æå–ï¼‰

> **æœ¬èŠ‚æ˜¯ç»™ main.md æå–ç”¨çš„æ‘˜è¦**

### ä¸€å¥è¯æ€»ç»“

> **CNN å®ç°æ­£ç¡®ï¼ˆåˆæˆä»»åŠ¡ $R^2 > 0.99$ï¼‰ï¼Œåœ¨å…¨è°± $\log g$ ä»»åŠ¡ä¸Šå° kernel (k=9) + é«˜å­¦ä¹ ç‡ (lr=3e-3) è¾¾åˆ°æœ€ä½³ $R^2 = 0.657$ï¼›å¤§ kernel åè€Œæ›´å·®ï¼Œæ„Ÿå—é‡å¢åŠ æ— å¸®åŠ©ã€‚**

### å¯¹å‡è®¾çš„éªŒè¯

| éªŒè¯é—®é¢˜ | ç»“æœ | ç»“è®º |
|---------|------|------|
| H1.1: CNN å®ç°æ­£ç¡®ï¼Ÿ | âœ… $R^2 = 0.996$ (åˆæˆç›®æ ‡) | CNN èƒ½æ­£å¸¸å­¦ä¹  |
| H1.2: å±€éƒ¨çª—å£èƒ½é¢„æµ‹ log_gï¼Ÿ | âŒ $R^2 \approx 0$ (window=256) | å±€éƒ¨çª—å£ä¿¡æ¯ä¸è¶³ |
| H1.3: å¤§ kernel ä¼˜äºå° kernelï¼Ÿ | âŒ k=9 ($R^2=0.66$) > k=63 ($R^2=0.02$) | **å¤§ kernel æ›´å·®** |
| H1.4: Dilated CNN æœ‰æ•ˆï¼Ÿ | â³ d=2 æ•ˆæœå·®ï¼ˆéœ€ lr=3e-3 é‡æµ‹ï¼‰ | å¾…éªŒè¯ |

### è®¾è®¡å¯ç¤ºï¼ˆ1-2 æ¡ï¼‰

| å¯ç¤º | å…·ä½“å»ºè®® |
|------|---------|
| **å­¦ä¹ ç‡æ˜¯å…³é”®** | å° kernel (kâ‰¤9) å¿…é¡»ç”¨ lr=3e-3ï¼›å¤§ kernel ç”¨ lr=1e-3 |
| **å° kernel æ›´ä¼˜** | k=7-9 æ¯” k=21-63 æ•ˆæœå¥½ 5-30 å€ï¼Œå‚æ•°æ›´å°‘ |

### å…³é”®æ•°å­—

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| Sanity Check æœ€ä½³ $R^2$ | 0.996 (åˆæˆç›®æ ‡ï¼Œk=7) |
| å…¨è°±æœ€ä½³ $R^2$ | **0.657** (k=9, lr=3e-3) |
| æœ€ä½³æ„Ÿå—é‡ | RF=25 (k=9, 2å±‚) |
| æœ€ä½³å‚æ•°é‡ | 27K |

---

# 1. ğŸ¯ ç›®æ ‡

## 1.1 å®éªŒç›®çš„

> ä» main.md çš„ MVP è®¾è®¡ä¸­æå–ï¼Œæ˜ç¡®æœ¬å®éªŒè¦å›ç­”çš„å…·ä½“é—®é¢˜ã€‚

**å›ç­”çš„é—®é¢˜**ï¼š
1. CNN åœ¨ 1D å…‰è°±ä¸Šèƒ½å¦å­¦ä¹  $\log g$ï¼Ÿ
2. å¤§ kernel èƒ½å¦é€šè¿‡å¢åŠ æ„Ÿå—é‡æ¥æå‡æ€§èƒ½ï¼Ÿ
3. Dilated CNN èƒ½å¦åœ¨ä¸å¢åŠ å‚æ•°çš„æƒ…å†µä¸‹æ‰©å±•æ„Ÿå—é‡ï¼Ÿ

**å¯¹åº” main.md çš„**ï¼š
- éªŒè¯é—®é¢˜ï¼šQ1-Q6
- å­å‡è®¾ï¼šH1.1, H1.2, H1.3, H1.4, H1.5

## 1.2 é¢„æœŸç»“æœ

| åœºæ™¯ | é¢„æœŸç»“æœ | åˆ¤æ–­æ ‡å‡† |
|------|---------|---------|
| Sanity Checkï¼ˆåˆæˆç›®æ ‡ï¼‰ | $R^2 > 0.9$ | âœ… éªŒæ”¶é€šè¿‡ |
| çª—å£ä»»åŠ¡ | $R^2 \in [0.3, 0.7]$ | éªŒæ”¶é€šè¿‡ |
| å¤§ kernel vs å° kernel | $\Delta R^2 > 0.1$ | å¤§ kernel æœ‰æ•ˆ |
| å…¨è°±æœ€ä½³ | $R^2 > 0.3$ | CNN å¯ç”¨äº $\log g$ |

---

# 2. ğŸ§ª å®éªŒè®¾è®¡

## 2.1 æ•°æ®

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| è®­ç»ƒæ ·æœ¬æ•° | 16,000 |
| éªŒè¯æ ·æœ¬æ•° | 1,000 |
| æµ‹è¯•æ ·æœ¬æ•° | 1,000 |
| å…‰è°±ç»´åº¦ | 4,096 åƒç´  |
| æ ‡ç­¾å‚æ•° | $\log g$ |
| æ•°æ®è·¯å¾„ | `/srv/local/tmp/swei20/data/bosz50000/z0/` |

**å™ªå£°æ¨¡å‹**ï¼š

$$
\text{noisy\_flux} = \text{flux} + \mathcal{N}(0, \sigma^2), \quad \sigma = 0.1
$$

## 2.2 æ•°æ®æ¨¡å¼

| æ¨¡å¼ | è¯´æ˜ | è¾“å…¥ç»´åº¦ |
|------|------|----------|
| `toy_synthetic` | åˆæˆæ ‡ç­¾ $y = 0.3 \times f_{100} + 0.7 \times f_{500}$ | 4096 |
| `toy_window` | ä»å…¨è°±æˆªå–çª—å£ï¼Œé¢„æµ‹çœŸå® $\log g$ | 256/512 |
| `full` | å®Œæ•´å…‰è°±é¢„æµ‹ $\log g$ | 4096 |

## 2.3 æ¨¡å‹ä¸ç®—æ³•

### CNN æ¶æ„

```
Input (4096 or 256) 
  â†’ Conv1D(in=1, out=32, kernel=K, dilation=D, padding=same)
  â†’ ReLU â†’ BatchNorm
  â†’ Conv1D(in=32, out=64, kernel=K, dilation=D, padding=same)  
  â†’ ReLU â†’ BatchNorm
  â†’ AdaptiveAvgPool1D(1)
  â†’ Linear(64, 1)
```

**æ„Ÿå—é‡è®¡ç®—**ï¼š
$$
\text{RF} = 1 + \sum_{l=1}^{L} (k_l - 1) \cdot d_l
$$

## 2.4 è¶…å‚æ•°é…ç½®

| å‚æ•° | èŒƒå›´/å€¼ | è¯´æ˜ |
|------|--------|------|
| Kernel Size (k) | {7, 9, 21, 45, 63} | è¦†ç›–å°åˆ°å¤§ kernel |
| Dilation (d) | {1, 2} | æ‰©å±•æ„Ÿå—é‡ |
| Learning Rate (lr) | {1e-3, 3e-3} | å…³é”®è¶…å‚ |
| Weight Decay | {0, 1e-4} | æ­£åˆ™åŒ– |
| Batch Size | 2048 | å›ºå®š |
| Epochs | 50 | å¸¦ Early Stopping |

## 2.5 è¯„ä»·æŒ‡æ ‡

| æŒ‡æ ‡ | å…¬å¼ | ç”¨é€” |
|------|------|------|
| $R^2$ | $1 - \frac{\sum(y - \hat{y})^2}{\sum(y - \bar{y})^2}$ | ä¸»è¦è¯„ä»·æŒ‡æ ‡ |
| MAE | $\frac{1}{n}\sum\|y - \hat{y}\|$ | ç»å¯¹è¯¯å·®å‚è€ƒ |
| RMSE | $\sqrt{\frac{1}{n}\sum(y - \hat{y})^2}$ | ä¸ $R^2$ é…åˆ |

---

# 3. ğŸ“Š å®éªŒå›¾è¡¨

### å›¾ 1ï¼šæ„Ÿå—é‡ vs Test $R^2$ (lr=3e-3)

```
æ„Ÿå—é‡ (RF) vs Test RÂ² (lr=3e-3):

RF=19  (k=7):  RÂ² = 0.603  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  
RF=25  (k=9):  RÂ² = 0.657  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘ â­ æœ€ä½³
RF=61  (k=21): RÂ² = 0.035  â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
RF=133 (k=45): RÂ² = 0.008  â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
RF=187 (k=63): RÂ² = -0.002 â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
```

**Figure 1. æ„Ÿå—é‡ä¸ Test $R^2$ çš„åå‘å…³ç³»ï¼ˆlr=3e-3 æ—¶ï¼‰**

**å…³é”®è§‚å¯Ÿ**ï¼š
- ğŸ”´ **æ„Ÿå—é‡å¢åŠ  â†’ $R^2$ æ€¥å‰§ä¸‹é™**ï¼ˆä¸é¢„æœŸå®Œå…¨ç›¸åï¼ï¼‰
- â­ æœ€ä½³é…ç½®ï¼šk=9, RF=25, $R^2 = 0.657$
- k=63 (RF=187) ç”šè‡³å‡ºç°è´Ÿ $R^2$

---

### å›¾ 2ï¼šLearning Rate Ã— Kernel Size äº¤äº’æ•ˆåº”

| Kernel | lr=1e-3 | lr=3e-3 | å·®å¼‚ |
|--------|---------|---------|------|
| k=7 | 0.011 | **0.603** | +0.592 â¬†ï¸ |
| k=9 | 0.036 | **0.657** | +0.621 â¬†ï¸ |
| k=21 | **0.391** | 0.035 | -0.356 â¬‡ï¸ |
| k=45 | **0.082** | 0.008 | -0.074 â¬‡ï¸ |
| k=63 | **0.020** | -0.002 | -0.022 â¬‡ï¸ |

**Figure 2. Kernel Size ä¸ Learning Rate å­˜åœ¨å¼ºäº¤äº’æ•ˆåº”**

**å…³é”®è§‚å¯Ÿ**ï¼š
- ğŸ”µ **å° kernel (kâ‰¤9)**ï¼šlr=3e-3 æ›´å¥½ï¼ˆå·® 50-60xï¼‰
- ğŸŸ  **å¤§ kernel (kâ‰¥21)**ï¼šlr=1e-3 æ›´å¥½ï¼ˆä½†æ•´ä½“ä»å·®ï¼‰
- âš ï¸ ä¸åŒ kernel éœ€è¦ä¸åŒ lrï¼Œä¸èƒ½é€šç”¨

---

# 4. ğŸ’¡ å…³é”®æ´è§

## 4.1 å®è§‚å±‚æ´è§

> ç”¨äºæŒ‡å¯¼æ¶æ„è®¾è®¡ã€ç†è§£é—®é¢˜æœ¬è´¨çš„é«˜å±‚æ¬¡å‘ç°ã€‚

1. **æ„Ÿå—é‡å‡è®¾è¢«æ¨ç¿»**ï¼šåŸä»¥ä¸º $\log g$ éœ€è¦å¤§æ„Ÿå—é‡æ•è·é•¿ç¨‹ä¾èµ–ï¼Œå®éªŒæ˜¾ç¤ºå°æ„Ÿå—é‡ (RF=25) åè€Œæœ€ä¼˜ã€‚è¿™æ„å‘³ç€ï¼š
   - $\log g$ ä¿¡æ¯å¯èƒ½ä¸»è¦æ¥è‡ª**å±€éƒ¨ç‰¹å¾çš„ç»„åˆ**ï¼Œè€Œé**è·¨åŒºåŸŸé•¿ç¨‹ä¾èµ–**
   - æˆ–è€…å¤§ kernel å¼•å…¥çš„**å‚æ•°é‡å¢åŠ **å¯¼è‡´è¿‡æ‹Ÿåˆ

2. **CNN èƒ½å­¦ä¹  $\log g$**ï¼šk=9 è¾¾åˆ° $R^2 = 0.657$ï¼Œè™½ç„¶ä¸åŠ LightGBM (0.85+)ï¼Œä½†è¯æ˜ CNN æ¶æ„åœ¨è¯¥ä»»åŠ¡ä¸Šæ˜¯å¯è¡Œçš„ã€‚

## 4.2 æ¨¡å‹å±‚æ´è§

> ç”¨äºä¼˜åŒ–æ¨¡å‹ã€è°ƒå‚çš„ä¸­å±‚æ¬¡å‘ç°ã€‚

1. **å­¦ä¹ ç‡æ˜¯ç¬¬ä¸€é‡è¦è¶…å‚**ï¼šåŒä¸€æ¶æ„ï¼Œlr å·®å¼‚å¯¼è‡´ $R^2$ å·® 10-50 å€ã€‚
   - å° kernel å‚æ•°å°‘ï¼Œéœ€è¦è¾ƒå¤§ lr å¿«é€Ÿæ”¶æ•›
   - å¤§ kernel å‚æ•°å¤šï¼Œéœ€è¦è¾ƒå° lr é˜²æ­¢éœ‡è¡

2. **å‚æ•°æ•ˆç‡**ï¼šk=9 (27K å‚æ•°) è¾¾åˆ° $R^2=0.657$ï¼Œè€Œ k=63 (140K å‚æ•°) åªæœ‰ $R^2=0.02$ã€‚å‚æ•°å¢åŠ  5xï¼Œæ€§èƒ½ä¸‹é™ 30xã€‚

## 4.3 å®éªŒå±‚ç»†èŠ‚æ´è§

> å…·ä½“çš„å®éªŒè§‚å¯Ÿå’ŒæŠ€æœ¯ç»†èŠ‚ã€‚

1. **Sanity Check éªŒè¯**ï¼šåˆæˆä»»åŠ¡ $R^2 > 0.99$ è¯æ˜ CNN å®ç°æ—  bugã€‚

2. **çª—å£ä»»åŠ¡å®Œå…¨å¤±è´¥** ($R^2 \approx 0$)ï¼š256 åƒç´ çª—å£ä¸å«è¶³å¤Ÿ $\log g$ ä¿¡æ¯ï¼Œä¸ TopK å®éªŒç»“è®ºä¸€è‡´ï¼ˆéœ€ K=100+ åˆ†æ•£ç‰¹å¾ï¼‰ã€‚

3. **Dilated CNN åˆæ­¥ç»“æœå·®**ï¼šd=2 + lr=1e-3 çš„ $R^2=0.016$ï¼Œå¯èƒ½éœ€è¦ lr=3e-3 é‡æµ‹ã€‚

---

# 5. ğŸ“ ç»“è®º

## 5.1 æ ¸å¿ƒå‘ç°

> **å° kernel CNN (k=9) + é«˜å­¦ä¹ ç‡ (lr=3e-3) æ˜¯å…¨è°± $\log g$ ä»»åŠ¡çš„æœ€ä¼˜é…ç½®ï¼›å¤§ kernel ä¸ä»…æ— å¸®åŠ©ï¼Œåè€Œä¸¥é‡æŸå®³æ€§èƒ½ã€‚**

**å‡è®¾éªŒè¯**ï¼š
- âŒ åŸå‡è®¾ï¼šå¤§ kernel / å¤§æ„Ÿå—é‡èƒ½æ›´å¥½æ•è· $\log g$ çš„é•¿ç¨‹ä¾èµ–
- âœ… å®éªŒç»“æœï¼šå° kernel (RF=25) æœ€ä¼˜ï¼Œæ„Ÿå—é‡å¢åŠ  â†’ æ€§èƒ½éª¤é™

## 5.2 å…³é”®ç»“è®ºï¼ˆ2-4 æ¡ï¼‰

| # | ç»“è®º | è¯æ® |
|---|------|------|
| 1 | **CNN å®ç°æ­£ç¡®** | åˆæˆä»»åŠ¡ $R^2 = 0.996$ |
| 2 | **å° kernel æœ€ä¼˜** | k=9 ($R^2=0.657$) >> k=63 ($R^2=0.02$) |
| 3 | **lr å†³å®šæˆè´¥** | åŒæ¶æ„ lr å·®å¼‚å¯¼è‡´æ€§èƒ½å·® 50x |
| 4 | **å±€éƒ¨çª—å£ä¿¡æ¯ä¸è¶³** | window=256 ä»»åŠ¡ $R^2 \approx 0$ |

## 5.3 è®¾è®¡å¯ç¤º

### æ¶æ„/æ–¹æ³•åŸåˆ™

| åŸåˆ™ | å»ºè®® | åŸå›  |
|------|------|------|
| **ä½¿ç”¨å° kernel** | k âˆˆ {7, 9, 11}ï¼Œé¿å… k > 15 | å¤§ kernel å‚æ•°çˆ†ç‚¸ä¸”æ€§èƒ½æ›´å·® |
| **ä¼˜å…ˆè°ƒ lr** | å° kernel ç”¨ lr=3e-3ï¼Œå¤§ kernel ç”¨ lr=1e-3 | lr ä¸ kernel size æœ‰å¼ºäº¤äº’ |
| **å…¨å±€æ± åŒ–** | ç”¨ AdaptiveAvgPool è€Œéå¤§æ„Ÿå—é‡ | æ± åŒ–æ¯”å¤§ kernel æ›´é«˜æ•ˆåœ°èšåˆå…¨å±€ä¿¡æ¯ |

### âš ï¸ å¸¸è§é™·é˜±

| å¸¸è§åšæ³• | å®éªŒè¯æ® |
|----------|----------|
| "å¢å¤§æ„Ÿå—é‡èƒ½æå‡æ€§èƒ½" | âŒ RF ä» 25â†’187ï¼Œ$R^2$ ä» 0.66â†’0.02 |
| "ä¸€ä¸ª lr é€šç”¨æ‰€æœ‰æ¶æ„" | âŒ å° kernel ç”¨ lr=1e-3 æ—¶ $R^2$ ä»… 0.01 |

## 5.4 ç‰©ç†è§£é‡Š

> ç”¨é¢†åŸŸçŸ¥è¯†è§£é‡Šä¸ºä»€ä¹ˆä¼šæœ‰è¿™æ ·çš„ç»“æœã€‚

1. **$\log g$ ä¿¡æ¯æ˜¯å±€éƒ¨+èšåˆ**ï¼šå•ä¸ªè°±çº¿å®½åº¦ ~10-50 åƒç´ ï¼Œå° kernel (k=9) è¶³ä»¥æ•è·ã€‚å…¨å±€ç»„åˆé€šè¿‡**æ± åŒ–å±‚**å®Œæˆï¼Œä¸éœ€è¦å·ç§¯æœ¬èº«æœ‰å¤§æ„Ÿå—é‡ã€‚

2. **å¤§ kernel çš„é—®é¢˜**ï¼š
   - å‚æ•°é‡æš´å¢ï¼ˆk=63 æ˜¯ k=7 çš„ 6xï¼‰ï¼Œå®¹æ˜“è¿‡æ‹Ÿåˆ
   - å¤§å·ç§¯æ ¸å­¦ä¹ éš¾åº¦æ›´å¤§ï¼Œéœ€è¦æ›´å¤šæ•°æ®

## 5.5 å…³é”®æ•°å­—é€ŸæŸ¥

| æŒ‡æ ‡ | å€¼ | é…ç½®/æ¡ä»¶ |
|------|-----|----------|
| æœ€ä½³æ€§èƒ½ | **$R^2 = 0.657$** | k=9, lr=3e-3, 27K params |
| æ¬¡ä½³æ€§èƒ½ | $R^2 = 0.603$ | k=7, lr=3e-3, 23K params |
| å¤§ kernel æœ€ä½³ | $R^2 = 0.391$ | k=21, lr=1e-3, 52K params |
| Sanity Check | $R^2 = 0.996$ | åˆæˆç›®æ ‡ |
| vs LightGBM | -0.20 | LightGBM ~0.85 |

## 5.6 ä¸‹ä¸€æ­¥å·¥ä½œ

| æ–¹å‘ | å…·ä½“ä»»åŠ¡ | ä¼˜å…ˆçº§ | å¯¹åº” MVP |
|------|----------|--------|---------|
| Dilated + lr=3e-3 | é‡æµ‹ dilated CNN ç”¨ lr=3e-3 | ğŸ”´ é«˜ | MVP-1.3 |
| æ›´æ·±ç½‘ç»œ | å°è¯• 3-4 å±‚ CNN | ğŸŸ¡ ä¸­ | MVP-1.x |
| Position Encoding | æ·»åŠ ä½ç½®ç¼–ç æµ‹è¯• | ğŸŸ¡ ä¸­ | æ–° MVP |
| ä¸ MLP å¯¹æ¯” | åœ¨åŒç­‰å‚æ•°é‡ä¸‹æ¯”è¾ƒ | ğŸŸ¢ ä½ | MVP-2.x |

---

# 6. ğŸ“ é™„å½•

## 6.1 æ•°å€¼ç»“æœè¡¨

### Level 0: Sanity Check (5 å®éªŒ)

| å®éªŒå | æ•°æ®æ¨¡å¼ | çª—å£ | Kernel | Test $R^2$ | å‚æ•°é‡ | çŠ¶æ€ |
|--------|----------|------|--------|-----------|--------|------|
| L0_A_win256_synthetic | toy_synthetic | 256 | [7,7] | **0.9966** | 18.9K | âœ… æˆåŠŸ |
| L0_B_win512_synthetic | toy_synthetic | 512 | [7,7] | **0.9952** | 18.9K | âœ… æˆåŠŸ |
| L0_C_win256_logg | toy_window | 256 | [7,7] | 0.0005 | 18.9K | âŒ å¤±è´¥ |
| L0_D_win256_logg_lr3e-3 | toy_window | 256 | [7,7] | 0.0009 | 18.9K | âŒ å¤±è´¥ |
| L0_D_win256_logg_lr1e-3 | toy_window | 256 | [7,7] | 0.0000 | 18.9K | âŒ å¤±è´¥ |

### Level 1: å…¨è°± CNN (11/28 å®éªŒï¼ŒæŒ‰ Test $R^2$ æ’åº)

| æ’å | å®éªŒå | Kernel | Dilation | RF | å‚æ•°é‡ | lr | Test $R^2$ | æ—¶é—´ |
|------|--------|--------|----------|-----|--------|-----|-----------|------|
| ğŸ¥‡ 1 | L1_baseline_k9_lr3e-3 | [9,9] | [1,1] | 25 | 27K | 3e-3 | **0.6575** | 1.3m |
| ğŸ¥ˆ 2 | L1_baseline_k7_lr3e-3 | [7,7] | [1,1] | 19 | 23K | 3e-3 | **0.6026** | 1.2m |
| ğŸ¥‰ 3 | L1_large_k21_lr1e-3 | [21,21] | [1,1] | 61 | 52K | 1e-3 | 0.3912 | 1.4m |
| 4 | L1_large_k45_lr1e-3 | [45,45] | [1,1] | 133 | 102K | 1e-3 | 0.0817 | 3.4m |
| 5 | L1_baseline_k9_lr1e-3 | [9,9] | [1,1] | 25 | 27K | 1e-3 | 0.0363 | 1.3m |
| 6 | L1_large_k21_lr3e-3 | [21,21] | [1,1] | 61 | 52K | 3e-3 | 0.0348 | 1.4m |
| 7 | L1_large_k63_lr1e-3 | [63,63] | [1,1] | 187 | 140K | 1e-3 | 0.0203 | 4.5m |
| 8 | L1_dilated_d2_lr1e-3 | [7,7] | [2,2] | 37 | 23K | 1e-3 | 0.0162 | 15.4m |
| 9 | L1_baseline_k7_lr1e-3 | [7,7] | [1,1] | 19 | 23K | 1e-3 | 0.0114 | 1.2m |
| 10 | L1_large_k45_lr3e-3 | [45,45] | [1,1] | 133 | 102K | 3e-3 | 0.0079 | 3.4m |
| 11 | L1_large_k63_lr3e-3 | [63,63] | [1,1] | 187 | 140K | 3e-3 | -0.0023 | 4.5m |

### æ¨¡å‹å¯¹æ¯” (noise=0.1)

| æ¨¡å‹ | Test $R^2$ | å‚æ•°é‡ | è¯´æ˜ |
|------|---------|--------|------|
| LightGBM | ~0.85+ | - | Baseline æœ€ä¼˜ |
| Ridge | ~0.75+ | - | çº¿æ€§ Baseline |
| MLP (best) | ~0.70+ | 1M+ | å…¨è¿æ¥ |
| **CNN k=9** | **0.657** | 27K | æœ¬å®éªŒæœ€ä½³ |

---

## 6.2 å»ºè®®ç»˜å›¾

### 6.2.1 Kernel Size vs $R^2$ æŠ˜çº¿å›¾

- **ç›®çš„**ï¼šå¯è§†åŒ– kernel size ä¸æ€§èƒ½çš„åå‘å…³ç³»
- **X è½´**ï¼šKernel Size (log scale)
- **Y è½´**ï¼šTest $R^2$
- **åˆ†ç»„**ï¼šlr=1e-3 vs lr=3e-3 ä¸¤æ¡çº¿

### 6.2.2 å‚æ•°é‡ vs $R^2$ æ•£ç‚¹å›¾

- **ç›®çš„**ï¼šå±•ç¤ºå‚æ•°æ•ˆç‡
- **X è½´**ï¼šå‚æ•°é‡ (log scale)
- **Y è½´**ï¼šTest $R^2$
- **æ ‡æ³¨**ï¼šæ¯ä¸ªç‚¹æ ‡æ³¨ kernel size

---

## 6.3 ç›¸å…³æ–‡ä»¶

| ç±»å‹ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| ä¸»æ¡†æ¶ | `logg/cnn/cnn_main_20251201.md` | main æ–‡ä»¶ |
| æœ¬æŠ¥å‘Š | `logg/cnn/exp_cnn_dilated_kernel_sweep_20251201.md` | å½“å‰æ–‡ä»¶ |
| å›¾è¡¨ | `logg/cnn/img/` | å®éªŒå›¾è¡¨ |
| åŸå§‹ CSV | `raw_vit/cnn_sanity_check.csv` | Level 0 æ•°æ® |
| åŸå§‹ CSV | `raw_vit/cnn_dilated_window_experiments.csv` | Level 1 æ•°æ® |
| å®éªŒè„šæœ¬ | `scripts/cnn_dilated_experiments.py` | å®éªŒä»£ç  |

---

## 6.4 å®éªŒæ—¥å¿—

| æ—¶é—´ | äº‹ä»¶ | å¤„ç† |
|------|------|------|
| 2025-12-01 | Level 0 å®Œæˆ | åˆæˆä»»åŠ¡é€šè¿‡ï¼Œçª—å£ä»»åŠ¡å¤±è´¥ |
| 2025-12-01 | Level 1 è¿›è¡Œä¸­ | 11/28 å®Œæˆï¼Œå‘ç°å° kernel æœ€ä¼˜ |
| 2025-12-01 | å‘ç° lr äº¤äº’æ•ˆåº” | éœ€è¦åˆ† kernel size è°ƒ lr |

---

## 6.5 å®éªŒç¯å¢ƒ

```yaml
# ç¡¬ä»¶
GPU: NVIDIA V100 (å•å¡)
# è½¯ä»¶
Python: 3.x (viska-torch-3 ç¯å¢ƒ)
PyTorch: 2.x
# æ•°æ®
æ•°æ®è·¯å¾„: /srv/local/tmp/swei20/data/bosz50000/z0/
è®­ç»ƒé›†: train_32k (ä½¿ç”¨ 16k)
éªŒè¯é›†: val_1k
æµ‹è¯•é›†: test_1k
```

---

## 6.6 ç»§ç»­å®éªŒå‘½ä»¤

```bash
# tmux ä¸­è¿è¡Œ
tmux new -s cnn_exp
source /srv/local/tmp/swei20/miniconda3/etc/profile.d/conda.sh
conda activate viska-torch-3
cd /home/swei20/VIT
python scripts/cnn_dilated_experiments.py --level 1 --gpu 0

# åˆ†ç¦»: Ctrl+B, D
# é‡è¿: tmux attach -t cnn_exp
```

---

*ç”Ÿæˆæ—¶é—´: 2025-12-01*  
*å®éªŒè¿›åº¦: Level 0 å®Œæˆ (5/5), Level 1 è¿›è¡Œä¸­ (11/28)*

