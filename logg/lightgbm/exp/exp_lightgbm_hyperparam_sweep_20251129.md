# ğŸ“˜ Experiment Report: LightGBM è¶…å‚æ•°æœç´¢

---
> **Name:** LightGBM è¶…å‚æ•°ç½‘æ ¼æœç´¢ ($\log g$ é¢„æµ‹)  
> **ID:** `VIT-20251129-lgb-hyperparam-01`  
> **Topic ï½œ MVP:** `VIT` / `lightgbm` ï½œ MVP-0.1  
> **Author:** Viska Wei  
> **Date:** 2025-11-29  
> **Status:** âœ… Completed

---

## ğŸ”— Upstream Links

| Type | Link | Description |
|------|------|-------------|
| ğŸ§  Hub | [`lightgbm_hub_20251130.md`](../lightgbm_hub_20251130.md) | æ™ºåº“å¯¼èˆª |
| ğŸ—ºï¸ Roadmap | [`lightgbm_roadmap_20251130.md`](../lightgbm_roadmap_20251130.md) | å®éªŒè¿½è¸ª |
| ğŸ“‹ Kanban | [`../../status/kanban.md`](../../status/kanban.md) | å®éªŒé˜Ÿåˆ— |

---

# ğŸ“‘ Table of Contents

- [âš¡ Key Findings](#-æ ¸å¿ƒç»“è®ºé€Ÿè§ˆ)
- [1. ğŸ¯ Objective](#1--ç›®æ ‡)
- [2. ğŸ§ª Experiment Design](#2--å®éªŒè®¾è®¡)
- [3. ğŸ“Š Figures & Results](#3--å®éªŒå›¾è¡¨)
- [4. ğŸ’¡ Insights](#4--å…³é”®æ´è§)
- [5. ğŸ“ Conclusions](#5--ç»“è®º)
- [6. ğŸ“ Appendix](#6--é™„å½•)

---

## âš¡ æ ¸å¿ƒç»“è®ºé€Ÿè§ˆ

### ä¸€å¥è¯æ€»ç»“

> **LightGBM åœ¨ $\log g$ é¢„æµ‹ä¸­ï¼Œ`learning_rate` æ˜¯æœ€å…³é”®è¶…å‚æ•°ï¼ˆç›¸å…³ç³»æ•° +0.491ï¼‰ï¼Œæœ€ä¼˜é…ç½®å¯åœ¨ 37s å†…è¾¾åˆ° $R^2=0.9976$ï¼Œæè‡´é…ç½®è¾¾ $R^2=0.9982$ã€‚**

### å¯¹å‡è®¾çš„éªŒè¯

| éªŒè¯é—®é¢˜ | ç»“æœ | ç»“è®º |
|---------|------|------|
| `learning_rate` æ˜¯å¦æœ€å…³é”®ï¼Ÿ | âœ… +0.491 | æ˜¯ï¼Œè¿œé«˜äºå…¶ä»–å‚æ•° |
| `num_leaves` æ˜¯å¦å­˜åœ¨æœ€ä¼˜åŒºé—´ï¼Ÿ | âœ… 31-128 æœ€ä¼˜ | 256 ä¸‹é™ï¼Œè¿‡æ‹Ÿåˆå­˜åœ¨ |
| èƒ½å¦è¾¾åˆ° $R^2 \geq 0.998$ï¼Ÿ | âœ… 0.9982 | éªŒè¯æˆåŠŸ |

### è®¾è®¡å¯ç¤º

| å¯ç¤º | å…·ä½“å»ºè®® |
|------|---------|
| **é»˜è®¤é…ç½®** | `n_est=1000, leaves=31, depth=7, lr=0.05` |
| **é¿å…è¿‡æ‹Ÿåˆ** | ä¸è¦ä½¿ç”¨ `num_leaves > 128` |

### å…³é”®æ•°å­—

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| æœ€ä¼˜ $R^2$ | **0.9982** (n=2000, leaves=31, depth=7, lr=0.05) |
| æ€§ä»·æ¯”æœ€ä¼˜ | **0.9975** in 25s |
| æ¨èé»˜è®¤ | **0.9976** in 37s |
| `lr` ä¸ $R^2$ ç›¸å…³ç³»æ•° | **+0.491** |

---

# 1. ğŸ¯ ç›®æ ‡

## 1.1 å®éªŒç›®çš„

**æ ¸å¿ƒé—®é¢˜**ï¼šLightGBM çš„æœ€ä¼˜è¶…å‚æ•°é…ç½®æ˜¯ä»€ä¹ˆï¼Ÿ

**å›ç­”çš„é—®é¢˜**ï¼š
- `learning_rate`ã€`num_leaves`ã€`max_depth`ã€`n_estimators` å„è‡ªå¯¹æ€§èƒ½çš„å½±å“æœ‰å¤šå¤§ï¼Ÿ
- æ˜¯å¦å­˜åœ¨æ˜ç¡®çš„æ•ˆç‡-æ€§èƒ½ Pareto æœ€ä¼˜å‰æ²¿ï¼Ÿ
- æœ€ä¼˜é…ç½®èƒ½å¦è¾¾åˆ° $R^2 \geq 0.998$ï¼Ÿ

**å¯¹åº”å‡è®¾**ï¼š
- H1.1: learning_rate æ˜¯æœ€æ•æ„Ÿè¶…å‚æ•°
- H1.2: æ¨¡å‹å¤æ‚åº¦å­˜åœ¨æœ€ä¼˜åŒºé—´

## 1.2 é¢„æœŸç»“æœ

| åœºæ™¯ | é¢„æœŸç»“æœ | åˆ¤æ–­æ ‡å‡† |
|------|---------|---------|
| æ­£å¸¸æƒ…å†µ | $R^2 \geq 0.998$ | éªŒæ”¶é€šè¿‡ |
| å‘ç°æœ€ä¼˜ lr | lr=0.05 æˆ– 0.1 | éæç«¯å€¼ |
| å‘ç°è¿‡æ‹Ÿåˆ | num_leaves=256 æ€§èƒ½ä¸‹é™ | å¤æ‚åº¦ä¸Šé™å­˜åœ¨ |

---

# 2. ğŸ§ª å®éªŒè®¾è®¡

## 2.1 æ•°æ®

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| è®­ç»ƒæ ·æœ¬æ•° | ~25,600 (80% of 32K) |
| éªŒè¯æ ·æœ¬æ•° | ~3,200 (10%) |
| æµ‹è¯•æ ·æœ¬æ•° | ~3,200 (10%) |
| ç‰¹å¾ç»´åº¦ | 4096 (å…¨å…‰è°±) |
| æ ‡ç­¾å‚æ•° | $\log g$ |
| å™ªå£° | æ—  ($\sigma = 0$) |

## 2.2 æ¨¡å‹ä¸ç®—æ³•

### LightGBM (Gradient Boosting Decision Tree)

$$
\hat{y} = \sum_{m=1}^{M} f_m(x), \quad f_m \in \mathcal{F}
$$

å…¶ä¸­ $M$ ä¸ºæ ‘çš„æ•°é‡ (`n_estimators`)ï¼Œ$\mathcal{F}$ ä¸ºå›å½’æ ‘ç©ºé—´ã€‚

## 2.3 è¶…å‚æ•°æœç´¢ç©ºé—´

| è¶…å‚æ•° | æœç´¢èŒƒå›´ | å€™é€‰å€¼æ•°é‡ |
|--------|----------|------------|
| `n_estimators` | [1000, 2000] | 2 |
| `num_leaves` | [8, 16, 31, 64, 128, 256] | 6 |
| `max_depth` | [3, 5, 7, 10, -1] | 5 |
| `learning_rate` | [0.01, 0.05, 0.1] | 3 |
| **æ€»ç»„åˆæ•°** | $2 \times 6 \times 5 \times 3$ | **180** |

---

# 3. ğŸ“Š å®éªŒå›¾è¡¨

### å›¾ 1ï¼šè¯¯å·® vs æ¨¡å‹å¤§å°
![å›¾ç‰‡](../img/1_error_vs_model_size.png)

**å…³é”®è§‚å¯Ÿ**ï¼šæ€»å¶å­æ•°åœ¨ 30K-100K åŒºé—´æ€§èƒ½æœ€ä¼˜ï¼Œè¶…è¿‡ 100K åè¾¹é™…æ”¶ç›Šé€’å‡ã€‚

---

### å›¾ 2ï¼šè¯¯å·® vs è¶…å‚æ•°
![å›¾ç‰‡](../img/2_error_vs_hyperparams.png)

**å…³é”®è§‚å¯Ÿ**ï¼š`learning_rate=0.01` çš„è¯¯å·®æ˜¾è‘—é«˜äºå…¶ä»–å€¼ï¼›`num_leaves=256` å‡ºç°æ€§èƒ½ä¸‹é™ã€‚

---

### å›¾ 3ï¼šè¶…å‚æ•°çƒ­åŠ›å›¾
![å›¾ç‰‡](../img/3_hyperparameter_heatmap.png)

**å…³é”®è§‚å¯Ÿ**ï¼šé»„è‰²åŒºåŸŸï¼ˆé«˜ $R^2$ï¼‰é›†ä¸­åœ¨ `lr=0.05/0.1` è¡Œï¼Œ`num_leaves=31-64` åˆ—ã€‚

---

### å›¾ 4ï¼šæ•ˆç‡ vs æ€§èƒ½
![å›¾ç‰‡](../img/4_efficiency_vs_performance.png)

**å…³é”®è§‚å¯Ÿ**ï¼šPareto æœ€ä¼˜é…ç½®å½¢æˆæ¸…æ™°çš„å‰æ²¿çº¿ï¼Œ50-70 ç§’æ˜¯ sweet spotã€‚

---

### å›¾ 5ï¼šæ¨¡å‹å¤§å° vs è®­ç»ƒæ—¶é—´
![å›¾ç‰‡](../img/5_model_size_vs_time.png)

**å…³é”®è§‚å¯Ÿ**ï¼šè®­ç»ƒæ—¶é—´ä¸æ€»å¶å­æ•°è¿‘ä¼¼çº¿æ€§å…³ç³»ã€‚

---

### å›¾ 6ï¼šæ”¶ç›Šé€’å‡æ›²çº¿
![å›¾ç‰‡](../img/6_time_vs_r2_diminishing_returns.png)

**å…³é”®è§‚å¯Ÿ**ï¼šæ‹ç‚¹å‡ºç°åœ¨çº¦ 50-70 ç§’ï¼Œå­˜åœ¨æ˜ç¡®çš„ sweet spotã€‚

---

# 4. ğŸ’¡ å…³é”®æ´è§

## 4.1 å®è§‚å±‚æ´è§

1. **$\log g$ é¢„æµ‹çš„éçº¿æ€§æˆåˆ†æœ‰é™**ï¼šLightGBM è¾¾åˆ° $R^2=0.9982$ï¼Œä¸çº¿æ€§æ¨¡å‹çš„ $R^2 \approx 0.97$ å·®è·ä¸å¤§
2. **æ¨¡å‹å¤æ‚åº¦å­˜åœ¨ä¸Šé™**ï¼šè¶…è¿‡æŸä¸ªå¤æ‚åº¦ååè€Œè¿‡æ‹Ÿåˆ

## 4.2 æ¨¡å‹å±‚æ´è§

1. **`learning_rate` æ˜¯æœ€æ•æ„Ÿå‚æ•°**ï¼š
   - `lr=0.01` å¯¼è‡´æ¬ æ‹Ÿåˆï¼ˆ$R^2$ ä¸‹é™ 0.7%ï¼‰
   - `lr=0.05` å’Œ `lr=0.1` æ€§èƒ½æ¥è¿‘ï¼Œä½† 0.05 æ›´ç¨³å®š

2. **`num_leaves` å­˜åœ¨æœ€ä¼˜åŒºé—´**ï¼šå¤ªå° (â‰¤8) æ¬ æ‹Ÿåˆï¼›å¤ªå¤§ (256) è¿‡æ‹Ÿåˆï¼›æœ€ä¼˜ 31-128

3. **`n_estimators` è¾¹é™…æ•ˆç›Šä½**ï¼š1000â†’2000 ä»…æå‡ 0.11%ï¼Œæ—¶é—´å¢åŠ  43%

## 4.3 å®éªŒå±‚ç»†èŠ‚

- **æœ€ä¼˜é…ç½®**: `n_est=2000, leaves=31, depth=7, lr=0.05` â†’ $R^2=0.9982$
- **æ€§ä»·æ¯”æœ€ä¼˜**: `n_est=1000, leaves=31, depth=5, lr=0.1` â†’ $R^2=0.9975$, 25s
- **è®­ç»ƒç¨³å®šæ€§**: `lr=0.05` çš„ $R^2$ æ ‡å‡†å·®æœ€ä½ (0.0013)

---

# 5. ğŸ“ ç»“è®º

## 5.1 æ ¸å¿ƒå‘ç°

> **`learning_rate` æ˜¯æœ€å…³é”®è¶…å‚æ•°ï¼Œè€Œæ¨¡å‹å¤æ‚åº¦å­˜åœ¨æ˜ç¡®çš„æœ€ä¼˜åŒºé—´ï¼ˆ`num_leaves=31-128`ï¼‰ï¼Œè¶…è¿‡åå‡ºç°è¿‡æ‹Ÿåˆã€‚**

- âŒ åŸå‡è®¾: å¢åŠ æ¨¡å‹å¤æ‚åº¦æ€»èƒ½æå‡æ€§èƒ½
- âœ… å®éªŒç»“æœ: å­˜åœ¨æœ€ä¼˜å¤æ‚åº¦åŒºé—´ï¼Œ`num_leaves=256` åè€Œä¸‹é™

## 5.2 å…³é”®ç»“è®º

| # | ç»“è®º | è¯æ® |
|---|------|------|
| 1 | **`learning_rate` æœ€å…³é”®** | ä¸ $R^2$ ç›¸å…³ç³»æ•° +0.491 |
| 2 | **æœ€ä¼˜å¤æ‚åº¦åŒºé—´å­˜åœ¨** | `num_leaves=31` è¾¾ 0.9982ï¼Œ256 é™è‡³ 0.9969 |
| 3 | **æ”¶ç›Šé€’å‡æ˜æ˜¾** | è®­ç»ƒæ—¶é—´ 25sâ†’68sï¼Œ$R^2$ ä»… 0.9975â†’0.9982 |
| 4 | **1000 æ£µæ ‘è¶³å¤Ÿ** | åŠ å€ä»…æå‡ 0.11% |

## 5.3 è®¾è®¡å¯ç¤º

| åŸåˆ™ | å»ºè®® | åŸå›  |
|------|------|------|
| é»˜è®¤å­¦ä¹ ç‡ | `lr=0.05` | æ€§èƒ½æœ€ä¼˜ä¸”ç¨³å®šæ€§æœ€å¥½ |
| å¶å­æ•°é‡ | `num_leaves=31` | æ€§ä»·æ¯”æœ€é«˜çš„å¹³è¡¡ç‚¹ |
| æ ‘æ·±åº¦ | `max_depth=7` | è¶…è¿‡ 7 æ— æ˜¾è‘—æ”¶ç›Š |
| æ ‘æ•°é‡ | `n_estimators=1000` | é…åˆ Early Stopping |

### âš ï¸ å¸¸è§é™·é˜±

| å¸¸è§åšæ³• | é—®é¢˜ |
|----------|------|
| "ç”¨å¾ˆå°çš„ lr æ›´ç¨³å®š" | `lr=0.01` å¯¼è‡´æ¬ æ‹Ÿåˆ |
| "num_leaves è¶Šå¤§è¶Šå¥½" | 256 å¶å­è¿‡æ‹Ÿåˆ |
| "å¤šåŠ æ ‘æ€»æ²¡é”™" | 1000â†’2000 ä»…æå‡ 0.11% |

## 5.4 å…³é”®æ•°å­—é€ŸæŸ¥

| æŒ‡æ ‡ | å€¼ | é…ç½® |
|------|-----|------|
| æœ€ä¼˜ $R^2$ | **0.9982** | n=2000, leaves=31, depth=7, lr=0.05 |
| æ€§ä»·æ¯”æœ€ä¼˜ | **0.9975** in 25s | n=1000, leaves=31, depth=5, lr=0.1 |
| æ¨èé»˜è®¤ | **0.9976** in 37s | n=1000, leaves=31, depth=7, lr=0.05 |

## 5.5 ä¸‹ä¸€æ­¥å·¥ä½œ

| æ–¹å‘ | å…·ä½“ä»»åŠ¡ | ä¼˜å…ˆçº§ |
|------|----------|--------|
| å™ªå£°é²æ£’æ€§ | æµ‹è¯•æœ€ä¼˜é…ç½®åœ¨ $\sigma=0.1 \sim 1.0$ ä¸‹çš„è¡°å‡ | ğŸ”´ P0 |
| ç‰¹å¾é€‰æ‹© | ç»“åˆ Top-K æµ‹è¯•å‡å°‘è¿‡æ‹Ÿåˆ | ğŸŸ¡ P1 |

---

# 6. ğŸ“ é™„å½•

## 6.1 è¶…å‚æ•°é‡è¦æ€§æ’åº

| æ’å | è¶…å‚æ•° | ä¸ $R^2$ ç›¸å…³ç³»æ•° | å½±å“ç¨‹åº¦ |
|:----:|--------|:-----------------:|:--------:|
| 1 | `learning_rate` | **+0.491** | æœ€å…³é”® |
| 2 | `num_leaves` | +0.141 | ä¸­ç­‰ |
| 3 | `max_depth` | +0.124 | ä¸­ç­‰ |
| 4 | `n_estimators` | +0.080 | è¾ƒä½ |

## 6.2 Top 10 æœ€ä½³é…ç½®

| Rank | n\_est | leaves | depth | lr | Test $R^2$ | Time(s) |
|:----:|:------:|:------:|:-----:|:----:|:----------:|:-------:|
| 1 | 2000 | 31 | 7 | 0.05 | **0.9982** | 67.8 |
| 2 | 1000 | 128 | -1 | 0.05 | 0.9981 | 160.6 |
| 3 | 2000 | 31 | 10 | 0.05 | 0.9980 | 78.3 |
| 4 | 2000 | 128 | 10 | 0.05 | 0.9980 | 180.0 |
| 5 | 2000 | 128 | -1 | 0.05 | 0.9979 | 279.8 |

## 6.3 Learning Rate å½±å“åˆ†æ

| learning\_rate | å¹³å‡ $R^2$ | æ ‡å‡†å·® | è¯„ä»· |
|:--------------:|:----------:|:------:|:----:|
| 0.01 | 0.9894 | 0.0053 | æ¬ æ‹Ÿåˆ |
| **0.05** | **0.9962** | **0.0013** | **æœ€ä¼˜** |
| 0.1 | 0.9967 | 0.0007 | æ¬¡ä¼˜ |

## 6.4 Pareto æœ€ä¼˜é…ç½®

| æ—¶é—´é¢„ç®— | æœ€ä½³é…ç½® | $R^2$ | å®é™…æ—¶é—´ |
|:--------:|:-------:|:-----:|:--------:|
| â‰¤15s | (1000, 128, 3, 0.1) | 0.9955 | 11.0s |
| â‰¤30s | (1000, 31, 5, 0.1) | 0.9975 | 25.4s |
| â‰¤50s | (2000, 16, 5, 0.05) | 0.9979 | 36.7s |
| â‰¤100s | (2000, 31, 7, 0.05) | **0.9982** | 67.8s |

## 6.5 æ¨èé…ç½®ä»£ç 

```python
# â­ æ¨èé»˜è®¤é…ç½®
LIGHTGBM_DEFAULT = {
    'n_estimators': 1000,
    'num_leaves': 31,
    'max_depth': 7,
    'learning_rate': 0.05,
    'boosting_type': 'gbdt',
    'objective': 'regression',
    'metric': 'mae',
    'verbose': -1,
    'n_jobs': -1,
    'random_state': 42
}
# é¢„æœŸ: RÂ² â‰ˆ 0.9976, MAE â‰ˆ 0.0099, Time â‰ˆ 37s
```

## 6.6 ç›¸å…³æ–‡ä»¶

| ç±»å‹ | è·¯å¾„ |
|------|------|
| å›¾è¡¨ | `logg/lightgbm/img/` |
| åŸå§‹æ•°æ® | `~/VIT/results/lightgbm_sweep/sweep_results.csv` |
| å¯è§†åŒ–å›¾ | `~/VIT/results/lightgbm_sweep/professional_viz/` |

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-11-29*
