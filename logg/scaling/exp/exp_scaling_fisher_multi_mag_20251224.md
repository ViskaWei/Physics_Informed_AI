# ğŸ§ª Experiment: Fisher/CRLB Multi-Magnitude Sweep

**Experiment ID:** `SCALING-20251224-fisher-multi-mag`  
**Date:** 2024-12-24 (Updated: 2024-12-25)  
**Status:** âœ… Completed  
**MVP:** MVP-16T Extension

---

## ğŸ“‹ Overview

åœ¨ V2 éªŒè¯åŸºç¡€ä¸Šï¼Œæ‰©å±•åˆ° 6 ä¸ªä¸åŒ magnitudeï¼ˆä¸åŒ SNRï¼‰çš„ Fisher/CRLB è®¡ç®—ï¼š

| Dataset | Magnitude | SNR Median | Error Median |
|---------|-----------|------------|--------------|
| grid_mag18_lowT | 18.0 | 87.4 | 0.0058 |
| grid_mag20_lowT | 20.0 | 24.0 | 0.0210 |
| grid_mag215_lowT | 21.5 | 7.1 | 0.0703 |
| grid_mag22_lowT | 22.0 | 4.6 | 0.1085 |
| grid_mag225_lowT | 22.5 | 3.0 | 0.1690 |
| grid_mag23_lowT | 23.0 | 1.9 | 0.2649 |

### SNR è®¡ç®—è¯´æ˜

- **flux** å’Œ **error** å‡ç”± **PFS æ¨¡æ‹Ÿå™¨**ç›´æ¥ç”Ÿæˆï¼ˆéæ‰‹åŠ¨è®¡ç®—ï¼‰
- **SNR = flux / error** (per pixel)
- è¡¨ä¸­ SNR Median æ˜¯æ‰€æœ‰æ ·æœ¬ã€æ‰€æœ‰ pixel çš„ median(flux/error)
- error è¡¨ç¤ºæ¯ä¸ª pixel çš„é¢„æœŸæµ‹é‡è¯¯å·®ï¼ˆ1Ïƒï¼‰ï¼Œæ¨¡æ‹Ÿå™¨è€ƒè™‘äº†è§‚æµ‹æ¡ä»¶ã€ä»ªå™¨å“åº”ã€å…‰å­å™ªå£°ç­‰

---

## ğŸ¯ Results

### Summary Table

| Magnitude | SNR | RÂ²_max (median) | RÂ²_max (90%) | Schur Decay | CRLB Orders |
|-----------|-----|-----------------|--------------|-------------|-------------|
| **18.0** | 87.4 | **0.9994** | 0.9999 | 0.6641 | 2.9 |
| **20.0** | 24.0 | **0.9906** | 0.9983 | 0.6842 | 2.9 |
| **21.5** | 7.1 | **0.8914** | 0.9804 | 0.6906 | 2.9 |
| **22.0** | 4.6 | **0.7396** | 0.9530 | 0.6921 | 2.9 |
| **22.5** | 3.0 | **0.3658** | 0.8854 | 0.6922 | 2.9 |
| **23.0** | 1.9 | **0.0000** | 0.7180 | 0.6923 | 2.9 |

### Key Findings

#### 1. SNR-RÂ²_max é˜¶æ¢¯å¼ä¸‹é™

| SNR Range | RÂ²_max (median) | è§£è¯» |
|-----------|-----------------|------|
| > 20 | > 0.99 | è¿‘ä¹å®Œç¾ä¼°è®¡ |
| 7-20 | 0.89 | ä¼˜ç§€ |
| **4-7** | **0.74** | è‰¯å¥½ï¼Œä¸´ç•ŒåŒºåŸŸ |
| **2-4** | **0.37** | å›°éš¾ï¼ŒåŠæ•°å¯ç”¨ |
| < 2 | 0.00 | ä¿¡æ¯æ‚¬å´– |

#### 2. ä¸´ç•Œ SNR â‰ˆ 4
- SNR=4.6 (mag=22) æ—¶ RÂ²_max median = 0.74
- SNR=3.0 (mag=22.5) æ—¶ RÂ²_max median = 0.37
- **SNR~4 æ˜¯ RÂ²_max > 0.5 çš„ä¸´ç•Œç‚¹**

#### 3. 90% åˆ†ä½ä»æœ‰å¸Œæœ›
å³ä½¿ mag=23ï¼Œ90% åˆ†ä½çš„ RÂ²_max ä»è¾¾ 0.72ï¼Œè¯´æ˜ï¼š
- å‚æ•°ç©ºé—´å­˜åœ¨"ä¿¡æ¯å¯Œé›†"åŒºåŸŸ
- å¯è€ƒè™‘åŒºåŸŸç‰¹åŒ–æ¨¡å‹

> âš ï¸ **ç†è§£ 90% åˆ†ä½ vs Median çš„å·®å¼‚ (mag=23 case)**
> 
> **ä¸ºä»€ä¹ˆ 90%=0.718 ä½† median=0ï¼Ÿ**
> 
> 1. **RÂ²_max æ˜¯ per-sample è®¡ç®—çš„**ï¼šæ¯ä¸ªå‚æ•°ç‚¹ (T_eff, log_g, M_H) éƒ½æœ‰è‡ªå·±çš„ RÂ²_max å€¼
> 
> 2. **è®¡ç®—å…¬å¼**ï¼š
>    ```python
>    RÂ²_max = clip(1.0 - CRLB / Var(log_g), 0.0, 1.0)
>    ```
>    å½“ CRLB å¾ˆå¤§ï¼ˆä¿¡æ¯é‡ä½ï¼‰æ—¶ï¼ŒRÂ²_max è¢« clip åˆ° 0
> 
> 3. **90% åˆ†ä½æ•°çš„å«ä¹‰**ï¼š
>    - å°†æ‰€æœ‰ ~2000+ æ ·æœ¬çš„ RÂ²_max æ’åº
>    - `quantile(0.9)` = ç¬¬ 90 ç™¾åˆ†ä½ = **90% çš„æ ·æœ¬ RÂ²_max â‰¤ æ­¤å€¼**
>    - å³ **top 10% çš„æ ·æœ¬æœ‰ RÂ²_max â‰¥ 0.718**
> 
> 4. **Median = 0 çš„å«ä¹‰**ï¼š
>    - **è¶…è¿‡ 50% çš„æ ·æœ¬ RÂ²_max = 0**ï¼ˆæˆ–æ¥è¿‘ 0ï¼‰
>    - è¿™äº›æ ·æœ¬çš„ CRLB >> Var(log_g)ï¼Œå™ªå£°å®Œå…¨æ·¹æ²¡äº†ä¿¡å·
> 
> 5. **åˆ†å¸ƒå½¢æ€**ï¼š
>    ```
>    æ ·æœ¬ RÂ²_max åˆ†å¸ƒ (mag=23):
>    
>    é¢‘æ¬¡
>    â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  (~50% åœ¨ 0 é™„è¿‘)
>    â”‚  â–ˆâ–ˆ
>    â”‚  â–ˆ
>    â”‚  â–ˆ                 â–“â–“â–“ (top 10% åœ¨ 0.72+)
>    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ RÂ²_max
>       0                 0.72    1.0
>    ```
> 
> 6. **ç‰©ç†è§£è¯»**ï¼š
>    - åœ¨ SNR~1.9 çš„æç«¯ä½ä¿¡å™ªæ¯”ä¸‹ï¼Œå‚æ•°ç©ºé—´å¤§éƒ¨åˆ†åŒºåŸŸ"ä¿¡æ¯å¡Œé™·"
>    - ä½†æŸäº›ç‰¹å®šå‚æ•°ç»„åˆï¼ˆå¦‚é«˜æ¸©ã€é«˜é‡‘å±ä¸°åº¦é™„è¿‘ï¼‰å…‰è°±å˜åŒ–ä»æ˜¾è‘—
>    - è¿™äº›"ä¿¡æ¯å¯Œé›†åŒº"çš„ top 10% æ ·æœ¬ä»å¯è·å¾— RÂ²â‰¥0.72 çš„ç†è®ºç²¾åº¦

#### 4. Schur Decay æ’å®š
- æ‰€æœ‰ magnitude çš„ Schur decay â‰ˆ 0.68-0.69
- å‚æ•°çº ç¼ ç”±å…‰è°±ç‰©ç†å†³å®šï¼Œä¸ SNR æ— å…³

---

## ğŸ“Š Figures

### Figure 1: RÂ²_max vs Magnitude
![RÂ²_max vs Magnitude](../img/fisher_multi_mag_r2max.png)

**æè¿°**: RÂ²_max (median å’Œ 90% åˆ†ä½) éš magnitude/SNR å˜åŒ–æ›²çº¿
**å…³é”®è§‚å¯Ÿ**: 
- SNR > 20 æ—¶ RÂ²_max æ¥è¿‘ 1
- ä¸´ç•Œ SNR â‰ˆ 4 (mag=22)
- ä¿¡æ¯æ‚¬å´–åœ¨ SNR < 2 (mag=23)

---

### Figure 2: Schur Decay vs Magnitude
![Schur Decay vs Magnitude](../img/fisher_multi_mag_schur.png)

**æè¿°**: Schur decay å±•ç¤ºå‚æ•°çº ç¼ éš SNR çš„æ’å®šæ€§
**å…³é”®è§‚å¯Ÿ**: 
- Schur decay â‰ˆ 0.68-0.69 æ’å®š
- çº ç¼ ç”±å…‰è°±ç‰©ç†å†³å®šï¼Œä¸ SNR æ— å…³

---

### Figure 3: RÂ²_max vs SNR Trend
![RÂ²_max vs SNR Trend](../img/fisher_multi_mag_snr_trend.png)

**æè¿°**: RÂ²_max éš SNR çš„è¿ç»­å˜åŒ–è¶‹åŠ¿ (log scale)
**å…³é”®è§‚å¯Ÿ**: 
- é˜¶æ¢¯å¼ä¸‹é™æ˜æ˜¾
- SNR=4 æ˜¯å…³é”®æ‹ç‚¹

---

## ğŸ’¡ Insights

### I-Multi-1: Information Saturation at High SNR
> **å‘ç°**: SNR > 20 æ—¶ RÂ²_max æ¥è¿‘ 1ï¼Œç»§ç»­æé«˜ SNR æ”¶ç›Šè¾¹é™…é€’å‡ã€‚
> 
> **å¯ç¤º**: å¯¹äº bright targets (mag < 20)ï¼Œæ¨¡å‹æ€§èƒ½ç“¶é¢ˆä¸æ˜¯ä¿¡æ¯é‡ï¼Œè€Œæ˜¯ç‰¹å¾æå–èƒ½åŠ›ã€‚

### I-Multi-2: Critical SNR â‰ˆ 4
> **å‘ç°**: SNR=4 æ˜¯ RÂ²_max median > 0.5 çš„ä¸´ç•Œç‚¹ã€‚
> 
> **å¯ç¤º**: 
> - mag=22 æ˜¯æœ‰æ•ˆä¼°è®¡çš„æé™è¾¹ç•Œ
> - mag > 22.5 éœ€è¦é¢å¤–ç­–ç•¥ï¼ˆå¤šæ›å…‰ã€å…ˆéªŒã€ensembleï¼‰

### I-Multi-3: Information Cliff at Low SNR
> **å‘ç°**: SNR < 2 æ—¶ï¼Œè¶…è¿‡ 50% æ ·æœ¬çš„ Fisher ä¿¡æ¯è¶‹è¿‘äº 0ã€‚
> 
> **å¯ç¤º**: mag=23 é™„è¿‘å­˜åœ¨"ä¿¡æ¯æ‚¬å´–"ï¼Œä½† top 10% æ ·æœ¬ä»å¯ä¼°è®¡ (RÂ²=0.72)ã€‚

### I-Multi-4: Degeneracy is Physics-Intrinsic
> **å‘ç°**: Schur decay â‰ˆ 0.68 æ’å®šï¼Œä¸ SNR æ— å…³ã€‚
> 
> **å¯ç¤º**: Multi-task è§£çº ç¼ ç­–ç•¥åœ¨æ‰€æœ‰ SNR çº§åˆ«åŒç­‰é‡è¦ã€‚

---

## ğŸ“ Artifacts

| Type | Path |
|------|------|
| Script | `~/VIT/scripts/scaling_fisher_ceiling_v2_multi_mag.py` |
| Results | `~/VIT/results/SCALING-20251224-fisher-multi-mag/` |
| Plots | `logg/scaling/img/fisher_multi_mag_*.png` |
| Data Index | `data/bosz50k/z0/grid_fisher_datasets.md` |

---

## ğŸ”— Related

| Type | Link | Description |
|------|------|-------------|
| ğŸ§  **Fisher Hub** | [`../fisher/fisher_hub_20251225.md`](../fisher/fisher_hub_20251225.md) | â¬…ï¸ Fisher ä¸“é¢˜æ±‡åˆ |
| â¬…ï¸ Previous | [exp_scaling_fisher_ceiling_v2_20251224.md](exp_scaling_fisher_ceiling_v2_20251224.md) | single mag=21.5 |
| ğŸ“‚ Data | [grid_fisher_datasets.md](/home/swei20/Physics_Informed_AI/data/bosz50k/z0/grid_fisher_datasets.md) | æ•°æ®ç´¢å¼• |

---

*Generated: 2024-12-24, Updated: 2024-12-25*
