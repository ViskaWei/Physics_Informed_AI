# ğŸ“‡ Knowledge Card: Gate Feature Robustness
> **Name:** Gate Feature Sanity Check | **ID:** `VIT-20251224-scaling-gate-feat-card`  
> **Topic:** `scaling` | **Source:** `exp_scaling_gate_feat_sanity_20251224.md` | **Project:** `VIT`  
> **Author:** Viska Wei | **Date:** 2025-12-24
```
ğŸ’¡ ç‰©ç†çª—å£ç‰¹å¾ (Ca II, Na I, Mg I, PCA) åœ¨ noise=1 ä¸‹ 9-class å‡†ç¡®ç‡ 88%ï¼Œè¿œè¶…é¢„æœŸ  
é€‚ç”¨ï¼šMoE Gate è¾“å…¥è®¾è®¡
```

---

## ğŸ¯ é—®é¢˜ä¸è®¾ç½®

**é—®é¢˜**: Gate ç‰¹å¾åœ¨é«˜å™ªå£° (noise=1) ä¸‹æ˜¯å¦ä»æœ‰ bin åŒºåˆ†èƒ½åŠ›ï¼Ÿ

**è®¾ç½®**: 
- æ•°æ®: BOSZ 1M train, 1k test, noise Ïƒ=1.0
- æ¨¡å‹: LightGBM 9-class classifier
- å…³é”®å˜é‡: 37 ç»´ç‰©ç†çª—å£ç‰¹å¾ (Ca II, Na I, Mg I, PCA)

---

## ğŸ“Š å…³é”®ç»“æœ

| # | ç»“æœ | æ•°å€¼ | é…ç½® |
|---|------|------|------|
| 1 | 9-class Accuracy @ noise=1 | **87.8%** | é˜ˆå€¼ 60% |
| 2 | Ca II F-statistic | 25,618 | é˜ˆå€¼ 10 |
| 3 | æœ‰æ•ˆ SNR | 6.21 | é˜ˆå€¼ 1.0 |
| 4 | Top Feature | PCA_1 (F=287,966) | - |
| 5 | Accuracy @ noise=2 | 75.1% | ä»è¿œè¶… 40% |

**Noise Sweep**:
| noise | 0.0 | 0.2 | 0.5 | 1.0 | 2.0 |
|-------|-----|-----|-----|-----|-----|
| Acc | 98.3% | 96.8% | 92.5% | 88.3% | 75.1% |

---

## ğŸ’¡ æ ¸å¿ƒæ´è§

### ğŸ—ï¸ å®è§‚å±‚ï¼ˆæ¶æ„è®¾è®¡ï¼‰

- **ç‰©ç†çª—å£ç‰¹å¾æå…¶é²æ£’**: å³ä½¿ noise=2 ä¹Ÿèƒ½ 75% å‡†ç¡®ç‡
- **PCA ç‰¹å¾æœ€å¼º**: å…¨è°±å½¢çŠ¶åœ¨ bin åŒºåˆ†ä¸­æœ€å…³é”®

### ğŸ”§ æ¨¡å‹å±‚ï¼ˆè°ƒå‚ä¼˜åŒ–ï¼‰

- **Mg I > Ca II**: Mg I çª—å£æ›´çª„ï¼Œä¿¡å·æ›´é›†ä¸­
- **SNR åœ¨ noise å˜åŒ–æ—¶å‡ ä¹ä¸å˜**: ç‰©ç†çª—å£æœ‰æ•ˆé™å™ª

### âš™ï¸ å·¥ç¨‹å±‚ï¼ˆå®ç°ç»†èŠ‚ï¼‰

- 37 ç»´ç‰¹å¾: 9 Ca II + 6 Na I + 9 Mg I + 3 èšåˆ + 10 PCA
- ä¸»è¦æ··æ·†åœ¨ç›¸é‚» Teff/[M/H] bins ä¹‹é—´

---

## â¡ï¸ ä¸‹ä¸€æ­¥

| ä¼˜å…ˆçº§ | ä»»åŠ¡ | ç›¸å…³ experiment_id |
|--------|------|-------------------|
| ğŸ”´ P0 | å¼€å‘ trainable soft-gate MoE | MVP-16A-2 |
| ğŸŸ¡ P1 | éªŒè¯ soft routing æ¥è¿‘ oracle æ€§èƒ½ | - |

---

## ğŸ”— ç›¸å…³é“¾æ¥

| ç±»å‹ | è·¯å¾„ |
|------|------|
| è®­ç»ƒä»“åº“ | `~/VIT/` |
| è„šæœ¬ | `~/VIT/scripts/scaling_gate_feat_sanity.py` |
| å®Œæ•´æŠ¥å‘Š | `logg/scaling/exp/exp_scaling_gate_feat_sanity_20251224.md` |

