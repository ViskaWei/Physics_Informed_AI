# ğŸƒ æ­£åˆ™åŒ–å¼ºåº¦ (Î±) è°ƒä¼˜
> **Name:** Ridge Î± Sweep  
> **ID:** `VIT-20251127-ridge-alpha-01`  
> **Topic:** `ridge` | **MVP:** MVP-1.0 | **Project:** `VIT`  
> **Author:** Viska Wei | **Date:** 2025-11-27 | **Status:** âœ…  
> **Root:** `Ridge` | **Parent:** `Alpha` | **Child**: |

> ğŸ¯ **Target:** éªŒè¯å…‰è°±-log_g æ˜ å°„æ˜¯å¦æœ¬è´¨çº¿æ€§ï¼Œæœ€ä¼˜ Î± å¦‚ä½•éšå™ªå£°å˜åŒ–  
> ğŸ¦¾ **Decide:** NN æ¶æ„åº”ä¼˜å…ˆè®¾è®¡ä¿¡æ¯è¿‡æ»¤æœºåˆ¶ï¼ˆAttention/Sparse/Denoisingï¼‰

---


## ğŸ”— Upstream Links
| Type | Link |
|------|------|
| ğŸ§  Hub | `logg/ridge/ridge_hub.md` |
| ğŸ—ºï¸ Roadmap | `logg/ridge/ridge_roadmap.md` |

---

---

# âš¡ æ ¸å¿ƒç»“è®ºé€Ÿè§ˆï¼ˆä¾› main æå–ï¼‰

### ä¸€å¥è¯æ€»ç»“

> **$\log g$-flux æ˜ å°„æœ¬è´¨çº¿æ€§ï¼ˆnoise=0 æ—¶ $R^2=0.999$ï¼‰ï¼ŒNN çš„ä¸»è¦ä»»åŠ¡æ˜¯"å­¦ä¼šå¿½ç•¥æ— å…³åƒç´ "è€Œéæå–ä¿¡æ¯ã€‚**

### å¯¹å‡è®¾çš„éªŒè¯

| éªŒè¯é—®é¢˜ | ç»“æœ | ç»“è®º |
|---------|------|------|
| æ— å™ªå£°æ—¶æ˜¯å¦éœ€è¦æ­£åˆ™åŒ–ï¼Ÿ | âœ… æ˜¯ï¼ŒÎ±=0.001 ä½¿ $R^2$: 0.969â†’0.999 | å…‰è°±å«æ— å…³ä¿¡æ¯ |
| æœ€ä¼˜ Î± å¦‚ä½•éšå™ªå£°å˜åŒ–ï¼Ÿ | âœ… å•è°ƒå¢å¤§ 0.001â†’1000 | éœ€åˆ é™¤çš„ä¿¡æ¯é‡éšå™ªå£°å¢åŠ  |
| Ridge vs OLS å·®è·å¤šå¤§ï¼Ÿ | âœ… é«˜å™ªå£°ä¸‹ +68.4% | æ­£åˆ™åŒ–æ€»æ˜¯æœ‰ç›Š |

### è®¾è®¡å¯ç¤ºï¼ˆ1-2 æ¡ï¼‰

| å¯ç¤º | å…·ä½“å»ºè®® |
|------|---------|
| **Linear shortcut** | æ¨¡å‹åº”è®¾è®¡ä¸º $\hat{y} = w^\top x + g_\theta(x)$ |
| **Weight decay ä¸å™ªå£°æŒ‚é’©** | æœ€ä¼˜ Î± éšå™ªå£°å˜åŒ– 6 ä¸ªæ•°é‡çº§ |

### å…³é”®æ•°å­—

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| noise=0 æœ€ä½³ $R^2$ | **0.999** (Î±=0.001) |
| noise=0.5 æœ€ä½³ $R^2$ | **0.655** (Î±=50) |
| noise=1.0 æœ€ä½³ $R^2$ | **0.458** (Î±=200) |
| noise=2.0 æœ€ä½³ $R^2$ | **0.221** (Î±=1000) |
| æ­£åˆ™åŒ–æœ€å¤§æ”¶ç›Š | **+68.4%** @ noise=2.0 |

---

# ğŸ“‘ ç›®å½•

- [1. ğŸ¯ ç›®æ ‡](#1--ç›®æ ‡)
- [2. ğŸ§ª å®éªŒè®¾è®¡](#2--å®éªŒè®¾è®¡experiment-design)
- [3. ğŸ“Š å®éªŒå›¾è¡¨](#3--å®éªŒå›¾è¡¨)
- [4. ğŸ’¡ å…³é”®æ´è§](#4--å…³é”®æ´è§key-insights)
- [5. ğŸ“ ç»“è®º](#5--ç»“è®ºconclusion)
- [6. ğŸ“ é™„å½•](#6--é™„å½•)

---

# 1. ğŸ¯ ç›®æ ‡

## 1.1 èƒŒæ™¯ä¸åŠ¨æœº

é¢„æµ‹ log_g æ—¶ï¼ŒæŠŠæ— å…³åƒç´ "æ‰”æ‰"æ¯”"ä¿ç•™"æ›´æœ‰æ•ˆ â€”â€” è¿™æ„å‘³ç€åç»­ NN æ¶æ„åº”ä¾§é‡äºå­¦ä¹ "å“ªäº›ä¿¡æ¯ä¸é‡è¦"ã€‚

æˆ‘ä»¬æƒ³éªŒè¯ï¼š
- 4096 ç»´å…‰è°±ä¸­ï¼Œæ˜¯å¦å­˜åœ¨å¤§é‡ä¸ log_g **å®Œå…¨æ— å…³** çš„åƒç´ /ä¿¡æ¯ï¼Ÿ
- æ¨¡å‹çš„æ ¸å¿ƒä»»åŠ¡æ˜¯å¦æ˜¯ **ä¿¡æ¯è¿‡æ»¤ï¼ˆfilteringï¼‰** è€Œé **ä¿¡æ¯æå–ï¼ˆextractionï¼‰**ï¼Ÿ
- å¦‚æœæ­£åˆ™åŒ–ï¼ˆå³"å‹åˆ¶æ— å…³ç»´åº¦"ï¼‰èƒ½æ˜¾è‘—æå‡æ€§èƒ½ï¼Œåˆ™è¯´æ˜ NN è®¾è®¡åº”ä¼˜å…ˆè€ƒè™‘ **å»å™ª/ç¨€ç–åŒ–æœºåˆ¶**

## 1.2 æ ¸å¿ƒå‡è®¾

> **ç¥ç»ç½‘ç»œçš„å¤§éƒ¨åˆ† capacity æ˜¯ç”¨æ¥"åˆ æ‰æ— ç”¨ä¿¡æ¯"ï¼Œè€Œä¸æ˜¯"æå–æœ‰ç”¨ä¿¡æ¯"ã€‚**

æœ¬æ¬¡å®éªŒé€šè¿‡ Ridge å›å½’æä¾›ä»¥ä¸‹è¯æ®ï¼š

- **è¯æ® 1**ï¼šÎ±=0.001 æ—¶ RÂ² ä» OLS çš„ 0.969 è·ƒå‡è‡³ 0.999 â€”â€” å³ä½¿æ— å™ªå£°ï¼Œä¹Ÿæœ‰æ— å…³ä¿¡æ¯éœ€è¦å‹åˆ¶
- **è¯æ® 2**ï¼šæœ€ä¼˜ Î± éšå™ªå£°å•è°ƒå¢å¤§ â€”â€” å™ªå£°è¶Šå¤§ï¼Œéœ€è¦"æ‰”æ‰"çš„æ— å…³åƒç´ è¶Šå¤š
- **è¯æ® 3**ï¼šRidge åœ¨æ‰€æœ‰å™ªå£°ä¸‹ä¼˜äº OLS â€”â€” ä¿¡æ¯è¿‡æ»¤å§‹ç»ˆæœ‰ç›Š

## 1.3 éªŒè¯é—®é¢˜

| # | é—®é¢˜ | éªŒè¯ç›®æ ‡ | ç»“æœ |
|---|------|---------|------|
| Q1 | æ— å™ªå£°æ—¶æ˜¯å¦ä¹Ÿéœ€è¦æ­£åˆ™åŒ–ï¼Ÿ | éªŒè¯å…‰è°±æœ¬èº«å«æ— å…³ä¿¡æ¯ | âœ… æ˜¯ï¼ŒÎ±=0.001 ä½¿ RÂ² ä» 0.969â†’0.999 |
| Q2 | æœ€ä¼˜ Î± å¦‚ä½•éšå™ªå£°å˜åŒ–ï¼Ÿ | æ­ç¤º"éœ€åˆ é™¤ä¿¡æ¯é‡"ä¸å™ªå£°çš„å…³ç³» | âœ… å•è°ƒå¢å¤§ï¼š0.001â†’1000 |
| Q3 | Ridge vs OLS çš„æ€§èƒ½å·®è·æœ‰å¤šå¤§ï¼Ÿ | é‡åŒ–"ä¿¡æ¯è¿‡æ»¤"çš„æ”¶ç›Š | âœ… é«˜å™ªå£°ä¸‹æå‡ +68.4% |
| Q4 | é«˜å™ªå£°ä¸‹çº¿æ€§æ¨¡å‹çš„æé™åœ¨å“ªï¼Ÿ | åˆ¤æ–­æ˜¯å¦éœ€è¦éçº¿æ€§æ¥"æ›´æ™ºèƒ½åœ°è¿‡æ»¤" | âœ… N=2.0 æ—¶ best RÂ²=0.22 |

## 1.4 ç»“è®ºæ‘˜è¦

### 1.4.1 å®éªŒç»“è®º

| ç»“è®º | è¯´æ˜ |
|------|------|
| **å…‰è°±å«æ— å…³ä¿¡æ¯** | å³ä½¿ noise=0ï¼Œæ­£åˆ™åŒ–ä¹Ÿèƒ½å°† RÂ² ä» 0.969 æå‡åˆ° 0.999 |
| **æœ€ä¼˜ Î± éšå™ªå£°å•è°ƒå¢å¤§** | ä» 0.001 (N=0) åˆ° 1000 (N=2.0)ï¼Œè·¨è¶Š 6 ä¸ªæ•°é‡çº§ |
| **Ridge ä¸€è‡´ä¼˜äº OLS** | åœ¨æ‰€æœ‰å™ªå£°æ°´å¹³ä¸‹ï¼ŒÎ” RÂ² ä» +0.9% åˆ° +68.4% |
| **å…‰è°±-log_g æ˜ å°„æœ¬è´¨çº¿æ€§** | noise=0 æ—¶ RÂ²=0.999ï¼Œçº¿æ€§æ¨¡å‹è¶³å¤Ÿ |

### 1.4.2 å¯¹ NN è®¾è®¡çš„å¯ç¤º

| è®¾è®¡åŸåˆ™ | å…·ä½“å»ºè®® |
|---------|---------|
| **ä¿¡æ¯è¿‡æ»¤ä¼˜å…ˆ** | NN è®¾è®¡åº”ä¾§é‡ Attention/Sparse/Denoising æœºåˆ¶ |
| **Weight decay ä¸å™ªå£°æŒ‚é’©** | å™ªå£°è¶Šå¤§ï¼Œéœ€è¦è¶Šå¼ºçš„æ­£åˆ™åŒ– |
| **Linear + Residual ç»“æ„** | å…ˆç”¨ Ridge é¢„æµ‹ï¼Œå†ç”¨ NN å­¦ä¹ æ®‹å·® |

> **ä¸€å¥è¯æ€»ç»“**ï¼šNN çš„ä¸»è¦ä»»åŠ¡ä¸æ˜¯"ä»å…‰è°±æå– log_g"ï¼Œè€Œæ˜¯"å­¦ä¼šå“ªäº›åƒç´ è¯¥å¿½ç•¥"ã€‚

---

# 2. ğŸ§ª å®éªŒè®¾è®¡ï¼ˆExperiment Designï¼‰

## 2.1 æ•°æ®ï¼ˆDataï¼‰

| é…ç½®é¡¹ | å€¼ |
|--------|-----|
| æ ·æœ¬æ•° | ~52 unique (Î±, noise_level) ç»„åˆ |
| ç‰¹å¾ç»´åº¦ | 4,096 |
| æ ‡ç­¾å‚æ•° | log_g |
| å™ªå£°æ°´å¹³ | 0.0, 0.1, 0.2, 0.5, 1.0, 2.0 |

**å™ªå£°æ¨¡å‹ï¼š**
$$
\text{noisy\_flux} = \text{flux} + \mathcal{N}(0, 1) \times \text{error} \times \text{noise\_level}
$$

å…¶ä¸­ï¼š
- **flux**: å…‰è°±æµé‡å€¼ï¼ˆæ¯ä¸ªæ³¢é•¿ç‚¹çš„è¾å°„å¼ºåº¦ï¼‰
- **error**: æ¯ä¸ªæ³¢é•¿ç‚¹çš„å·²çŸ¥é«˜æ–¯å™ªå£°æ ‡å‡†å·® Ïƒ
- **noise_level**: å™ªå£°ç¼©æ”¾å› å­ (0.0 - 2.0)

## 2.2 æ¨¡å‹ä¸ç®—æ³•ï¼ˆModel & Algorithmï¼‰

### Ridge å›å½’ï¼ˆL2 æ­£åˆ™åŒ–çº¿æ€§å›å½’ï¼‰
$$
\hat{y} = X w + b
$$
$$
w = (X^\top X + \alpha I)^{-1} X^\top y
$$

### OLSï¼ˆOrdinary Least Squaresï¼Œæ— æ­£åˆ™åŒ–ï¼‰
$$
w = (X^\top X)^{-1} X^\top y
$$

## 2.3 è¶…å‚æ•°æœç´¢ç©ºé—´

| å‚æ•° | æœç´¢èŒƒå›´ |
|------|----------|
| Ridge Î± | 0.001, 0.01, 0.1, 1.0, 10.0, 100.0, 1000.0 |
| noise_level | 0.0, 0.1, 0.2, 0.5, 1.0, 2.0 |
| ç‰¹å¾ç»´åº¦ | 4096 |

## 2.4 æ•°æ®æ¥æº

| æ¥æº | æ–‡ä»¶è·¯å¾„ | å™ªå£°èŒƒå›´ | Alpha èŒƒå›´ |
|------|----------|----------|------------|
| Alpha Sweep | `results/linear_alpha_search/linear_alpha_sweep.csv` | 0.0 - 2.0 | 0.001 - 1000 |
| Linear Experiments | `results/all_linear_experiments.csv` | 0.0, 0.1, 1.0 | 1 - 100 |
| Sonnet Collection | `collections/sonnet/results/LNREG_MASTER_RESULTS_TABLE.csv` | 0.0 - 2.0 | 100 |

---

# 3. ğŸ“Š å®éªŒå›¾è¡¨

## ğŸ“Š å›¾ 1ï¼šRidge æ€§èƒ½ vs logâ‚â‚€(Î±)ï¼ˆæŒ‰å™ªå£°æ°´å¹³åˆ†ç»„ï¼‰

![Ridge Metrics vs Alpha by Noise](../img/ridge_metrics_vs_alpha_by_noise.png)

**Figure 1. Ridge å›å½’æ€§èƒ½éšæ­£åˆ™åŒ–å¼ºåº¦ Î± çš„å˜åŒ–ï¼ˆæŒ‰å™ªå£°æ°´å¹³åˆ†ç»„ï¼‰ã€‚**

**å›¾è¡¨ç»“æ„ï¼š** 3Ã—1 å¸ƒå±€
- **ä¸Šå›¾**ï¼šTest RÂ² vs logâ‚â‚€(Î±)ï¼ˆè¶Šé«˜è¶Šå¥½ï¼‰
- **ä¸­å›¾**ï¼šTest MAE vs logâ‚â‚€(Î±)ï¼ˆè¶Šä½è¶Šå¥½ï¼‰
- **ä¸‹å›¾**ï¼šTest RMSE vs logâ‚â‚€(Î±)ï¼ˆè¶Šä½è¶Šå¥½ï¼‰

**é¢œè‰²æ–¹æ¡ˆï¼š** Viridis colormap
- ğŸŸ¡ é»„è‰²ï¼šnoise=0ï¼ˆå¹²å‡€æ•°æ®ï¼‰
- ğŸŸ£ ç´«è‰²ï¼šnoise=2ï¼ˆé«˜å™ªå£°ï¼‰

**æ ‡è®°è¯´æ˜ï¼š**
- æŠ˜çº¿ + åœ†ç‚¹ï¼šRidge å›å½’ç»“æœ
- â˜… æ˜Ÿå· (x=-3.5)ï¼šOLS åŸºçº¿

**å…³é”®è§‚å¯Ÿ**ï¼š
- æœ€ä¼˜ Î± éšå™ªå£°æ°´å¹³å•è°ƒå³ç§»
- OLSï¼ˆæ— æ­£åˆ™åŒ–ï¼‰åœ¨æ‰€æœ‰å™ªå£°ä¸‹éƒ½åŠ£äºæœ€ä¼˜ Ridge
- é«˜å™ªå£°ä¸‹æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼Œä½† Ridge ä»ä¼˜äº OLS

---

## ğŸ“Š å›¾ 2ï¼šå²­å›å½’ $R^2_{\text{test}}$ vs $\log_{10}\alpha$ï¼ˆæœ€ä¼˜ç‚¹è½¨è¿¹ï¼‰

![Ridge RÂ² vs Alpha by Noise](../img/ridge_r2_vs_alpha_by_noise.png)

**Figure 2. å²­å›å½’åœ¨ä¸åŒå™ªå£°æ°´å¹³ï¼ˆNLï¼‰ä¸‹çš„æµ‹è¯•é›†å†³å®šç³»æ•° $R^2_{\text{test}}$ éšæ­£åˆ™åŒ–å¼ºåº¦ $\alpha$ï¼ˆæ¨ªè½´ä¸º $\log_{10}\alpha$ï¼‰çš„å˜åŒ–ã€‚**

å²­å›å½’é€šè¿‡æœ€å°åŒ–ä»¥ä¸‹ç›®æ ‡å‡½æ•°ï¼š
$$
\hat{\mathbf w}(\alpha) = \arg\min_{\mathbf w}\bigl\|\mathbf y - X\mathbf w\bigr\|_2^2 + \alpha \bigl\|\mathbf w\bigr\|_2^2
$$

å¾—åˆ°çš„é—­å¼è§£ä¸ºï¼š
$$
\hat{\mathbf w}(\alpha) = (X^\top X + \alpha I)^{-1} X^\top \mathbf y
$$

**å›¾è¡¨å…ƒç´ è¯´æ˜**ï¼š
- æ¯æ¡æ›²çº¿å¯¹åº”ä¸€ä¸ªå™ªå£°æ°´å¹³
- â˜… æ˜Ÿå½¢æ ‡è®°ï¼šæ— æ­£åˆ™åŒ–çš„æ™®é€šæœ€å°äºŒä¹˜è§£ï¼ˆOLSï¼Œ$\alpha=0$ï¼‰
- å¸¦é»‘è‰²æè¾¹çš„å¤§å·æ ‡è®°ï¼šæ¯ä¸ªå™ªå£°æ°´å¹³ä¸‹ä½¿ $R^2_{\text{test}}$ æœ€å¤§çš„æœ€ä¼˜æ­£åˆ™åŒ–å‚æ•° $\alpha^*(\mathrm{NL})$
- é»‘è‰²è™šçº¿ï¼šè¿æ¥è¿™äº›æœ€ä¼˜ç‚¹ï¼Œè¡¨æ˜éšç€å™ªå£°å¢å¤§ï¼Œæœ€ä¼˜æ­£åˆ™åŒ–å¼ºåº¦å•è°ƒå¢å¤§è€Œå¯è¾¾åˆ°çš„ $R^2_{\text{test}}$ é€æ¸ä¸‹é™

---

## ğŸ“Š å›¾ 3ï¼šRidge å›å½’ $R^2$ vs $\log_{10}\alpha$ï¼ˆ32k æ ·æœ¬ï¼ŒSNR æ ‡æ³¨ï¼‰

![Ridge RÂ² vs Alpha by SNR (32k)](../img/ridge_r2_vs_alpha_by_snr_32k.png)

**Figure 3. Ridge å›å½’åœ¨ä¸åŒ SNR æ°´å¹³ä¸‹çš„æµ‹è¯•é›† $R^2_{\text{test}}$ éšæ­£åˆ™åŒ–å¼ºåº¦ $\alpha$ çš„å˜åŒ–ï¼ˆè®­ç»ƒæ ·æœ¬é‡ n=32kï¼‰ã€‚**

**ä¸å›¾ 2 çš„åŒºåˆ«**ï¼š
- **è®­ç»ƒæ ·æœ¬é‡**ï¼š32kï¼ˆå›¾ 2 æœªæ ‡æ³¨æ ·æœ¬é‡ï¼‰
- **å™ªå£°è¡¨ç¤ºæ–¹å¼**ï¼šä½¿ç”¨ SNRï¼ˆä¿¡å™ªæ¯”ï¼‰è€Œé noise_level
  - SNR = âˆ â†’ noise_level = 0
  - SNR = 3 â†’ noise_level = 1.0
  - SNR = 2 â†’ noise_level = 2.0

**å™ªå£°æ°´å¹³ä¸ SNR å¯¹ç…§è¡¨**ï¼š

| SNR | noise_level | è¯´æ˜ |
|-----|-------------|------|
| âˆ | 0.0 | æ— å™ªå£° |
| 30 | 0.1 | ä½å™ªå£° |
| 15 | 0.2 | è½»åº¦å™ªå£° |
| 6 | 0.5 | ä¸­ç­‰å™ªå£° |
| **3** | **1.0** | é«˜å™ªå£°ï¼ˆå…¸å‹è§‚æµ‹æ¡ä»¶ï¼‰ |
| 2 | 2.0 | æé«˜å™ªå£° |

**å…³é”®è§‚å¯Ÿ**ï¼š
- SNR è¡¨ç¤ºæ›´ç¬¦åˆå¤©æ–‡è§‚æµ‹çš„ç‰©ç†ç›´è§‰ï¼ˆä¿¡å™ªæ¯”è¶Šé«˜ï¼Œæ•°æ®è´¨é‡è¶Šå¥½ï¼‰
- åœ¨ SNR=3ï¼ˆå…¸å‹è§‚æµ‹æ¡ä»¶ï¼‰ä¸‹ï¼Œæœ€ä¼˜ $\alpha^* \approx 200$ï¼Œ$R^2 = 0.458$
- æ ·æœ¬é‡ 32k æ—¶çš„ç»“æœä¸ä¹‹å‰å®éªŒä¸€è‡´ï¼ŒéªŒè¯äº†ç»“è®ºçš„ç¨³å¥æ€§

---

# 4. ğŸ’¡ å…³é”®æ´è§ï¼ˆKey Insightsï¼‰

## 4.1 å®è§‚å±‚æ´è§ï¼ˆæ”¯æ’‘å¤§ç›®æ ‡å‡è®¾ï¼‰

### ğŸ”‘ æ ¸å¿ƒå‘ç°ï¼šå…‰è°±ä¸­å­˜åœ¨ä¸ log_g å®Œå…¨æ— å…³çš„ä¿¡æ¯

**å…³é”®è¯æ®ï¼šæ— å™ªå£°æ—¶ Î±=0.001 çš„å·¨å¤§æå‡**

| æ¨¡å‹ | noise=0 æ—¶ RÂ² | è¯´æ˜ |
|------|---------------|------|
| OLSï¼ˆæ— æ­£åˆ™åŒ–ï¼‰ | 0.9694 | ä¿ç•™æ‰€æœ‰ 4096 ç»´ä¿¡æ¯ |
| Ridge Î±=0.001 | **0.9990** | è½»å¾®å‹åˆ¶æ— å…³ç»´åº¦ |
| **Î” RÂ²** | **+0.030 (+3.1%)** | å³ä½¿æ•°æ®å®Œå…¨å¹²å‡€ï¼Œä¹Ÿæœ‰ä¿¡æ¯éœ€è¦"æ‰”æ‰" |

**è¿™è¯´æ˜ä»€ä¹ˆï¼Ÿ**
- 4096 ç»´å…‰è°±ä¸­ï¼Œéƒ¨åˆ†åƒç´ ä¸ log_g **å®Œå…¨æ— å…³**
- OLS è¯•å›¾ç”¨è¿™äº›æ— å…³åƒç´ æ‹Ÿåˆï¼Œåè€Œå¼•å…¥å™ªå£°
- æå°çš„æ­£åˆ™åŒ–ï¼ˆÎ±=0.001ï¼‰å°±èƒ½è®©æ¨¡å‹"å¿½ç•¥"è¿™äº›æ— å…³ä¿¡æ¯

### æœ€ä¼˜ Î± éšå™ªå£°å•è°ƒå¢å¤§ â†’ éœ€åˆ é™¤çš„æ— å…³ä¿¡æ¯è¶Šæ¥è¶Šå¤š

$$
\text{noise} \uparrow \quad \Longrightarrow \quad \alpha_{\text{opt}} \uparrow \quad \Longrightarrow \quad \text{éœ€"æ‰”æ‰"çš„åƒç´ è¶Šå¤š}
$$

| å™ªå£°æ°´å¹³ | æœ€ä¼˜ Î± | ç‰©ç†å«ä¹‰ |
|----------|--------|----------|
| 0.0 | 0.001 | å…‰è°±æœ¬èº«å«å°‘é‡æ— å…³ä¿¡æ¯ |
| 0.1 | 1.0 | å™ªå£°æ±¡æŸ“äº†éƒ¨åˆ†åƒç´  |
| 0.2 | 10 | æ›´å¤šåƒç´ å—å™ªå£°å½±å“ |
| 0.5 | 50 | å¤§é‡åƒç´ è¢«å™ªå£°æ·¹æ²¡ |
| 1.0 | 200 | å¤§éƒ¨åˆ†ä¿¡æ¯è¢«å™ªå£°æ©ç›– |
| 2.0 | 1000 | å‡ ä¹æ‰€æœ‰åƒç´ éƒ½éœ€å¼ºå‹åˆ¶ |

### å¯¹ NN è®¾è®¡çš„æ ¸å¿ƒå¯ç¤º

> **NN çš„ä¸»è¦ä»»åŠ¡ä¸æ˜¯"ä»å…‰è°±æå– log_g"ï¼Œè€Œæ˜¯"å­¦ä¼šå“ªäº›åƒç´ è¯¥å¿½ç•¥"ã€‚**

1. **æ¶æ„è®¾è®¡åº”ä¾§é‡"ä¿¡æ¯è¿‡æ»¤"æœºåˆ¶**
   - Attention æœºåˆ¶ï¼šå­¦ä¹ å“ªäº›åƒç´ é‡è¦
   - Sparse å±‚ï¼šè‡ªåŠ¨å±è”½æ— å…³ç»´åº¦
   - Denoising é¢„å¤„ç†ï¼šå…ˆå»å™ªå†é¢„æµ‹

2. **æ­£åˆ™åŒ– = æ˜¾å¼å‘Šè¯‰æ¨¡å‹"å¿½ç•¥æŸäº›ä¿¡æ¯"**
   - Weight decayã€Dropoutã€L1 ç¨€ç–åŒ–éƒ½æ˜¯åœ¨åšåŒä¸€ä»¶äº‹
   - å™ªå£°è¶Šå¤§ï¼Œéœ€è¦è¶Šå¼ºçš„"å¿½ç•¥"æœºåˆ¶

3. **Capacity åˆ†é…**
   - å¤§éƒ¨åˆ†å‚æ•°åº”ç”¨äº"è¿‡æ»¤æ— å…³ä¿¡æ¯"
   - å°‘é‡å‚æ•°ç”¨äº"ä»æœ‰ç”¨ä¿¡æ¯çº¿æ€§æ˜ å°„åˆ° log_g"ï¼ˆå› ä¸ºæœ¬è´¨æ˜¯çº¿æ€§çš„ï¼‰

## 4.2 æ¨¡å‹å±‚æ´è§ï¼ˆç”¨äºä¼˜åŒ–æ¨¡å‹ï¼‰

### ğŸ”¹ ä¸ºä»€ä¹ˆ Ridge åœ¨æ— å™ªå£°ä¸‹åè€Œæ¯” OLS æ›´å¥½ï¼Ÿ

- å…‰è°±ä¸­åŒ…å« **ä¸ log_g å®Œå…¨æ— å…³çš„ç‰¹å¾**
- OLSï¼ˆæ— æ­£åˆ™ï¼‰ä¼šè¿‡åº¦æ‹Ÿåˆè¿™äº›æ— å…³ç»´åº¦ â†’ RÂ²â‰ˆ0.97
- Ridge (Î±â‰ˆ0.001) æŠ‘åˆ¶è¿™äº›æ— å…³æ–¹å‘ â†’ é€¼è¿‘å®Œç¾çº¿æ€§å…³ç³» RÂ²â‰ˆ1.0
- **è¯´æ˜ 100% çš„ log_g ä¿¡æ¯éƒ½åœ¨çº¿æ€§å­ç©ºé—´é‡Œï¼ŒOLS åªæ˜¯"èµ°åäº†"**

### ğŸ”¹ ä¸ºä»€ä¹ˆæœ€ä½³ Î± ä¼šéšç€å™ªå£°ä¸Šå‡è€Œå˜å¤§ï¼Ÿ

- æ¯ä¸ªå™ªå£°æ°´å¹³éƒ½æœ‰ä¸€ä¸ªæœ€ä½³çš„ **biasâ€“variance tradeoff** ç‚¹
- å™ªå£°è¶Šå¤§ â†’ æ¨¡å‹è¶Šå®¹æ˜“æ‹Ÿåˆå™ªå£° â†’ éœ€è¦æ›´å¼ºæ­£åˆ™ï¼ˆæ›´å¤§ Î±ï¼‰
- **è¿™è¯´æ˜å…‰è°±åœ¨å™ªå£° regime ä¸‹ï¼šå™ªå£°ä¸»å¯¼çš„æ˜¯é«˜é¢‘ç»´åº¦ï¼Œä¿¡å·åä½é¢‘/å¹³æ»‘**

#### ğŸ“ æ•°å­¦æ¨å¯¼ï¼šå™ªå£°ã€æ–¹å·®å’Œ $\alpha$ çš„å…³ç³»

å‡è®¾çœŸå®æ¨¡å‹æ˜¯ï¼š
$$
\mathbf y = X \mathbf w^* + \boldsymbol\varepsilon, \qquad \boldsymbol\varepsilon \sim \mathcal N(0, \sigma^2 I)
$$

å²­å›å½’è§£ $\hat{\mathbf w}(\alpha) = (X^\top X + \alpha I)^{-1} X^\top \mathbf y$ æ˜¯ $\mathbf y$ çš„ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œæ‰€ä»¥å™ªå£°ä¼šé€šè¿‡ $(X^\top X + \alpha I)^{-1} X^\top$ ä¼ åˆ° $\hat{\mathbf w}$ é‡Œã€‚

| $\alpha$ è®¾å®š | çŸ©é˜µè¡Œä¸º | å¯¹å™ªå£°çš„å½±å“ | Test $R^2$ |
|--------------|---------|-------------|-----------|
| **å°ï¼ˆæ¥è¿‘ OLSï¼‰** | $(X^\top X + \alpha I)^{-1} \approx (X^\top X)^{-1}$ | å¯¹å™ªå£°å‡ ä¹ä¸è¿‡æ»¤ï¼Œå‚æ•°æ–¹å·®å¤§ | å˜å·® |
| **å¤§** | çŸ©é˜µè°±å€¼æ•´ä½“å˜å° | å™ªå£°æ”¾å¤§è¢«å¼ºçƒˆæŠ‘åˆ¶ï¼Œä½†ä¿¡å·ä¹Ÿè¢«"ç¼©å°" | åå·®å¤§ï¼Œå˜å·® |

å› æ­¤ï¼Œç»™å®šä¸€ä¸ªå™ªå£°æ°´å¹³ $\sigma^2$ï¼Œæ€»çš„æ³›åŒ–è¯¯å·®æ˜¯ä¸€ä¸ªå…¸å‹çš„ **åå·®â€“æ–¹å·®æŠ˜è¡·** æ›²çº¿ï¼š
$$
\text{Error}(\alpha) = \underbrace{\text{Bias}^2(\alpha)}_{\uparrow \text{ éš }\alpha} + \underbrace{\text{Var}(\alpha)}_{\downarrow \text{ éš }\alpha} + \text{noise floor}
$$

å›¾ä¸­æ¯ä¸€æ¡ $R^2(\alpha)$ æ›²çº¿å°±æ˜¯è¿™ä¸ªæŠ˜è¡·çš„ç›´æ¥å¯è§†åŒ–ï¼šå·¦ç«¯ï¼ˆå° $\alpha$ï¼‰æ˜¯"é«˜æ–¹å·®ã€ä½åå·®"ï¼›å³ç«¯ï¼ˆå¤§ $\alpha$ï¼‰æ˜¯"ä½æ–¹å·®ã€é«˜åå·®"ï¼›ä¸­é—´çš„å³°å€¼å¯¹åº”æŸä¸ªæœ€ä½³ $\alpha^*$ã€‚

#### ğŸ“Š ä¸€ç»´ç®€åŒ–æ¨¡å‹ï¼š$\alpha^*$ å¦‚ä½•ä¾èµ–å™ªå£°

åœ¨ä¸€ç»´æƒ…å½¢ï¼ˆå•ç‰¹å¾ï¼‰å¹¶æŠŠç‰¹å¾åšäº†å½’ä¸€åŒ–æ—¶ï¼Œè®¾ $X^\top X = s$ï¼Œåˆ™å²­å›å½’è§£ä¸ºï¼š
$$
\hat w(\alpha) = \frac{s}{s+\alpha} w^* + \frac{1}{s+\alpha} X^\top \boldsymbol\varepsilon
$$

- æœŸæœ›ï¼ˆä¿¡å·éƒ¨åˆ†ï¼‰è¢«ç¼©æ”¾äº†ä¸€ä¸ªå› å­ $\frac{s}{s+\alpha}$ â€”â€” è¿™å°±æ˜¯ **åå·®** çš„æ¥æº
- å™ªå£°éƒ¨åˆ†çš„æ–¹å·®å˜æˆ $\operatorname{Var}[\hat w(\alpha)] = \frac{\sigma^2 s}{(s+\alpha)^2}$ â€”â€” éš $\alpha$ å¢å¤§å•è°ƒå‡å°

å¯ä»¥è¯æ˜ï¼Œæœ€ä¼˜æ­£åˆ™åŒ–å¼ºåº¦æ»¡è¶³ï¼š
$$
\alpha^* \approx \frac{\sigma^2}{(w^*)^2}
$$

**è¦ç‚¹ï¼š$\alpha^*$ ä¸å™ªå£°æ–¹å·® $\sigma^2$ æˆæ­£æ¯”ã€‚**

å™ªå£°è¶Šå¤§ï¼ˆ$\sigma^2$ è¶Šå¤§ï¼‰ï¼Œä¸ºäº†æŠŠå™ªå£°å¯¹å‚æ•°çš„æ–¹å·®å‹ä¸‹å»ï¼Œå°±éœ€è¦æ›´å¤§çš„ $\alpha$ æ¥æ›´å¼ºåœ°"æ”¶ç¼©" $\hat w$ï¼Œå“ªæ€•å› æ­¤ç‰ºç‰²ä¸€äº›åå·®ã€‚

#### ğŸ”„ å¤šç»´æƒ…å½¢çš„æ¨å¹¿

å¤šç»´æƒ…å½¢è™½ç„¶å…¬å¼æ›´å¤æ‚ï¼Œä½†ç»“æ„æ˜¯ç±»ä¼¼çš„ã€‚æ²¿ç€ $X^\top X$ çš„æ¯ä¸ªç‰¹å¾æ–¹å‘ $\lambda_i$ï¼Œå²­å›å½’çš„ç¼©æ”¾å› å­æ˜¯ï¼š

| ä½œç”¨ | å…¬å¼ |
|-----|------|
| ä¿¡å·ç¼©æ”¾ | $\frac{\lambda_i}{\lambda_i + \alpha}$ |
| å™ªå£°å› å­ | $\frac{\sqrt{\lambda_i}}{\lambda_i + \alpha}$ |

å™ªå£°æ–¹å·® $\sigma^2$ è¶Šå¤§ï¼Œå„æ–¹å‘ä¸Šçš„æ–¹å·®é¡¹éƒ½æ•´ä½“æ”¾å¤§ï¼Œå› æ­¤éœ€è¦æ›´å¤§çš„ $\alpha$ æ‰èƒ½æŠŠè¿™äº›æ–¹å‘ä¸Šçš„å™ªå£°æŠ‘åˆ¶åˆ°åˆé€‚æ°´å¹³ï¼Œäºæ˜¯æ•´ä½“çš„ $\alpha^*$ æ›²çº¿å‘å³ç§»åŠ¨ã€‚

#### ğŸ¯ è´å¶æ–¯è§†è§’ï¼š$\alpha$ æ˜¯"æ•°æ®å™ªå£° / å…ˆéªŒå¼ºåº¦"çš„æ¯”å€¼

å¦‚æœä»è´å¶æ–¯è§’åº¦çœ‹å²­å›å½’ï¼š
- å…ˆéªŒï¼š$\mathbf w \sim \mathcal N(0, \tau^2 I)$
- ä¼¼ç„¶ï¼š$\mathbf y \mid \mathbf w \sim \mathcal N(X\mathbf w, \sigma^2 I)$

åˆ™ MAP è§£å°±æ˜¯å²­å›å½’ï¼Œä¸”æœ‰ï¼š
$$
\alpha = \frac{\sigma^2}{\tau^2}
$$

è¿™ç»™å‡ºäº†ä¸€ä¸ªéå¸¸ç›´è§‚çš„è§£é‡Šï¼š

| æƒ…å†µ | $\alpha$ å˜åŒ– | è§£é‡Š |
|-----|--------------|------|
| $\sigma^2$ è¶Šå¤§ï¼ˆæ•°æ®å™ªå£°è¶Šå¼ºï¼‰ | $\alpha$ è¶Šå¤§ | è¶Š"ä¸ç›¸ä¿¡æ•°æ®"ï¼Œéœ€è¦æŠŠ $\mathbf w$ å¾€å…ˆéªŒï¼ˆ0ï¼‰æ‹‰ |
| $\tau^2$ è¶Šå¤§ï¼ˆå…è®¸å‚æ•°æ›´å¤§ï¼‰ | $\alpha$ è¶Šå° | å…ˆéªŒçº¦æŸæ›´å®½æ¾ |

åœ¨æœ¬å®éªŒä¸­ï¼Œå…ˆéªŒç­‰ä»·åœ°æ˜¯å›ºå®šçš„ï¼ˆtask ä¸å˜ã€æ¨¡å‹ä¸å˜ï¼‰ï¼Œ**å”¯ä¸€å˜åŒ–çš„æ˜¯å™ªå£° $\sigma^2$**ï¼Œäºæ˜¯æœ€ä¼˜çš„ $\alpha^*$ å¾ˆè‡ªç„¶åœ°éšç€å™ªå£°å•è°ƒå¢å¤§ï¼Œè¿™æ­£æ˜¯å›¾ä¸­è™šçº¿æ‰€å±•ç¤ºçš„è¶‹åŠ¿ã€‚

#### ğŸ“ˆ å›¾ä¸Šçš„ç›´è§‚è§£è¯»

| å™ªå£°æƒ…å†µ | ç°è±¡ | è§£é‡Š |
|---------|------|------|
| **æ— å™ªå£° / ä½å™ªå£°** | OLSï¼ˆ$\alpha=0$ï¼‰å‡ ä¹å®Œç¾æ¢å¤ $\mathbf w^*$ï¼Œtest $R^2$ éå¸¸é«˜ï¼›$\alpha^*$ å¾ˆå° | ä»»ä½•éé›¶ $\alpha$ éƒ½åªä¼šå¼•å…¥å¤šä½™çš„åå·® |
| **å™ªå£°é€æ¸å¢å¤§** | æœ€ä¼˜ $\alpha^*$ é€æ­¥å‘å³ç§»åŠ¨ | å¢å¤§ $\alpha$ å¯ä»¥æ˜¾è‘—é™ä½æ–¹å·®ï¼Œä»è€Œæé«˜ test $R^2$ |
| **é«˜å™ªå£°æé™** | è™šçº¿å¾€å³ï¼ˆæ›´å¤§ $\alpha$ï¼‰ï¼Œä¹Ÿå¾€ä¸‹ï¼ˆæœ€å¤§ $R^2$ ä¸‹é™ï¼‰ | å™ªå£°å ä¸»å¯¼ï¼Œæ•´ä½“å¯è§£é‡Šçš„ä¿¡å·å¾ˆå°‘ï¼Œéœ€è¦å¾ˆå¤§ $\alpha$ æŠŠæ¨¡å‹å‹å¾—éå¸¸å¹³æ»‘ |

> **æ€»ç»“**ï¼š"optimal $\alpha$ éšå™ªå£°å¢å¤§è€Œå•è°ƒä¸Šå‡" çš„æ›²çº¿ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ï¼š**å™ªå£°è¶Šå¤§ï¼Œä¸ºäº†æ§åˆ¶æ–¹å·®ï¼Œå¿…é¡»ç”¨è¶Šå¼ºçš„æ­£åˆ™åŒ–ï¼›æœ€ä¼˜ç‚¹å°±æ˜¯åå·®å’Œæ–¹å·®æ­¤æ¶ˆå½¼é•¿çš„å¹³è¡¡ç‚¹**ã€‚

### ğŸ”¹ Î± éšå™ªå£°å˜åŒ–é€éœ²äº†æ•°æ®çš„ç‰©ç†ç»“æ„

| Î± éš noise çš„å˜åŒ– | å«ä¹‰ | æœ¬å®éªŒæƒ…å†µ |
|-------------------|------|------------|
| **Î± éš noise â†‘ ä¸Šå‡** | æ•°æ®ä¸­æœ‰å¤§é‡å¯è¢«å™ªå£°æ±¡æŸ“çš„é«˜é¢‘åˆ†é‡ï¼ˆåƒç´ çº§ä¿¡æ¯ï¼‰ï¼›çœŸæ­£ log_g ä¿¡æ¯åœ¨æ›´"å¹³æ»‘"çš„æ–¹å‘ä¸Šï¼›éœ€è¦å¼ºæ­£åˆ™æ¥è¿‡æ»¤å™ªå£° | âœ… **ç¬¦åˆ** |
| Î± ä¸å˜ | ä¿¡å·ç»“æ„ç¨³å®šï¼Œå¯¹å™ªå£°ä¸æ•æ„Ÿï¼ˆå¸¸è§äºä½ç»´ç»“æ„æˆ–å¼ºå½’ä¸€åŒ–æ•°æ®ï¼‰ | âŒ |
| Î± éš noise â†‘ åè€Œä¸‹é™ï¼ˆå°‘è§ï¼‰ | æ•°æ®å¤©ç„¶å…·æœ‰å¹³æ»‘æ€§ï¼å¼ºå…ˆéªŒç»“æ„ï¼Œä¸éœ€è¦å¤§æ­£åˆ™ | âŒ |

**ç‰©ç†è§£è¯»ï¼š** log_g ä¿¡æ¯ç¼–ç åœ¨å…‰è°±çš„ **ä½é¢‘/å¹³æ»‘ç»“æ„** ä¸­ï¼Œè€Œéåƒç´ çº§ç»†èŠ‚ã€‚å™ªå£°ä¼˜å…ˆæ±¡æŸ“é«˜é¢‘åˆ†é‡ï¼Œå› æ­¤éœ€è¦æ­£åˆ™åŒ–æ¥"ä½é€šæ»¤æ³¢"ã€‚

## 4.3 å®éªŒå±‚ç»†èŠ‚æ´è§

### Ridge ä¸€è‡´æ€§ä¼˜äº OLS

åœ¨æ‰€æœ‰å™ªå£°æ°´å¹³ä¸‹ï¼Œæœ€ä¼˜è°ƒå‚çš„ Ridge éƒ½ä¼˜äº OLSï¼š
- æœ€å°æ”¹è¿›ï¼šnoise=0.1 æ—¶ +0.9%
- æœ€å¤§æ”¹è¿›ï¼šnoise=2.0 æ—¶ +68.4%

**ç»“è®ºï¼š** å³ä½¿æ˜¯ç®€å•çš„ L2 æ­£åˆ™åŒ–ï¼Œåœ¨é«˜ç»´å›å½’ä¸­ä¹Ÿæ˜¯å¿…è¦çš„ã€‚

### è¿‡åº¦æ­£åˆ™åŒ–çš„ä»£ä»·

| Noise | Î±=100 vs Î±_opt |
|-------|----------------|
| 0.0 | RÂ² ä» 0.999 é™è‡³ 0.794 (âˆ’20%) |
| 0.1 | RÂ² ä» 0.909 é™è‡³ 0.780 (âˆ’14%) |

**è­¦ç¤ºï¼š** å›ºå®š Î± ç­–ç•¥åœ¨è·¨å™ªå£°åœºæ™¯ä¸‹ä¸å¯è¡Œã€‚

### è¯„ä¼°æŒ‡æ ‡ä¸€è‡´æ€§

RÂ², MAE, RMSE ä¸‰ä¸ªæŒ‡æ ‡åœ¨æ‰€æœ‰å™ªå£°æ°´å¹³ä¸‹æŒ‡å‘ç›¸åŒçš„æœ€ä¼˜ Î±ï¼Œè¡¨æ˜ï¼š
- æ— éœ€é’ˆå¯¹ä¸åŒæŒ‡æ ‡é€‰æ‹©ä¸åŒè¶…å‚æ•°
- å¯ä»¥ä½¿ç”¨ä»»ä¸€æŒ‡æ ‡è¿›è¡Œè¶…å‚æ•°æœç´¢

## 4.4 ç‰©ç†å±‚æ´è§

### å…‰è°±-log_g æ˜ å°„çš„çº¿æ€§æœ¬è´¨

$$
\text{noise} = 0 \Rightarrow R^2 = 0.999
$$

è¿™è¡¨æ˜ï¼š
1. **log_g ä¿¡æ¯åˆ†å¸ƒåœ¨å¤šä¸ªåƒç´ ä¸Š**ï¼Œè€Œéç¨€ç–è°±çº¿
2. **æ˜ å°„æœ¬è´¨æ˜¯çº¿æ€§çš„**ï¼Œéçº¿æ€§æ¨¡å‹å¯èƒ½åªå¸¦æ¥è¾¹é™…æ”¹è¿›
3. **ç‰¹å¾å·¥ç¨‹é‡ç‚¹åº”åœ¨å»å™ª**ï¼Œè€Œéå¤æ‚å˜æ¢

### å™ªå£°å¯¹ä¿¡æ¯çš„ç ´å

| Noise | Best RÂ² | ä¿¡æ¯æŸå¤± |
|-------|---------|----------|
| 0.0 | 0.999 | 0% |
| 0.1 | 0.909 | ~9% |
| 0.2 | 0.826 | ~17% |
| 0.5 | 0.655 | ~34% |
| 1.0 | 0.458 | ~54% |
| 2.0 | 0.221 | ~78% |

**ç»“è®ºï¼š** å™ªå£°å¯¹æ€§èƒ½çš„å½±å“æ˜¯å‰§çƒˆçš„ï¼Œå†å¤šçš„æ­£åˆ™åŒ–ä¹Ÿæ— æ³•æ¢å¤ä¸¢å¤±çš„ä¿¡æ¯ã€‚

---

# 5. ğŸ“ ç»“è®ºï¼ˆConclusionï¼‰

## 5.1 æ ¸å¿ƒå‘ç°

> **NN çš„ä¸»è¦ä»»åŠ¡ä¸æ˜¯"ä»å…‰è°±æå– log_g"ï¼Œè€Œæ˜¯"å­¦ä¼šå“ªäº›åƒç´ è¯¥å¿½ç•¥"ã€‚**

å‡è®¾éªŒè¯ï¼š
- âœ… æœ€ä¼˜ Î± éšå™ªå£°å•è°ƒå¢å¤§ï¼šÎ±_opt: 0.001 â†’ 1000 (noise: 0 â†’ 2)
- âœ… Ridge åœ¨æ‰€æœ‰å™ªå£°ä¸‹ä¼˜äº OLSï¼šÎ” RÂ²: +0.8% ~ +68.4%
- âœ… å…‰è°±-log_g æ˜ å°„æœ¬è´¨çº¿æ€§ï¼šnoise=0 æ—¶ RÂ²=0.999
- âš ï¸ é«˜å™ªå£°ä¸‹çº¿æ€§æ¨¡å‹èƒ½åŠ›æœ‰é™ï¼šnoise=2 æ—¶ best RÂ²=0.22

## 5.2 å…³é”®ç»“è®ºï¼ˆ4 æ¡ï¼‰

| # | ç»“è®º | è¯æ® |
|---|------|------|
| 1 | **å…‰è°±å«æ— å…³ä¿¡æ¯** | noise=0 æ—¶ Ridge(Î±=0.001) RÂ²=0.999 > OLS RÂ²=0.969 |
| 2 | **æœ€ä¼˜ Î± éšå™ªå£°å•è°ƒå¢å¤§** | ä» 0.001 åˆ° 1000ï¼Œè·¨è¶Š 6 ä¸ªæ•°é‡çº§ |
| 3 | **æ˜ å°„æœ¬è´¨çº¿æ€§** | noise=0 æ—¶ RÂ²=0.999 |
| 4 | **æ­£åˆ™åŒ–æ”¶ç›Šéšå™ªå£°å¢å¤§** | Î” RÂ² ä» +3.1% (N=0) åˆ° +68.4% (N=2.0) |

## 5.3 è®¾è®¡å¯ç¤º

### æ¶æ„åŸåˆ™

| åŸåˆ™ | å»ºè®® | åŸå›  |
|------|------|------|
| ä¿¡æ¯è¿‡æ»¤ä¼˜å…ˆ | Attention/Sparse/Denoising æœºåˆ¶ | NN ä¸»è¦ä»»åŠ¡æ˜¯"å¿½ç•¥æ— å…³åƒç´ " |
| Linear + Residual | å…ˆ Ridge é¢„æµ‹ï¼ŒNN å­¦æ®‹å·® | log_g æœ¬è´¨çº¿æ€§ï¼ŒNN åªéœ€å­¦æ®‹å·® |
| è‡ªé€‚åº”æ­£åˆ™åŒ– | Weight decay ä¸å™ªå£°æŒ‚é’© | æœ€ä¼˜ Î± éšå™ªå£°å˜åŒ– 6 ä¸ªæ•°é‡çº§ |

### âš ï¸ å¸¸è§é™·é˜±

| å¸¸è§åšæ³• | å®éªŒè¯æ® |
|----------|----------|
| "å›ºå®š Î± é€‚é…æ‰€æœ‰å™ªå£°" | æœ€ä¼˜ Î± éšå™ªå£°å˜åŒ– 6 ä¸ªæ•°é‡çº§ |
| "OLS è¶³å¤Ÿå¥½" | Ridge åœ¨æ‰€æœ‰å™ªå£°ä¸‹éƒ½æ›´ä¼˜ |
| "å™ªå£°å¤§å°±ç”¨æ›´å¤æ‚çš„æ¨¡å‹" | æ­£åˆ™åŒ–æ¯”æ¨¡å‹å¤æ‚åº¦æ›´é‡è¦ |

## 5.4 ç‰©ç†è§£é‡Š

- log_g ä¿¡æ¯ç¼–ç åœ¨å…‰è°±çš„ **ä½é¢‘/å¹³æ»‘ç»“æ„** ä¸­
- å™ªå£°ä¼˜å…ˆæ±¡æŸ“é«˜é¢‘åˆ†é‡
- æ­£åˆ™åŒ– = "ä½é€šæ»¤æ³¢"

## 5.5 å…³é”®æ•°å­—é€ŸæŸ¥

| æŒ‡æ ‡ | å€¼ |
|------|-----|
| æœ€ä½³æ— å™ªå£°æ€§èƒ½ | RÂ²=0.999 (Ridge Î±=0.001) |
| æœ€ä½³é«˜å™ªå£°æ€§èƒ½ (N=2.0) | RÂ²=0.221 (Ridge Î±=1000) |
| æ­£åˆ™åŒ–æœ€å¤§æ”¶ç›Š | +68.4% (N=2.0) |
| æœ€ä¼˜ Î± å˜åŒ–èŒƒå›´ | 0.001 â†’ 1000 (10â¶ å€) |

## 5.6 ä¸‹ä¸€æ­¥å·¥ä½œ

| æ–¹å‘ | å…·ä½“ä»»åŠ¡ |
|------|----------|
| éçº¿æ€§æ¨¡å‹å¯¹æ¯” | LightGBM vs Ridge (same noise levels) |
| å…¶ä»–æ’æ˜Ÿå‚æ•° | å¯¹ T_eff, [Fe/H] é‡å¤å®éªŒ |
| Î± è‡ªåŠ¨é€‰æ‹© | äº¤å‰éªŒè¯æˆ–æ ¹æ® SNR ä¼°è®¡ |
| NN æ¶æ„éªŒè¯ | Linear + Residual è®¾è®¡ |

---

# 6. ğŸ“ é™„å½•

## 6.1 æ•°å€¼ç»“æœè¡¨ï¼ˆResultsï¼‰

### 6.1.1 Ridge å›å½’å®Œæ•´ç»“æœï¼ˆæŒ‰å™ªå£°æ°´å¹³åˆ†ç»„ï¼‰

#### Noise = 0.0ï¼ˆæ— å™ªå£°ï¼‰

| Alpha | Test RÂ² | Test MAE | Test RMSE |
|-------|---------|----------|-----------|
| 0.001 | **0.9990** | **0.0060** | **0.0092** |
| 0.01 | 0.9978 | 0.0093 | 0.0138 |
| 0.1 | 0.9934 | 0.0162 | 0.0237 |
| 1.0 | 0.9784 | 0.0294 | 0.0429 |
| 10.0 | 0.9301 | 0.0546 | 0.0772 |
| 100.0 | 0.7943 | 0.1014 | 0.1324 |
| 1000.0 | 0.4720 | 0.1798 | 0.2122 |
| **OLS** | 0.9694 | 0.0380 | 0.0511 |

#### Noise = 0.1

| Alpha | Test RÂ² | Test MAE | Test RMSE |
|-------|---------|----------|-----------|
| 0.001 | 0.9012 | 0.0674 | 0.0918 |
| 0.1 | 0.9029 | 0.0669 | 0.0910 |
| 1.0 | **0.9090** | **0.0650** | **0.0881** |
| 10.0 | 0.8907 | 0.0724 | 0.0965 |
| 100.0 | 0.7802 | 0.1051 | 0.1369 |
| **OLS** | 0.9007 | 0.0673 | 0.0920 |

#### Noise = 0.2

| Alpha | Test RÂ² | Test MAE | Test RMSE |
|-------|---------|----------|-----------|
| 0.001 | 0.8108 | 0.0960 | 0.1270 |
| 0.01 | 0.8108 | 0.0960 | 0.1270 |
| 0.1 | 0.8110 | 0.0958 | 0.1269 |
| 1.0 | 0.8134 | 0.0946 | 0.1261 |
| 10.0 | **0.8264** | **0.0933** | **0.1217** |
| 100.0 | 0.7546 | 0.1117 | 0.1446 |
| 1000.0 | 0.4623 | 0.1812 | 0.2141 |
| **OLS** | 0.8108 | 0.0960 | 0.1270 |

#### Noise = 0.5

| Alpha | Test RÂ² | Test MAE | Test RMSE |
|-------|---------|----------|-----------|
| 0.001 | 0.6075 | 0.1397 | 0.1829 |
| 10.0 | 0.6325 | 0.1359 | 0.1770 |
| 20.0 | 0.6445 | 0.1353 | 0.1741 |
| 50.0 | **0.6550** | **0.1338** | **0.1715** |
| 75.0 | 0.6535 | 0.1346 | 0.1719 |
| 100.0 | 0.6493 | 0.1357 | 0.1729 |
| 150.0 | 0.6380 | 0.1383 | 0.1757 |
| 200.0 | 0.6253 | 0.1411 | 0.1787 |
| 1000.0 | 0.4365 | 0.1860 | 0.2192 |
| **OLS** | 0.6075 | 0.1397 | 0.1829 |

> **æ›´æ–° 2025-11-29**: ç»†ç²’åº¦æœç´¢å‘ç°æœ€ä¼˜ Î±=50 (RÂ²=0.655)ï¼Œæ¯”åŸ Î±=100 æå‡ +0.9%

#### Noise = 1.0

| Alpha | Test RÂ² | Test MAE | Test RMSE |
|-------|---------|----------|-----------|
| 0.001 | 0.3851 | 0.1776 | 0.2290 |
| 50.0 | 0.4325 | 0.1734 | 0.2199 |
| 75.0 | 0.4440 | 0.1723 | 0.2178 |
| 100.0 | 0.4507 | 0.1730 | 0.2164 |
| 150.0 | 0.4545 | 0.1716 | 0.2157 |
| 200.0 | **0.4580** | **0.1710** | **0.2149** |
| 500.0 | 0.4360 | 0.1755 | 0.2192 |
| 1000.0 | 0.3684 | 0.1963 | 0.2320 |
| **OLS** | 0.3851 | 0.1776 | 0.2290 |

> **æ›´æ–° 2025-11-29**: ç»†ç²’åº¦æœç´¢å‘ç°æœ€ä¼˜ Î±=200 (RÂ²=0.458)ï¼Œæ¯”åŸ Î±=100 æå‡ +1.7%

#### Noise = 2.0

| Alpha | Test RÂ² | Test MAE | Test RMSE |
|-------|---------|----------|-----------|
| 0.001 | 0.1312 | 0.2214 | 0.2722 |
| 100.0 | 0.1709 | 0.2184 | 0.2659 |
| 1000.0 | **0.2210** | **0.2177** | **0.2577** |
| **OLS** | 0.1312 | 0.2214 | 0.2722 |

### 6.1.2 æœ€ä¼˜ Î± ä¸ OLS å¯¹æ¯”æ€»ç»“

| Noise | Best Î± | Ridge RÂ² | OLS RÂ² | Î” RÂ² | ç›¸å¯¹æ”¹è¿› |
|-------|--------|----------|--------|------|----------|
| 0.0 | 0.001 | **0.9990** | 0.9694 | +0.030 | +3.1% |
| 0.1 | 1.0 | **0.9090** | 0.9007 | +0.008 | +0.9% |
| 0.2 | 10.0 | **0.8264** | 0.8108 | +0.016 | +1.9% |
| 0.5 | **50.0** | **0.6550** | 0.6075 | +0.048 | +7.8% |
| 1.0 | **200.0** | **0.4580** | 0.3851 | +0.073 | +18.9% |
| 2.0 | 1000.0 | **0.2210** | 0.1312 | +0.090 | +68.4% |

> **æ›´æ–° 2025-11-29**: 
> - noise=0.5: Î±=100â†’**50**, RÂ²: 0.649â†’**0.655** (+0.9%)
> - noise=1.0: Î±=100â†’**200**, RÂ²: 0.451â†’**0.458** (+1.7%)

## 6.2 å»ºè®®ç»˜å›¾ï¼ˆPlot Suggestionsï¼‰

### 6.2.1 Linear + Residual NN æ¶æ„éªŒè¯
- **ç›®çš„**ï¼šéªŒè¯å…ˆç”¨ Ridge é¢„æµ‹ï¼Œå†ç”¨ NN å­¦ä¹ æ®‹å·®çš„æ¶æ„
- **X è½´**ï¼šå™ªå£°æ°´å¹³
- **Y è½´**ï¼šRÂ²
- **æ¯”è¾ƒ**ï¼šRidge-only vs NN-only vs Linear+Residual

## 6.3 ç›¸å…³æ–‡ä»¶

| ç±»å‹ | è·¯å¾„ |
|------|------|
| å›¾è¡¨ 1ï¼ˆå®Œæ•´æŒ‡æ ‡ï¼‰ | `img/ridge_metrics_vs_alpha_by_noise.png` |
| å›¾è¡¨ 2ï¼ˆRÂ² + æœ€ä¼˜è½¨è¿¹ï¼‰ | `img/ridge_r2_vs_alpha_by_noise.png` |
| å›¾è¡¨ 3ï¼ˆRÂ² vs Î±ï¼Œ32kï¼ŒSNR æ ‡æ³¨ï¼‰ | `img/ridge_r2_vs_alpha_by_snr_32k.png` |
| ç»˜å›¾è„šæœ¬ | `scripts/plot_ridge_r2_vs_alpha.py` |
| Alpha Sweep è„šæœ¬ | `scripts/alpha_sweep.sh` |
| Ridge é…ç½® | `configs/exp/logg/linear_ridge.yaml` |
| ç»“æœæ±‡æ€» | `results/LINEAR_ALPHA_SWEEP_RESULTS.md` |

---

*Generated: 2025-11-27*  
*Updated: 2025-12-05 - æ·»åŠ å›¾ 3ï¼ˆ32k æ ·æœ¬ï¼ŒSNR æ ‡æ³¨ï¼‰ï¼Œè¡¥å…… SNR ä¸ noise_level å¯¹ç…§è¡¨*
